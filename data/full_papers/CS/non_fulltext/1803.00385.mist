#0
MAGAN	_	_
:	_	_
Aligning	_	_
Biological	_	_
Manifolds	_	_
Matthew	_	_
Amodio	_	_
matthew.amodio	_	_
@	_	_
yale.edu	_	_
Smita	_	_
Krishnaswamy	_	_
smita.krishnaswamy	_	_
@	_	_
yale.edu	_	_
Abstract—It	_	_
is	_	_
increasingly	_	_
common	_	_
in	_	_
many	_	_
types	_	_
of	_	_
natural	_	_
and	_	_
physical	_	_
systems	_	_
(	_	_
especially	_	_
biological	_	_
systems	_	_
)	_	_
to	_	_
have	_	_
different	_	_
types	_	_
of	_	_
measurements	_	_
performed	_	_
on	_	_
the	_	_
same	_	_
underlying	_	_
system	_	_
.	_	_

#1
In	_	_
such	_	_
settings	_	_
,	_	_
it	_	_
is	_	_
important	_	_
to	_	_
align	_	_
the	_	_
manifolds	_	_
arising	_	_
from	_	_
each	_	_
measurement	_	_
in	_	_
order	_	_
to	_	_
integrate	_	_
such	_	_
data	_	_
and	_	_
gain	_	_
an	_	_
improved	_	_
picture	_	_
of	_	_
the	_	_
system	_	_
.	_	_

#2
We	_	_
tackle	_	_
this	_	_
problem	_	_
using	_	_
generative	_	_
adversarial	_	_
networks	_	_
(	_	_
GANs	_	_
)	_	_
.	_	_

#3
Recently	_	_
,	_	_
GANs	_	_
have	_	_
been	_	_
utilized	_	_
to	_	_
try	_	_
to	_	_
find	_	_
correspondences	_	_
between	_	_
sets	_	_
of	_	_
samples	_	_
.	_	_

#4
However	_	_
,	_	_
these	_	_
GANs	_	_
are	_	_
not	_	_
explicitly	_	_
designed	_	_
for	_	_
proper	_	_
alignment	_	_
of	_	_
manifolds	_	_
.	_	_

#5
We	_	_
present	_	_
a	_	_
new	_	_
GAN	_	_
called	_	_
the	_	_
Manifold-Aligning	_	_
GAN	_	_
(	_	_
MAGAN	_	_
)	_	_
that	_	_
aligns	_	_
two	_	_
manifolds	_	_
such	_	_
that	_	_
related	_	_
points	_	_
in	_	_
each	_	_
measurement	_	_
space	_	_
are	_	_
aligned	_	_
together	_	_
.	_	_

#6
We	_	_
demonstrate	_	_
applications	_	_
of	_	_
MAGAN	_	_
in	_	_
single-cell	_	_
biology	_	_
in	_	_
integrating	_	_
two	_	_
different	_	_
measurement	_	_
types	_	_
together	_	_
.	_	_

#7
In	_	_
our	_	_
demonstrated	_	_
examples	_	_
,	_	_
cells	_	_
from	_	_
the	_	_
same	_	_
tissue	_	_
are	_	_
measured	_	_
with	_	_
both	_	_
genomic	_	_
(	_	_
single-cell	_	_
RNAsequencing	_	_
)	_	_
and	_	_
proteomic	_	_
(	_	_
mass	_	_
cytometry	_	_
)	_	_
technologies	_	_
.	_	_

#8
We	_	_
show	_	_
that	_	_
the	_	_
MAGAN	_	_
successfully	_	_
aligns	_	_
them	_	_
such	_	_
that	_	_
known	_	_
correlations	_	_
between	_	_
measured	_	_
markers	_	_
are	_	_
improved	_	_
compared	_	_
to	_	_
other	_	_
recently	_	_
proposed	_	_
models	_	_
.	_	_

#9
I	_	_
.	_	_

#10
INTRODUCTION	_	_
We	_	_
commonly	_	_
face	_	_
the	_	_
situation	_	_
of	_	_
having	_	_
samples	_	_
from	_	_
a	_	_
pair	_	_
of	_	_
related	_	_
domains	_	_
and	_	_
want	_	_
to	_	_
ask	_	_
the	_	_
natural	_	_
question	_	_
of	_	_
how	_	_
samples	_	_
from	_	_
one	_	_
relate	_	_
to	_	_
samples	_	_
from	_	_
the	_	_
other	_	_
.	_	_

#11
Our	_	_
motivational	_	_
system	_	_
for	_	_
this	_	_
is	_	_
two	_	_
types	_	_
of	_	_
measurements	_	_
on	_	_
cells	_	_
sampled	_	_
from	_	_
the	_	_
same	_	_
population	_	_
in	_	_
a	_	_
biological	_	_
system	_	_
.	_	_

#12
It	_	_
is	_	_
important	_	_
for	_	_
the	_	_
discovery	_	_
of	_	_
new	_	_
biology	_	_
to	_	_
integrate	_	_
these	_	_
datasets	_	_
,	_	_
which	_	_
are	_	_
often	_	_
generated	_	_
at	_	_
great	_	_
cost	_	_
and	_	_
expense	_	_
.	_	_

#13
However	_	_
,	_	_
a	_	_
fundamental	_	_
challenge	_	_
is	_	_
that	_	_
there	_	_
are	_	_
exponentially	_	_
many	_	_
possible	_	_
relationships	_	_
that	_	_
could	capability-options	_
exist	_	_
between	_	_
the	_	_
two	_	_
domains	_	_
of	_	_
measurement	_	_
and	_	_
the	_	_
system	_	_
must	deontic	_
learn	_	_
a	_	_
logical	_	_
way	_	_
to	_	_
map	_	_
between	_	_
them	_	_
.	_	_

#14
The	_	_
first	_	_
approaches	_	_
for	_	_
teaching	_	_
neural	_	_
networks	_	_
to	_	_
learn	_	_
these	_	_
relationships	_	_
required	_	_
supervised	_	_
paired	_	_
examples	_	_
from	_	_
each	_	_
domain	_	_
,	_	_
an	_	_
impractical	_	_
demand	_	_
for	_	_
many	_	_
applications	_	_
[	_	_
1	_	_
]	_	_
.	_	_

#15
Recently	_	_
,	_	_
there	_	_
have	_	_
been	_	_
attempts	_	_
at	_	_
performing	_	_
the	_	_
same	_	_
task	_	_
without	_	_
the	_	_
supervision	_	_
of	_	_
paired	_	_
data	_	_
[	_	_
2	_	_
,	_	_
3	_	_
,	_	_
4	_	_
]	_	_
.	_	_

#16
Like	_	_
these	_	_
previous	_	_
models	_	_
,	_	_
the	_	_
MAGAN	_	_
learns	_	_
to	_	_
map	_	_
between	_	_
distinct	_	_
domains	_	_
from	_	_
unsupervised	_	_
,	_	_
unpaired	_	_
data	_	_
without	_	_
pretraining	_	_
.	_	_

#17
It	_	_
can	_	_
take	_	_
a	_	_
point	_	_
in	_	_
the	_	_
first	_	_
domain	_	_
and	_	_
generate	_	_
a	_	_
point	_	_
that	_	_
is	_	_
indistinguishable	_	_
from	_	_
points	_	_
in	_	_
the	_	_
other	_	_
domain	_	_
.	_	_

#18
However	_	_
,	_	_
unlike	_	_
previous	_	_
models	_	_
,	_	_
the	_	_
MAGAN	_	_
learns	_	_
the	_	_
most	_	_
coherent	_	_
mapping	_	_
,	_	_
rather	_	_
than	_	_
an	_	_
arbitrary	_	_
one	_	_
.	_	_

#19
The	_	_
MAGAN	_	_
will	_	_
not	_	_
just	_	_
take	_	_
a	_	_
point	_	_
in	_	_
the	_	_
first	_	_
domain	_	_
and	_	_
generate	_	_
any	_	_
point	_	_
from	_	_
the	_	_
second	_	_
domain	_	_
,	_	_
but	_	_
it	_	_
will	_	_
generate	_	_
the	_	_
most	_	_
closely	_	_
related	_	_
one	_	_
.	_	_

#20
This	_	_
is	_	_
achieved	_	_
by	_	_
aligning	_	_
,	_	_
rather	_	_
than	_	_
superimposing	_	_
,	_	_
the	_	_
manifolds	_	_
of	_	_
the	_	_
two	_	_
domains	_	_
.	_	_

#21
The	_	_
high-dimensional	_	_
inputs	_	_
that	_	_
are	_	_
typical	_	_
for	_	_
neural	_	_
network	_	_
applications	_	_
can	_	_
typically	_	_
be	_	_
modeled	_	_
very	_	_
well	_	_
with	_	_
a	_	_
lower-dimensional	_	_
manifold	_	_
[	_	_
5	_	_
]	_	_
.	_	_

#22
Much	_	_
work	_	_
has	_	_
framed	_	_
the	_	_
Fig.	_	_
1	_	_
.	_	_

#23
There	_	_
are	_	_
exponentially	_	_
many	_	_
mappings	_	_
that	_	_
superimpose	_	_
the	_	_
two	_	_
manifolds	_	_
,	_	_
fooling	_	_
a	_	_
GAN’s	_	_
discriminator	_	_
.	_	_

#24
By	_	_
aligning	_	_
the	_	_
manifolds	_	_
,	_	_
we	_	_
maintain	_	_
pointwise	_	_
correspondences	_	_
.	_	_

#25
generation	_	_
problem	_	_
of	_	_
GANs	_	_
as	_	_
sampling	_	_
points	_	_
from	_	_
this	_	_
manifold	_	_
[	_	_
6	_	_
,	_	_
7	_	_
]	_	_
.	_	_

#26
Here	_	_
,	_	_
each	_	_
domain	_	_
lies	_	_
on	_	_
a	_	_
manifold	_	_
and	_	_
we	_	_
want	_	_
to	_	_
find	_	_
an	_	_
alignment	_	_
between	_	_
them	_	_
.	_	_

#27
We	_	_
first	_	_
consider	_	_
an	_	_
example	_	_
of	_	_
the	_	_
difference	_	_
between	_	_
superimposing	_	_
and	_	_
aligning	_	_
manifolds	_	_
on	_	_
image	_	_
domains	_	_
.	_	_

#28
Earlier	_	_
work	_	_
[	_	_
4	_	_
]	_	_
has	_	_
demonstrated	_	_
that	_	_
an	_	_
image	_	_
of	_	_
an	_	_
object	_	_
in	_	_
the	_	_
first	_	_
domain	_	_
can	_	_
be	_	_
mapped	_	_
to	_	_
an	_	_
object	_	_
of	_	_
another	_	_
object	_	_
in	_	_
the	_	_
second	_	_
domain	_	_
while	_	_
preserving	_	_
the	_	_
orientation	_	_
with	_	_
respect	_	_
to	_	_
the	_	_
picture	_	_
frame	_	_
.	_	_

#29
However	_	_
,	_	_
in	_	_
those	_	_
cases	_	_
,	_	_
the	_	_
orientation	_	_
axis	_	_
can	_	_
be	_	_
completely	_	_
reversed	_	_
.	_	_

#30
An	_	_
image	_	_
in	_	_
the	_	_
first	_	_
domain	_	_
facing	_	_
30◦	_	_
maps	_	_
to	_	_
an	_	_
image	_	_
in	_	_
the	_	_
second	_	_
domain	_	_
facing	_	_
150◦	_	_
,	_	_
and	_	_
vice	_	_
versa	_	_
.	_	_

#31
The	_	_
mappings	_	_
successfully	_	_
fool	_	_
the	_	_
discriminator	_	_
in	_	_
each	_	_
domain	_	_
at	_	_
the	_	_
level	_	_
of	_	_
an	_	_
entire	_	_
batch	_	_
(	_	_
the	_	_
manifolds	_	_
are	_	_
superimposed	_	_
)	_	_
,	_	_
but	_	_
there	_	_
are	_	_
other	_	_
mappings	_	_
that	_	_
also	_	_
fool	_	_
the	_	_
discriminator	_	_
that	_	_
preserve	_	_
the	_	_
individual	_	_
pointwise	_	_
structure	_	_
of	_	_
the	_	_
original	_	_
domain	_	_
.	_	_

#32
Namely	_	_
,	_	_
the	_	_
optimal	_	_
alignment	_	_
would	_	_
map	_	_
first	_	_
domain	_	_
images	_	_
at	_	_
30◦	_	_
to	_	_
second	_	_
domain	_	_
images	_	_
also	_	_
at	_	_
30◦	_	_
.	_	_

#33
Without	_	_
aligning	_	_
the	_	_
manifolds	_	_
,	_	_
only	_	_
random	_	_
initialization	_	_
will	_	_
determine	_	_
which	_	_
superimposition	_	_
is	_	_
learned	_	_
on	_	_
any	_	_
particular	_	_
attempt	_	_
.	_	_

#34
While	_	_
the	_	_
preference	_	_
for	_	_
the	_	_
logical	_	_
mappings	_	_
of	_	_
manifold	_	_
alignment	_	_
over	_	_
the	_	_
arbitrary	_	_
ones	_	_
of	_	_
manifold	_	_
superimposition	_	_
is	_	_
of	_	_
general	_	_
interest	_	_
to	_	_
all	_	_
domains	_	_
,	_	_
we	_	_
present	_	_
multiple	_	_
applications	_	_
in	_	_
single-cell	_	_
biological	_	_
analysis	_	_
where	_	_
it	_	_
is	_	_
essential	_	_
.	_	_

#35
We	_	_
propose	_	_
the	_	_
novel	_	_
concept	_	_
of	_	_
using	_	_
adversarial	_	_
neural	_	_
networks	_	_
for	_	_
alignment	_	_
of	_	_
manifolds	_	_
arising	_	_
from	_	_
different	_	_
biological	_	_
experimental	_	_
data	_	_
measurement	_	_
types	_	_
.	_	_

#36
Single-cell	_	_
biological	_	_
experiments	_	_
create	_	_
many	_	_
situations	_	_
where	_	_
manifold	_	_
alignment	_	_
problems	_	_
are	_	_
of	_	_
interest	_	_
.	_	_

#37
New	_	_
technologies	_	_
allow	_	_
for	_	_
measurements	_	_
to	_	_
be	_	_
made	_	_
at	_	_
the	_	_
granularity	_	_
of	_	_
each	_	_
cell	_	_
,	_	_
rather	_	_
than	_	_
older	_	_
technologies	_	_
which	_	_
could	capability	_
only	_	_
acquire	_	_
aggregate	_	_
summary	_	_
statistics	_	_
for	_	_
whole	_	_
populations	_	_
of	_	_
cells	_	_
.	_	_

#38
While	_	_
these	_	_
instruments	_	_
allow	_	_
us	_	_
to	_	_
discover	_	_
biological	_	_
phenomena	_	_
that	_	_
were	_	_
not	_	_
apparent	_	_
before	_	_
,	_	_
it	_	_
is	_	_
a	_	_
challenge	_	_
to	_	_
integrate	_	_
and	_	_
analyze	_	_
this	_	_
information	_	_
in	_	_
a	_	_
unified	_	_
fashion	_	_
for	_	_
biological	_	_
discovery	_	_
.	_	_

#39
Further	_	_
,	_	_
even	_	_
for	_	_
the	_	_
same	_	_
technology	_	_
,	_	_
experiments	_	_
run	_	_
on	_	_
different	_	_
days	_	_
or	_	_
in	_	_
different	_	_
batches	_	_
can	_	_
show	_	_
variations	_	_
even	_	_
on	_	_
the	_	_
same	_	_
populations	_	_
,	_	_
possibly	_	_
due	_	_
to	_	_
calibration	_	_
differences	_	_
.	_	_

#40
In	_	_
such	_	_
cases	_	_
even	_	_
replicate	_	_
experiments	_	_
need	_	_
alignment	_	_
before	_	_
comparison	_	_
.	_	_

#41
Two	_	_
such	_	_
technologies	_	_
that	_	_
we	_	_
examine	_	_
are	_	_
single-cell	_	_
RNA	_	_
sequencing	_	_
which	_	_
measures	_	_
cells	_	_
in	_	_
thousands	_	_
of	_	_
gene	_	_
(	_	_
mRNA	_	_
)	_	_
dimensions	_	_
and	_	_
mass	_	_
cytometry	_	_
which	_	_
measures	_	_
protein	_	_
abundances	_	_
in	_	_
several	_	_
dozen	_	_
dimensions	_	_
[	_	_
8	_	_
,	_	_
9	_	_
]	_	_
.	_	_

#42
In	_	_
all	_	_
of	_	_
these	_	_
examples	_	_
we	_	_
have	_	_
two	_	_
data	_	_
manifolds	_	_
with	_	_
a	_	_
latent	_	_
physical	_	_
cell	_	_
being	_	_
measured	_	_
analogously	_	_
in	_	_
each	_	_
manifold	_	_
.	_	_

#43
In	_	_
some	_	_
applications	_	_
it	_	_
might	options	_
be	_	_
adequate	_	_
to	_	_
simply	_	_
superimpose	_	_
these	_	_
manifolds	_	_
in	_	_
any	_	_
way	_	_
.	_	_

#44
In	_	_
many	_	_
applications	_	_
though	_	_
,	_	_
including	_	_
the	_	_
ones	_	_
demonstrated	_	_
here	_	_
,	_	_
we	_	_
would	_	_
like	_	_
to	_	_
be	_	_
able	_	_
to	_	_
align	_	_
them	_	_
such	_	_
that	_	_
the	_	_
two	_	_
representations	_	_
of	_	_
each	_	_
latent	_	_
cell	_	_
are	_	_
aligned	_	_
.	_	_

#45
The	_	_
MAGAN	_	_
presented	_	_
here	_	_
improves	_	_
upon	_	_
neural	_	_
models	_	_
for	_	_
manifold	_	_
alignment	_	_
by	_	_
finding	_	_
the	_	_
mapping	_	_
between	_	_
the	_	_
manifolds	_	_
(	_	_
correspondence	_	_
)	_	_
that	_	_
models	_	_
these	_	_
latent	_	_
points	_	_
by	_	_
penalizing	_	_
differences	_	_
in	_	_
each	_	_
point’s	_	_
representation	_	_
in	_	_
the	_	_
two	_	_
manifolds	_	_
.	_	_

#46
We	_	_
summarize	_	_
the	_	_
contributions	_	_
of	_	_
this	_	_
paper	_	_
as	_	_
follows	_	_
:	_	_
1	_	_
)	_	_
The	_	_
introduction	_	_
of	_	_
a	_	_
novel	_	_
GAN	_	_
architecture	_	_
that	_	_
aligns	_	_
rather	_	_
than	_	_
superimposes	_	_
manifolds	_	_
to	_	_
find	_	_
relationships	_	_
between	_	_
points	_	_
in	_	_
two	_	_
distinct	_	_
domains	_	_
2	_	_
)	_	_
The	_	_
demonstration	_	_
of	_	_
novel	_	_
applications	_	_
made	_	_
possible	_	_
by	_	_
the	_	_
new	_	_
architecture	_	_
in	_	_
the	_	_
analysis	_	_
of	_	_
single-cell	_	_
biological	_	_
data	_	_
The	_	_
rest	_	_
of	_	_
this	_	_
paper	_	_
is	_	_
organized	_	_
as	_	_
follows	_	_
.	_	_

#47
First	_	_
,	_	_
there	_	_
is	_	_
a	_	_
detailed	_	_
description	_	_
of	_	_
the	_	_
MAGAN	_	_
architecture	_	_
.	_	_

#48
Next	_	_
,	_	_
there	_	_
is	_	_
a	_	_
validation	_	_
of	_	_
its	_	_
performance	_	_
on	_	_
artificial	_	_
data	_	_
and	_	_
the	_	_
standard	_	_
MNIST	_	_
dataset	_	_
.	_	_

#49
Then	_	_
,	_	_
there	_	_
are	_	_
demonstrations	_	_
on	_	_
three	_	_
real-world	_	_
biological	_	_
applications	_	_
:	_	_
mapping	_	_
between	_	_
two	_	_
replicate	_	_
cytometry	_	_
domains	_	_
,	_	_
mapping	_	_
between	_	_
two	_	_
different	_	_
cytometry	_	_
domains	_	_
,	_	_
and	_	_
mapping	_	_
between	_	_
one	_	_
cytometry	_	_
domain	_	_
and	_	_
a	_	_
single-cell	_	_
RNA	_	_
sequencing	_	_
domain	_	_
.	_	_

#50
II	_	_
.	_	_

#51
MODEL	_	_
In	_	_
this	_	_
section	_	_
we	_	_
detail	_	_
the	_	_
MAGAN	_	_
architecture	_	_
and	_	_
specify	_	_
the	_	_
notation	_	_
used	_	_
thereafter	_	_
.	_	_

#52
We	_	_
then	_	_
elaborate	_	_
on	_	_
the	_	_
key	_	_
novel	_	_
aspects	_	_
of	_	_
the	_	_
model	_	_
individually	_	_
,	_	_
discussing	_	_
in	_	_
turn	_	_
the	_	_
unsupervised	_	_
correspondence	_	_
loss	_	_
,	_	_
semi-supervised	_	_
correspondence	_	_
loss	_	_
,	_	_
and	_	_
data	_	_
augmentation	_	_
.	_	_

#53
A	_	_
.	_	_

#54
Architecture	_	_
The	_	_
MAGAN	_	_
(	_	_
Figure	_	_
2	_	_
)	_	_
is	_	_
composed	_	_
of	_	_
two	_	_
GANs	_	_
,	_	_
each	_	_
with	_	_
a	_	_
generator	_	_
network	_	_
G	_	_
that	_	_
takes	_	_
as	_	_
input	_	_
X	_	_
and	_	_
outputs	_	_
a	_	_
target	_	_
dataset	_	_
X	_	_
′	_	_
.	_	_

#55
We	_	_
refer	_	_
to	_	_
each	_	_
generator	_	_
as	_	_
a	_	_
mapping	_	_
from	_	_
the	_	_
input	_	_
domain	_	_
to	_	_
the	_	_
output	_	_
domain	_	_
.	_	_

#56
Each	_	_
generator	_	_
attempts	_	_
to	_	_
make	_	_
its	_	_
output	_	_
G	_	_
(	_	_
X	_	_
)	_	_
indistinguishable	_	_
by	_	_
D	_	_
from	_	_
X	_	_
′	_	_
.	_	_

#57
Denote	_	_
the	_	_
two	_	_
datasets	_	_
X1	_	_
and	_	_
X2	_	_
.	_	_

#58
Let	_	_
the	_	_
generator	_	_
mapping	_	_
from	_	_
X1	_	_
to	_	_
X2	_	_
be	_	_
G12	_	_
and	_	_
the	_	_
generator	_	_
mapping	_	_
from	_	_
X2	_	_
to	_	_
X1	_	_
be	_	_
G21	_	_
.	_	_

#59
The	_	_
discriminator	_	_
that	_	_
tries	_	_
to	_	_
separate	_	_
true	_	_
points	_	_
from	_	_
mapped	_	_
ones	_	_
for	_	_
the	_	_
first	_	_
domain	_	_
is	_	_
D1	_	_
and	_	_
the	_	_
discriminator	_	_
doing	_	_
so	_	_
for	_	_
the	_	_
second	_	_
domain	_	_
is	_	_
D2	_	_
.	_	_

#60
The	_	_
loss	_	_
for	_	_
G1	_	_
on	_	_
minibatches	_	_
x1	_	_
and	_	_
x2	_	_
is	_	_
:	_	_
x12	_	_
=	_	_
G12	_	_
(	_	_
x1	_	_
)	_	_
x121	_	_
=	_	_
G21	_	_
(	_	_
x12	_	_
)	_	_
Lr	_	_
=	_	_
Lreconstruction	_	_
=	_	_
L	_	_
(	_	_
x1	_	_
,	_	_
x121	_	_
)	_	_
Ld	_	_
=	_	_
Ldiscriminator	_	_
=	_	_
−Ex1∼PX1	_	_
[	_	_
logD2	_	_
(	_	_
x12	_	_
)	_	_
]	_	_
Lc	_	_
=	_	_
Lcorrespondence	_	_
=	_	_
L	_	_
(	_	_
x1	_	_
,	_	_
x12	_	_
)	_	_
LG1	_	_
=	_	_
Lr	_	_
+	_	_
Ld	_	_
+	_	_
Lc	_	_
where	_	_
L	_	_
is	_	_
any	_	_
loss	_	_
function	_	_
,	_	_
here	_	_
mean-squared	_	_
error	_	_
(	_	_
MSE	_	_
)	_	_
.	_	_

#61
Similarly	_	_
,	_	_
the	_	_
loss	_	_
for	_	_
G2	_	_
is	_	_
:	_	_
x21	_	_
=	_	_
G21	_	_
(	_	_
x2	_	_
)	_	_
x212	_	_
=	_	_
G12	_	_
(	_	_
x21	_	_
)	_	_
Lr	_	_
=	_	_
L	_	_
(	_	_
x2	_	_
,	_	_
x212	_	_
)	_	_
Ld	_	_
=	_	_
−Ex2∼PX2	_	_
[	_	_
logD1	_	_
(	_	_
x21	_	_
)	_	_
]	_	_
Lc	_	_
=	_	_
L	_	_
(	_	_
x2	_	_
,	_	_
x21	_	_
)	_	_
LG2	_	_
=	_	_
Lr	_	_
+	_	_
Ld	_	_
+	_	_
Lc	_	_

#62
The	_	_
losses	_	_
for	_	_
D1	_	_
and	_	_
D2	_	_
are	_	_
:	_	_
LD1	_	_
=	_	_
−Ex1∼PX1	_	_
[	_	_
logD1	_	_
(	_	_
x1	_	_
)	_	_
−	_	_
logD1	_	_
(	_	_
x121	_	_
)	_	_
]	_	_
−Ex2∼PX2	_	_
[	_	_
log	_	_
(	_	_
1−D1	_	_
(	_	_
x21	_	_
)	_	_
)	_	_
]	_	_
LD2	_	_
=	_	_
−Ex2∼PX2	_	_
[	_	_
logD2	_	_
(	_	_
x2	_	_
)	_	_
−	_	_
logD2	_	_
(	_	_
x212	_	_
)	_	_
]	_	_
−Ex1∼PX1	_	_
[	_	_
log	_	_
(	_	_
1−D2	_	_
(	_	_
x12	_	_
)	_	_
)	_	_
]	_	_

#63
A	_	_
crucial	_	_
implementation	_	_
decision	_	_
is	_	_
to	_	_
tie	_	_
the	_	_
weights	_	_
of	_	_
G12	_	_
and	_	_
G21	_	_
for	_	_
both	_	_
directions	_	_
of	_	_
the	_	_
mapping	_	_
,	_	_
as	_	_
this	_	_
ensures	_	_
that	_	_
the	_	_
mappings	_	_
will	_	_
be	_	_
between	_	_
similar	_	_
data	_	_
points	_	_
.	_	_

#64
For	_	_
example	_	_
,	_	_
after	_	_
mapping	_	_
a	_	_
point	_	_
from	_	_
X1	_	_
to	_	_
X2	_	_
,	_	_
in	_	_
order	_	_
to	_	_
reconstruct	_	_
the	_	_
original	_	_
point	_	_
x1	_	_
,	_	_
the	_	_
first	_	_
mapping	_	_
must	deontic	_
preserve	_	_
enough	_	_
information	_	_
in	_	_
x12	_	_
.	_	_

#65
Then	_	_
,	_	_
since	_	_
the	_	_
weights	_	_
are	_	_
tied	_	_
,	_	_
G21	_	_
must	deontic	_
use	_	_
this	_	_
information	_	_
in	_	_
the	_	_
same	_	_
way	_	_
when	_	_
asked	_	_
to	_	_
map	_	_
an	_	_
original	_	_
point	_	_
x2	_	_
.	_	_

#66
B.	_	_
Correspondence	_	_
Loss	_	_

#67
1	_	_
)	_	_
Unsupervised	_	_
Correspondence	_	_
:	_	_
Previous	_	_
models	_	_
included	_	_
only	_	_
two	_	_
restrictions	_	_
:	_	_
(	_	_
1	_	_
)	_	_
that	_	_
the	_	_
two	_	_
generators	_	_
be	_	_
able	_	_
to	_	_
reconstruct	_	_
a	_	_
point	_	_
after	_	_
it	_	_
moves	_	_
to	_	_
the	_	_
other	_	_
domain	_	_
and	_	_
back	_	_
,	_	_
and	_	_
(	_	_
2	_	_
)	_	_
that	_	_
the	_	_
discriminators	_	_
not	_	_
be	_	_
able	_	_
to	_	_
distinguish	_	_
batches	_	_
of	_	_
true	_	_
and	_	_
mapped	_	_
points	_	_
.	_	_

#68
To	_	_
do	_	_
this	_	_
,	_	_
the	_	_
generators	_	_
could	capability	_
learn	_	_
arbitrarily	_	_
complex	_	_
mappings	_	_
as	_	_
long	_	_
as	_	_
they	_	_
superimpose	_	_
the	_	_
two	_	_
manifolds	_	_
.	_	_

#69
To	_	_
instead	_	_
enforce	_	_
the	_	_
manifolds	_	_
be	_	_
fully	_	_
aligned	_	_
,	_	_
the	_	_
MAGAN	_	_
includes	_	_
a	_	_
correspondence	_	_
loss	_	_
between	_	_
a	_	_
point	_	_
in	_	_
its	_	_
original	_	_
domain	_	_
and	_	_
that	_	_
point’s	_	_
representation	_	_
after	_	_
being	_	_
mapped	_	_
to	_	_
the	_	_
other	_	_
domain	_	_
.	_	_

#70
This	_	_
correspondence	_	_
loss	_	_
can	_	_
be	_	_
chosen	_	_
appropriately	_	_
for	_	_
the	_	_
manifolds	_	_
in	_	_
any	_	_
particular	_	_
problem	_	_
.	_	_

#71
In	_	_
the	_	_
biological	_	_
domains	_	_
considered	_	_
here	_	_
,	_	_
there	_	_
are	_	_
a	_	_
subset	_	_
of	_	_
shared	_	_
features	_	_
measured	_	_
in	_	_
both	_	_
experiments	_	_
.	_	_

#72
We	_	_
use	_	_
the	_	_
MSE	_	_
over	_	_
these	_	_
subsets	_	_
as	_	_
the	_	_
correspondence	_	_
loss	_	_
,	_	_
as	_	_
we	_	_
do	_	_
not	_	_
want	_	_
to	_	_
reorder	_	_
sets	_	_
of	_	_
points	_	_
or	_	_
change	_	_
their	_	_
representations	_	_
more	_	_
than	_	_
what	_	_
is	_	_
required	_	_
to	_	_
match	_	_
the	_	_
other	_	_
domain	_	_
.	_	_

#73
2	_	_
)	_	_
Semi-supervised	_	_
Correspondence	_	_
:	_	_
The	_	_
MAGAN’s	_	_
correspondence	_	_
loss	_	_
additionally	_	_
provides	_	_
a	_	_
natural	_	_
opportunity	_	_
for	_	_
semi-supervised	_	_
learning	_	_
.	_	_

#74
If	_	_
each	_	_
point	_	_
in	_	_
X1	_	_
already	_	_
had	_	_
a	_	_
known	_	_
correspondence	_	_
with	_	_
a	_	_
point	_	_
in	_	_
X2	_	_
,	_	_
no	_	_
framework	_	_
of	_	_
dual	_	_
GANs	_	_
would	_	_
be	_	_
necessary	_	_
to	_	_
discover	_	_
relationships	_	_
.	_	_

#75
In	_	_
some	_	_
domains	_	_
,	_	_
though	_	_
,	_	_
it	_	_
is	_	_
difficult	_	_
to	_	_
define	_	_
a	_	_
meaningful	_	_
distance	_	_
measure	_	_
but	_	_
easy	_	_
to	_	_
acquire	_	_
a	_	_
very	_	_
small	_	_
number	_	_
of	_	_
labeled	_	_
pairs	_	_
.	_	_

#76
We	_	_
would	_	_
like	_	_
a	_	_
model	_	_
that	_	_
learns	_	_
from	_	_
unsupervised	_	_
data	_	_
but	_	_
can	_	_
improve	_	_
with	_	_
any	_	_
small	_	_
number	_	_
of	_	_
labels	_	_
that	_	_
can	_	_
be	_	_
acquired	_	_
.	_	_

#77
In	_	_
those	_	_
situations	_	_
,	_	_
we	_	_
want	_	_
to	_	_
leverage	_	_
both	_	_
(	_	_
1	_	_
)	_	_
the	_	_
information	_	_
that	_	_
the	_	_
unsupervised	_	_
model	_	_
has	_	_
learned	_	_
on	_	_
all	_	_
of	_	_
the	_	_
data	_	_
and	_	_
(	_	_
2	_	_
)	_	_
incorporate	_	_
the	_	_
information	_	_
the	_	_
labels	_	_
provide	_	_
where	_	_
they	_	_
exist	_	_
.	_	_

#78
The	_	_
MAGAN	_	_
can	_	_
be	_	_
used	_	_
in	_	_
this	_	_
setting	_	_
without	_	_
any	_	_
further	_	_
modification	_	_
using	_	_
the	_	_
following	_	_
choice	_	_
of	_	_
correspondence	_	_
loss	_	_
function	_	_
.	_	_

#79
We	_	_
choose	_	_
the	_	_
loss	_	_
function	_	_
to	_	_
be	_	_
nonzero	_	_
only	_	_
at	_	_
the	_	_
paired	_	_
points	_	_
in	_	_
each	_	_
domain	_	_
.	_	_

#80
Its	_	_
value	_	_
is	_	_
then	_	_
the	_	_
sum	_	_
of	_	_
the	_	_
losses	_	_
on	_	_
each	_	_
labeled	_	_
pair	_	_
,	_	_
where	_	_
the	_	_
loss	_	_
for	_	_
a	_	_
particular	_	_
labeled	_	_
pair	_	_
(	_	_
x1i	_	_
,	_	_
x2j	_	_
)	_	_
,	_	_
x1i	_	_
∈	_	_
X1	_	_
,	_	_
x2j	_	_
∈	_	_
X2	_	_
is	_	_
:	_	_
Lc	_	_
=	_	_
MSE	_	_
(	_	_
G12	_	_
(	_	_
x1i	_	_
)	_	_
,	_	_
x2j	_	_
)	_	_
+MSE	_	_
(	_	_
G21	_	_
(	_	_
x2j	_	_
)	_	_
,	_	_
x1i	_	_
)	_	_
C.	_	_
Manifold	_	_
Data	_	_
Augmentation	_	_
The	_	_
MAGAN	_	_
utilizes	_	_
a	_	_
novel	_	_
technique	_	_
for	_	_
data	_	_
augmentation	_	_
,	_	_
leveraging	_	_
the	_	_
imperfect	_	_
reconstructions	_	_
each	_	_
generator	_	_
produces	_	_
within	_	_
its	_	_
domain	_	_
.	_	_

#81
It	_	_
has	_	_
been	_	_
well	_	_
established	_	_
that	_	_
autoencoders	_	_
model	_	_
and	_	_
reconstruct	_	_
from	_	_
the	_	_
data	_	_
manifold	_	_
[	_	_
10	_	_
,	_	_
11	_	_
]	_	_
.	_	_

#82
We	_	_
note	_	_
that	_	_
the	_	_
dual	_	_
GANs	_	_
within	_	_
each	_	_
domain	_	_
function	_	_
as	_	_
an	_	_
autoencoder	_	_
,	_	_
meaning	_	_
their	_	_
reconstruction	_	_
x′i	_	_
of	_	_
a	_	_
sample	_	_
xi	_	_
is	_	_
another	_	_
point	_	_
near	_	_
the	_	_
underlying	_	_
manifold	_	_
,	_	_
but	_	_
importantly	_	_
x′i	_	_
6=	_	_
xi	_	_
.	_	_

#83
By	_	_
letting	_	_
each	_	_
discriminator	_	_
see	_	_
the	_	_
reconstructions	_	_
as	_	_
true	_	_
samples	_	_
from	_	_
the	_	_
real	_	_
domain	_	_
,	_	_
we	_	_
both	_	_
(	_	_
1	_	_
)	_	_
augment	_	_
the	_	_
original	_	_
data	_	_
with	_	_
new	_	_
samples	_	_
from	_	_
the	_	_
manifold	_	_
and	_	_
(	_	_
2	_	_
)	_	_
prevent	_	_
the	_	_
discriminators	_	_
from	_	_
learning	_	_
to	_	_
separate	_	_
real	_	_
from	_	_
generated	_	_
examples	_	_
by	_	_
modeling	_	_
the	_	_
noise	_	_
around	_	_
the	_	_
manifold	_	_
,	_	_
which	_	_
differs	_	_
between	_	_
X1	_	_
and	_	_
G21	_	_
(	_	_
X2	_	_
)	_	_
and	_	_
between	_	_
X2	_	_
and	_	_
G12	_	_
(	_	_
X1	_	_
)	_	_
.	_	_

#84
This	_	_
is	_	_
especially	_	_
important	_	_
in	_	_
biological	_	_
settings	_	_
,	_	_
where	_	_
the	_	_
number	_	_
of	_	_
measurements	_	_
per	_	_
cell	_	_
dwarfs	_	_
the	_	_
number	_	_
of	_	_
cells	_	_
measured	_	_
and	_	_
dropout	_	_
in	_	_
the	_	_
measuring	_	_
process	_	_
produces	_	_
sparsity	_	_
.	_	_

#85
III	_	_
.	_	_

#86
EXPERIMENTS	_	_
All	_	_
experiments	_	_
were	_	_
performed	_	_
with	_	_
the	_	_
MAGAN	_	_
framework	_	_
with	_	_
discriminators	_	_
of	_	_
five	_	_
layers	_	_
each	_	_
and	_	_
generators	_	_
of	_	_
three	_	_
layers	_	_
each	_	_
.	_	_

#87
Layer	_	_
sizes	_	_
depended	_	_
on	_	_
the	_	_
dataset	_	_
,	_	_
while	_	_
Leaky	_	_
ReLU	_	_
activations	_	_
were	_	_
used	_	_
on	_	_
all	_	_
layers	_	_
except	_	_
the	_	_
output	_	_
layers	_	_
of	_	_
the	_	_
discriminators	_	_
(	_	_
which	_	_
were	_	_
sigmoid	_	_
)	_	_
and	_	_
the	_	_
generators	_	_
(	_	_
which	_	_
were	_	_
linear	_	_
)	_	_
.	_	_

#88
Dropout	_	_
of	_	_
0.9	_	_
was	_	_
applied	_	_
during	_	_
training	_	_
and	_	_
for	_	_
images	_	_
convolutional	_	_
layers	_	_
were	_	_
used	_	_
.	_	_

#89
Optimization	_	_
was	_	_
performed	_	_
on	_	_
100,000	_	_
iterations	_	_
of	_	_
batches	_	_
of	_	_
size	_	_
256	_	_
by	_	_
the	_	_
ADAM	_	_
optimizer	_	_
with	_	_
learning	_	_
rate	_	_
0.001	_	_
.	_	_

#90
As	_	_
with	_	_
other	_	_
GANs	_	_
,	_	_
the	_	_
generators	_	_
and	_	_
discriminators	_	_
are	_	_
trained	_	_
alternatively	_	_
,	_	_
so	_	_
they	_	_
each	_	_
must	deontic	_
get	_	_
progressively	_	_
better	_	_
as	_	_
their	_	_
adversaries	_	_
make	_	_
their	_	_
tasks	_	_
harder	_	_
and	_	_
harder	_	_
.	_	_

#91
One	_	_
known	_	_
difficulty	_	_
in	_	_
the	_	_
adversarial	_	_
training	_	_
process	_	_
is	_	_
preventing	_	_
a	_	_
collapse	_	_
of	_	_
the	_	_
generator	_	_
into	_	_
mapping	_	_
all	_	_
inputs	_	_
to	_	_
one	_	_
point	_	_
,	_	_
chasing	_	_
the	_	_
minimum	_	_
probability	_	_
region	_	_
of	_	_
the	_	_
discriminator	_	_
as	_	_
it	_	_
moves	_	_
.	_	_

#92
To	_	_
combat	_	_
this	_	_
,	_	_
the	_	_
MAGAN	_	_
includes	_	_
the	_	_
approach	_	_
outlined	_	_
in	_	_
[	_	_
12	_	_
]	_	_
.	_	_

#93
This	_	_
involves	_	_
giving	_	_
the	_	_
discriminator	_	_
access	_	_
to	_	_
minibatch	_	_
information	_	_
by	_	_
having	_	_
a	_	_
subset	_	_
of	_	_
the	_	_
network	_	_
process	_	_
a	_	_
rotation	_	_
of	_	_
the	_	_
original	_	_
data	_	_
matrix	_	_
.	_	_

#94
A	_	_
.	_	_

#95
Artificial	_	_
Data	_	_
We	_	_
first	_	_
test	_	_
the	_	_
MAGAN	_	_
on	_	_
a	_	_
generated	_	_
example	_	_
of	_	_
points	_	_
sampled	_	_
from	_	_
Gaussian	_	_
distributions	_	_
with	_	_
varying	_	_
means	_	_
.	_	_

#96
Figure	_	_
3a	_	_
shows	_	_
the	_	_
three	_	_
subpopulations	_	_
in	_	_
the	_	_
first	_	_
domain	_	_
X1	_	_
in	_	_
blue	_	_
and	_	_
the	_	_
three	_	_
in	_	_
the	_	_
second	_	_
domain	_	_
X2	_	_
in	_	_
red	_	_
with	_	_
an	_	_
example	_	_
mapping	_	_
where	_	_
,	_	_
without	_	_
the	_	_
correspondence	_	_
loss	_	_
,	_	_
each	_	_
subpopulation	_	_
in	_	_
X1	_	_
is	_	_
mapped	_	_
to	_	_
a	_	_
subpopulation	_	_
in	_	_
X2	_	_
,	_	_
but	_	_
not	_	_
to	_	_
the	_	_
closest	_	_
one	_	_
.	_	_

#97
Even	_	_
though	_	_
the	_	_
distribution	_	_
Fig.	_	_
3	_	_
.	_	_

#98
Both	_	_
models	_	_
superimpose	_	_
the	_	_
manifolds	_	_
,	_	_
meaning	_	_
the	_	_
first	_	_
domain	_	_
(	_	_
X1	_	_
)	_	_
is	_	_
mapped	_	_
to	_	_
the	_	_
second	_	_
domain	_	_
(	_	_
X2	_	_
)	_	_
such	_	_
that	_	_
the	_	_
dataset	_	_
of	_	_
the	_	_
first	_	_
domain	_	_
after	_	_
mapping	_	_
(	_	_
G12	_	_
(	_	_
X1	_	_
)	_	_
)	_	_
matches	_	_
the	_	_
second	_	_
domain	_	_
.	_	_

#99
Without	_	_
the	_	_
correspondence	_	_
loss	_	_
,	_	_
though	_	_
,	_	_
this	_	_
mapping	_	_
is	_	_
arbitrary	_	_
and	_	_
thus	_	_
the	_	_
relationships	_	_
found	_	_
vary	_	_
.	_	_

#100
With	_	_
the	_	_
correspondence	_	_
loss	_	_
,	_	_
the	_	_
relationships	_	_
found	_	_
are	_	_
coherent	_	_
.	_	_

#101
This	_	_
is	_	_
confirmed	_	_
with	_	_
(	_	_
a	_	_
)	_	_
a	_	_
GAN	_	_
without	_	_
correspondence	_	_
loss	_	_
on	_	_
artificial	_	_
data	_	_
(	_	_
b	_	_
)	_	_
MAGAN	_	_
on	_	_
artificial	_	_
data	_	_
(	_	_
c	_	_
)	_	_
a	_	_
GAN	_	_
without	_	_
correspondence	_	_
loss	_	_
on	_	_
MNIST	_	_
and	_	_
(	_	_
d	_	_
)	_	_
MAGAN	_	_
on	_	_
MNIST	_	_
.	_	_

#102
of	_	_
G12	_	_
(	_	_
X1	_	_
)	_	_
matches	_	_
the	_	_
distribution	_	_
of	_	_
X2	_	_
,	_	_
for	_	_
an	_	_
individual	_	_
point	_	_
x1i	_	_
∈	_	_
X1	_	_
,	_	_
G12	_	_
(	_	_
x1i	_	_
)	_	_
is	_	_
not	_	_
the	_	_
member	_	_
of	_	_
X2	_	_
that	_	_
is	_	_
most	_	_
closely	_	_
analogous	_	_
to	_	_
it	_	_
.	_	_

#103
The	_	_
MAGAN	_	_
finds	_	_
a	_	_
mapping	_	_
that	_	_
fools	_	_
the	_	_
discriminator	_	_
,	_	_
too	_	_
:	_	_
the	_	_
one	_	_
that	_	_
least	_	_
alters	_	_
the	_	_
original	_	_
input	_	_
(	_	_
Figure	_	_
3b	_	_
)	_	_
.	_	_

#104
Without	_	_
the	_	_
correspondence	_	_
loss	_	_
,	_	_
not	_	_
only	_	_
is	_	_
a	_	_
less-preferred	_	_
manifold	_	_
superimposition	_	_
chosen	_	_
,	_	_
but	_	_
the	_	_
one	_	_
chosen	_	_
varies	_	_
from	_	_
run	_	_
to	_	_
run	_	_
of	_	_
the	_	_
model	_	_
.	_	_

#105
We	_	_
compare	_	_
the	_	_
variability	_	_
of	_	_
the	_	_
learned	_	_
mappings	_	_
across	_	_
multiple	_	_
runs	_	_
of	_	_
each	_	_
model	_	_
with	_	_
100	_	_
independent	_	_
trials	_	_
.	_	_

#106
In	_	_
each	_	_
trial	_	_
we	_	_
evaluate	_	_
the	_	_
relationships	_	_
by	_	_
calculating	_	_
G12	_	_
(	_	_
x1i	_	_
)	_	_
for	_	_
each	_	_
x1i	_	_
∈	_	_
X1	_	_
and	_	_
calculating	_	_
its	_	_
nearest	_	_
neighbor	_	_
x2j	_	_
in	_	_
the	_	_
real	_	_
X2	_	_
.	_	_

#107
Then	_	_
,	_	_
this	_	_
is	_	_
repeated	_	_
for	_	_
the	_	_
other	_	_
domain	_	_
.	_	_

#108
Figure	_	_
4a	_	_
confirms	_	_
that	_	_
for	_	_
the	_	_
GAN	_	_
without	_	_
the	_	_
correspondence	_	_
loss	_	_
,	_	_
the	_	_
learned	_	_
manifold	_	_
superimposition	_	_
(	_	_
and	_	_
thus	_	_
the	_	_
correspondences	_	_
)	_	_
varies	_	_
with	_	_
repeated	_	_
training	_	_
the	_	_
model	_	_
.	_	_

#109
Figure	_	_
4b	_	_
confirms	_	_
the	_	_
MAGAN	_	_
instead	_	_
aligns	_	_
the	_	_
manifolds	_	_
and	_	_
finds	_	_
the	_	_
same	_	_
correspondence	_	_
every	_	_
time	_	_
.	_	_

#110
B.	_	_
MNIST	_	_
Next	_	_
we	_	_
test	_	_
a	_	_
subset	_	_
of	_	_
the	_	_
MNIST	_	_
handwritten	_	_
digit	_	_
data	_	_
by	_	_
taking	_	_
only	_	_
3’s	_	_
and	_	_
7’s	_	_
as	_	_
the	_	_
first	_	_
domain	_	_
X1	_	_
,	_	_
and	_	_
a	_	_
120	_	_
degree	_	_
rotation	_	_
of	_	_
each	_	_
image	_	_
as	_	_
the	_	_
second	_	_
domain	_	_
X2	_	_
.	_	_

#111
Without	_	_
the	_	_
correspondence	_	_
loss	_	_
(	_	_
Figure	_	_
3c	_	_
)	_	_
,	_	_
each	_	_
subpopulation	_	_
in	_	_
X1	_	_
maps	_	_
to	_	_
one	_	_
of	_	_
the	_	_
subpopulations	_	_
in	_	_
X2	_	_
,	_	_
but	_	_
the	_	_
original	_	_
3’s	_	_
go	_	_
to	_	_
the	_	_
rotated	_	_
7’s	_	_
and	_	_
vice	_	_
versa	_	_
.	_	_

#112
There	_	_
is	_	_
no	_	_
term	_	_
in	_	_
the	_	_
objective	_	_
function	_	_
to	_	_
create	_	_
a	_	_
preference	_	_
for	_	_
the	_	_
mapping	_	_
that	_	_
sends	_	_
original	_	_
3’s	_	_
to	_	_
rotated	_	_
3’s	_	_
.	_	_

#113
It	_	_
would	_	_
be	_	_
difficult	_	_
to	_	_
define	_	_
a	_	_
distance	_	_
measure	_	_
that	_	_
captures	_	_
the	_	_
notion	_	_
of	_	_
alignment	_	_
with	_	_
these	_	_
manifolds	_	_
,	_	_
but	_	_
it	_	_
is	_	_
a	_	_
natural	_	_
place	_	_
where	_	_
a	_	_
small	_	_
number	_	_
of	_	_
labeled	_	_
pairs	_	_
could	capability	_
be	_	_
easily	_	_
acquired	_	_
.	_	_

#114
The	_	_
semi-supervised	_	_
correspondence	_	_
loss	_	_
with	_	_
just	_	_
a	_	_
single	_	_
labeled	_	_
pair	_	_
of	_	_
points	_	_
finds	_	_
the	_	_
desired	_	_
manifold	_	_
alignment	_	_
and	_	_
gets	_	_
the	_	_
correct	_	_
correspondences	_	_
for	_	_
all	_	_
of	_	_
the	_	_
other	_	_
points	_	_
that	_	_
are	_	_
unlabeled	_	_
(	_	_
Figure	_	_
3d	_	_
)	_	_
.	_	_

#115
Using	_	_
the	_	_
same	_	_
simulation	_	_
design	_	_
as	_	_
in	_	_
the	_	_
previous	_	_
section	_	_
,	_	_
we	_	_
can	_	_
test	_	_
the	_	_
robustness	_	_
of	_	_
the	_	_
models	_	_
in	_	_
finding	_	_
these	_	_
particular	_	_
mappings	_	_
.	_	_

#116
The	_	_
GAN	_	_
without	_	_
the	_	_
correspondence	_	_
loss	_	_
discovers	_	_
either	_	_
relationship	_	_
with	_	_
roughly	_	_
even	_	_
probability	_	_
(	_	_
Figure	_	_
4c	_	_
)	_	_
.	_	_

#117
Remarkably	_	_
,	_	_
the	_	_
MAGAN	_	_
is	_	_
able	_	_
to	_	_
use	_	_
the	_	_
single	_	_
labeled	_	_
example	_	_
to	_	_
learn	_	_
that	_	_
(	_	_
except	_	_
for	_	_
a	_	_
few	_	_
sloppily	_	_
written	_	_
3’s	_	_
that	_	_
in	_	_
fact	_	_
look	_	_
more	_	_
like	_	_
7’s	_	_
)	_	_
the	_	_
original	_	_
3’s	_	_
correspond	_	_
to	_	_
the	_	_
rotated	_	_
3’s	_	_
and	_	_
that	_	_
the	_	_
original	_	_
7’s	_	_
correspond	_	_
to	_	_
the	_	_
rotated	_	_
7’s	_	_
every	_	_
time	_	_
(	_	_
Figure	_	_
4d	_	_
)	_	_
.	_	_

#118
C.	_	_
Correspondence	_	_
Between	_	_
CyTOF	_	_
Replicates	_	_
We	_	_
now	_	_
test	_	_
the	_	_
MAGAN	_	_
on	_	_
real	_	_
biological	_	_
data	_	_
from	_	_
single-cell	_	_
time-of-flight	_	_
mass	_	_
cytometry	_	_
(	_	_
CyTOF	_	_
)	_	_
measurements	_	_
of	_	_
Fig.	_	_
5	_	_
.	_	_

#119
Selected	_	_
markers	_	_
illustrating	_	_
large	_	_
batch	_	_
effects	_	_
that	_	_
separate	_	_
the	_	_
two	_	_
data	_	_
manifolds	_	_
.	_	_

#120
protein	_	_
abundance	_	_
.	_	_

#121
Each	_	_
protein	_	_
,	_	_
also	_	_
referred	_	_
to	_	_
as	_	_
a	_	_
marker	_	_
,	_	_
is	_	_
measured	_	_
individually	_	_
for	_	_
each	_	_
cell	_	_
,	_	_
allowing	_	_
for	_	_
more	_	_
granular	_	_
analysis	_	_
than	_	_
processes	_	_
that	_	_
only	_	_
measure	_	_
population	_	_
totals	_	_
for	_	_
the	_	_
cells	_	_
in	_	_
a	_	_
given	_	_
sample	_	_
.	_	_

#122
Here	_	_
the	_	_
same	_	_
sample	_	_
was	_	_
run	_	_
twice	_	_
in	_	_
different	_	_
batches	_	_
(	_	_
replicates	_	_
)	_	_
,	_	_
but	_	_
due	_	_
to	_	_
machine	_	_
calibration	_	_
and	_	_
other	_	_
experimental	_	_
details	_	_
that	_	_
are	_	_
impossible	_	_
to	_	_
reproduce	_	_
precisely	_	_
each	_	_
time	_	_
,	_	_
there	_	_
are	_	_
distortions	_	_
between	_	_
the	_	_
batches	_	_
.	_	_

#123
Thus	_	_
,	_	_
even	_	_
though	_	_
the	_	_
same	_	_
physical	_	_
blood	_	_
sample	_	_
is	_	_
being	_	_
measured	_	_
,	_	_
the	_	_
data	_	_
manifold	_	_
of	_	_
each	_	_
batch	_	_
is	_	_
different	_	_
.	_	_

#124
The	_	_
type	_	_
of	_	_
noise	_	_
introduced	_	_
by	_	_
these	_	_
distortions	_	_
is	_	_
not	_	_
known	_	_
a	_	_
priori	_	_
,	_	_
need	_	_
not	_	_
fit	_	_
any	_	_
parametric	_	_
assumption	_	_
,	_	_
and	_	_
is	_	_
likely	_	_
to	_	_
be	_	_
highly	_	_
nonlinear	_	_
.	_	_

#125
To	_	_
analyze	_	_
these	_	_
two	_	_
batches	_	_
together	_	_
,	_	_
we	_	_
need	_	_
to	_	_
know	_	_
which	_	_
cells	_	_
in	_	_
the	_	_
first	_	_
batch	_	_
correspond	_	_
to	_	_
which	_	_
cells	_	_
in	_	_
the	_	_
second	_	_
batch	_	_
.	_	_

#126
To	_	_
do	_	_
this	_	_
,	_	_
we	_	_
learn	_	_
a	_	_
mapping	_	_
with	_	_
the	_	_
MAGAN	_	_
between	_	_
the	_	_
batches	_	_
,	_	_
each	_	_
of	_	_
which	_	_
contains	_	_
75,000	_	_
cells	_	_
with	_	_
34	_	_
individual	_	_
markers	_	_
measured	_	_
.	_	_

#127
Figure	_	_
5	_	_
shows	_	_
that	_	_
the	_	_
two	_	_
batches	_	_
indeed	_	_
contain	_	_
distinct	_	_
differences	_	_
in	_	_
both	_	_
the	_	_
values	_	_
of	_	_
each	_	_
marker	_	_
and	_	_
their	_	_
distribution	_	_
.	_	_

#128
For	_	_
example	_	_
,	_	_
the	_	_
mean	_	_
value	_	_
of	_	_
HLA-DR	_	_
in	_	_
the	_	_
second	_	_
batch	_	_
is	_	_
higher	_	_
than	_	_
the	_	_
maximum	_	_
value	_	_
in	_	_
the	_	_
first	_	_
batch	_	_
.	_	_

#129
We	_	_
demonstrate	_	_
that	_	_
the	_	_
MAGAN	_	_
with	_	_
its	_	_
correspondence	_	_
loss	_	_
preserves	_	_
crucial	_	_
information	_	_
that	_	_
is	_	_
lost	_	_
with	_	_
the	_	_
mapping	_	_
from	_	_
the	_	_
GAN	_	_
without	_	_
the	_	_
correspondence	_	_
loss	_	_
.	_	_

#130
Often	_	_
,	_	_
analysis	_	_
starts	_	_
by	_	_
identifying	_	_
subpopulations	_	_
of	_	_
interest	_	_
.	_	_

#131
For	_	_
example	_	_
,	_	_
naive	_	_
T-cells	_	_
and	_	_
central	_	_
memory	_	_
T-cells	_	_
serve	_	_
distinct	_	_
functions	_	_
and	_	_
can	_	_
be	_	_
identified	_	_
by	_	_
looking	_	_
at	_	_
two	_	_
isoforms	_	_
of	_	_
the	_	_
CD45	_	_
marker	_	_
,	_	_
CD45RA	_	_
and	_	_
CD45RO	_	_
[	_	_
13	_	_
]	_	_
.	_	_

#132
In	_	_
naive	_	_
T-cells	_	_
,	_	_
CD45RA	_	_
is	_	_
present	_	_
while	_	_
CD45RO	_	_
is	_	_
not	_	_
(	_	_
CD45RA+CD45RO-	_	_
)	_	_
,	_	_
and	_	_
in	_	_
central	_	_
memory	_	_
T-cells	_	_
CD45RA	_	_
is	_	_
not	_	_
present	_	_
while	_	_
CD45RO	_	_
is	_	_
(	_	_
CD45RA-CD45RO+	_	_
)	_	_
.	_	_

#133
Figure	_	_
6a	_	_
shows	_	_
that	_	_
very	_	_
few	_	_
cells	_	_
had	_	_
any	_	_
CD45RA	_	_
readings	_	_
in	_	_
the	_	_
first	_	_
batch	_	_
,	_	_
a	_	_
typical	_	_
case	_	_
of	_	_
instrument-induced	_	_
dropout	_	_
.	_	_

#134
Figure	_	_
6b	_	_
shows	_	_
proper	_	_
readings	_	_
for	_	_
CD45RA	_	_
in	_	_
the	_	_
second	_	_
batch	_	_
,	_	_
where	_	_
the	_	_
two	_	_
distinct	_	_
subpopulations	_	_
are	_	_
clearly	_	_
seen	_	_
.	_	_

#135
Both	_	_
models	_	_
learn	_	_
a	_	_
mapping	_	_
for	_	_
the	_	_
first	_	_
batch	_	_
of	_	_
cells	_	_
x1	_	_
such	_	_
that	_	_
G12	_	_
(	_	_
x1	_	_
)	_	_
fools	_	_
their	_	_
discriminators	_	_
by	_	_
looking	_	_
like	_	_
the	_	_
second	_	_
batch	_	_
of	_	_
cells	_	_
x2	_	_
.	_	_

#136
However	_	_
,	_	_
in	_	_
the	_	_
GAN	_	_
without	_	_
the	_	_
correspondence	_	_
loss	_	_
(	_	_
Figure	_	_
7a	_	_
)	_	_
,	_	_
naive	_	_
T-cells	_	_
in	_	_
the	_	_
first	_	_
batch	_	_
are	_	_
mapped	_	_
to	_	_
central	_	_
memory	_	_
T-cells	_	_
in	_	_
the	_	_
second	_	_
batch	_	_
and	_	_
vice	_	_
versa	_	_
.	_	_

#137
If	_	_
we	_	_
went	_	_
through	_	_
the	_	_
manual	_	_
process	_	_
of	_	_
gating	_	_
(	_	_
selecting	_	_
cells	_	_
by	_	_
manually	_	_
looking	_	_
at	_	_
relative	_	_
marker	_	_
expression	_	_
)	_	_
central	_	_
memory	_	_
T-cells	_	_
in	_	_
the	_	_
first	_	_
batch	_	_
and	_	_
wanted	_	_
to	_	_
know	_	_
whether	_	_
their	_	_
expression	_	_
was	_	_
similar	_	_
in	_	_
the	_	_
second	_	_
batch	_	_
,	_	_
we	_	_
would	_	_
be	_	_
led	_	_
to	_	_
believe	_	_
incorrectly	_	_
that	_	_
either	_	_
there	_	_
are	_	_
none	_	_
of	_	_
these	_	_
cells	_	_
in	_	_
the	_	_
second	_	_
batch	_	_
or	_	_
their	_	_
expression	_	_
profile	_	_
is	_	_
radically	_	_
different	_	_
.	_	_

#138
Fig.	_	_
6	_	_
.	_	_

#139
Two	_	_
distinct	_	_
populations	_	_
of	_	_
T-cells	_	_
(	_	_
CD45RA+CD45RO-	_	_
and	_	_
CD45RA-CD45RO+	_	_
)	_	_
with	_	_
severe	_	_
dropout	_	_
in	_	_
the	_	_
CD45RA	_	_
marker	_	_
that	_	_
causes	_	_
a	_	_
difference	_	_
between	_	_
that	_	_
between	_	_
the	_	_
(	_	_
a	_	_
)	_	_
first	_	_
batch	_	_
and	_	_
(	_	_
b	_	_
)	_	_
second	_	_
batch	_	_
.	_	_

#140
Fig.	_	_
7	_	_
.	_	_

#141
(	_	_
a	_	_
)	_	_
Without	_	_
correspondence	_	_
loss	_	_
,	_	_
the	_	_
GAN	_	_
corrects	_	_
the	_	_
batch	_	_
effect	_	_
but	_	_
subpopulations	_	_
are	_	_
reversed	_	_
.	_	_

#142
(	_	_
b	_	_
)	_	_
The	_	_
MAGAN	_	_
still	_	_
corrects	_	_
the	_	_
batch	_	_
effect	_	_
and	_	_
subpopulations	_	_
are	_	_
preserved	_	_
.	_	_

#143
The	_	_
MAGAN	_	_
learns	_	_
a	_	_
different	_	_
mapping	_	_
(	_	_
Figure	_	_
6b	_	_
)	_	_
,	_	_
the	_	_
one	_	_
in	_	_
which	_	_
subpopulation	_	_
correspondences	_	_
are	_	_
preserved	_	_
.	_	_

#144
Notably	_	_
,	_	_
the	_	_
resulting	_	_
mapped	_	_
dataset	_	_
G12	_	_
(	_	_
x1	_	_
)	_	_
is	_	_
not	_	_
negatively	_	_
affected	_	_
by	_	_
the	_	_
correspondence	_	_
loss	_	_
.	_	_

#145
Instead	_	_
,	_	_
out	_	_
of	_	_
the	_	_
two	_	_
mappings	_	_
that	_	_
have	_	_
similar	_	_
results	_	_
at	_	_
the	_	_
aggregate	_	_
level	_	_
,	_	_
the	_	_
one	_	_
that	_	_
maintains	_	_
pointwise	_	_
correspondences	_	_
is	_	_
learned	_	_
.	_	_

#146
With	_	_
the	_	_
cell	_	_
correspondences	_	_
from	_	_
other	_	_
manifold	_	_
superimpositions	_	_
,	_	_
the	_	_
wrong	_	_
biological	_	_
conclusions	_	_
could	feasibility-speculation	_
be	_	_
made	_	_
.	_	_

#147
This	_	_
application	_	_
necessitates	_	_
the	_	_
MAGAN’s	_	_
manifold	_	_
alignment	_	_
.	_	_

#148
D.	_	_
Correspondence	_	_
Between	_	_
Different	_	_
CyTOF	_	_
Panels	_	_

#149
Next	_	_
we	_	_
demonstrate	_	_
the	_	_
MAGAN’s	_	_
ability	_	_
to	_	_
align	_	_
two	_	_
manifolds	_	_
in	_	_
domains	_	_
whose	_	_
dimensionality	_	_
only	_	_
partly	_	_
overlap	_	_
.	_	_

#150
Despite	_	_
the	_	_
other	_	_
advantages	_	_
of	_	_
CyTOF	_	_
instruments	_	_
,	_	_
one	_	_
disadvantage	_	_
is	_	_
that	_	_
CyTOF	_	_
experiments	_	_
can	_	_
only	_	_
measure	_	_
the	_	_
expression	_	_
of	_	_
30-40	_	_
markers	_	_
per	_	_
cell	_	_
.	_	_

#151
Each	_	_
experiment	_	_
chooses	_	_
which	_	_
30-40	_	_
markers	_	_
to	_	_
measure	_	_
and	_	_
refers	_	_
to	_	_
this	_	_
set	_	_
as	_	_
the	_	_
panel	_	_
.	_	_

#152
Even	_	_
though	_	_
each	_	_
panel	_	_
has	_	_
a	_	_
limited	_	_
capacity	_	_
,	_	_
different	_	_
panels	_	_
can	_	_
be	_	_
run	_	_
on	_	_
different	_	_
samples	_	_
from	_	_
the	_	_
same	_	_
physical	_	_
blood	_	_
or	_	_
tissue	_	_
.	_	_

#153
The	_	_
MAGAN	_	_
provides	_	_
the	_	_
opportunity	_	_
to	_	_
combine	_	_
the	_	_
results	_	_
from	_	_
these	_	_
multiple	_	_
panels	_	_
and	_	_
effectively	_	_
increase	_	_
the	_	_
number	_	_
of	_	_
expression	_	_
measurements	_	_
acquired	_	_
for	_	_
each	_	_
cell	_	_
.	_	_

#154
To	_	_
test	_	_
this	_	_
,	_	_
we	_	_
use	_	_
the	_	_
datasets	_	_
from	_	_
two	_	_
experiments	_	_
published	_	_
in	_	_
[	_	_
14	_	_
]	_	_
where	_	_
each	_	_
experiment	_	_
had	_	_
a	_	_
different	_	_
panel	_	_
that	_	_
was	_	_
run	_	_
on	_	_
samples	_	_
from	_	_
the	_	_
same	_	_
population	_	_
of	_	_
cells	_	_
.	_	_

#155
The	_	_
first	_	_
panel	_	_
measured	_	_
35	_	_
markers	_	_
,	_	_
the	_	_
second	_	_
panel	_	_
measured	_	_
31	_	_
markers	_	_
,	_	_
and	_	_
16	_	_
of	_	_
those	_	_
were	_	_
measured	_	_
in	_	_
both	_	_
.	_	_

#156
Without	_	_
any	_	_
advanced	_	_
methods	_	_
,	_	_
all	_	_
we	_	_
would	_	_
be	_	_
able	_	_
to	_	_
do	_	_
across	_	_
experiments	_	_
is	_	_
compare	_	_
population	_	_
summary	_	_
statistics	_	_
—	_	_
and	_	_
lose	_	_
all	_	_
of	_	_
the	_	_
information	_	_
at	_	_
a	_	_
single-cell	_	_
resolution	_	_
that	_	_
motivated	_	_
these	_	_
experiments	_	_
being	_	_
done	_	_
in	_	_
the	_	_
first	_	_
place	_	_
.	_	_

#157
If	_	_
we	_	_
can	_	_
identify	_	_
points	_	_
in	_	_
each	_	_
panel	_	_
that	_	_
measure	_	_
the	_	_
same	_	_
cell	_	_
,	_	_
we	_	_
can	_	_
combine	_	_
the	_	_
measurements	_	_
and	_	_
have	_	_
an	_	_
augmented	_	_
50-dimensional	_	_
dataset	_	_
.	_	_

#158
To	_	_
accomplish	_	_
this	_	_
,	_	_
we	_	_
take	_	_
the	_	_
first	_	_
experiment’s	_	_
panel	_	_
as	_	_
one	_	_
domain	_	_
and	_	_
the	_	_
second	_	_
experiment’s	_	_
panel	_	_
as	_	_
the	_	_
other	_	_
domain	_	_
and	_	_
use	_	_
the	_	_
MAGAN	_	_
to	_	_
learn	_	_
a	_	_
mapping	_	_
between	_	_
the	_	_
two	_	_
.	_	_

#159
We	_	_
then	_	_
combine	_	_
the	_	_
original	_	_
35	_	_
dimensions	_	_
of	_	_
a	_	_
cell	_	_
in	_	_
the	_	_
first	_	_
experiment	_	_
x1i	_	_
with	_	_
the	_	_
15	_	_
dimensions	_	_
unique	_	_
to	_	_
the	_	_
second	_	_
experiment	_	_
from	_	_
that	_	_
cell	_	_
after	_	_
mapping	_	_
G12	_	_
(	_	_
x1i	_	_
)	_	_
.	_	_

#160
For	_	_
combining	_	_
the	_	_
measurements	_	_
from	_	_
each	_	_
experiment	_	_
to	_	_
be	_	_
meaningful	_	_
,	_	_
the	_	_
mapped	_	_
point	_	_
G12	_	_
(	_	_
x1i	_	_
)	_	_
must	deontic	_
correspond	_	_
accurately	_	_
to	_	_
the	_	_
true	_	_
point	_	_
x2i	_	_
.	_	_

#161
This	_	_
notion	_	_
can	_	_
be	_	_
captured	_	_
by	_	_
taking	_	_
the	_	_
correspondence	_	_
loss	_	_
function	_	_
to	_	_
be	_	_
the	_	_
MSE	_	_
across	_	_
the	_	_
16	_	_
dimensions	_	_
that	_	_
are	_	_
shared	_	_
between	_	_
the	_	_
experiments	_	_
.	_	_

#162
In	_	_
other	_	_
words	_	_
,	_	_
the	_	_
MAGAN	_	_
should	deontic	_
use	_	_
the	_	_
shared	_	_
measurements	_	_
to	_	_
match	_	_
cells	_	_
between	_	_
experiments	_	_
,	_	_
and	_	_
then	_	_
learn	_	_
the	_	_
required	_	_
mapping	_	_
for	_	_
all	_	_
of	_	_
the	_	_
measurements	_	_
that	_	_
are	_	_
not	_	_
shared	_	_
.	_	_

#163
Without	_	_
incorporating	_	_
this	_	_
correspondence	_	_
measure	_	_
into	_	_
the	_	_
model	_	_
,	_	_
x1i	_	_
need	_	_
not	_	_
be	_	_
analogous	_	_
to	_	_
G12	_	_
(	_	_
x1i	_	_
)	_	_
in	_	_
any	_	_
way	_	_
,	_	_
and	_	_
their	_	_
information	_	_
could	capability	_
not	_	_
be	_	_
combined	_	_
.	_	_

#164
We	_	_
evaluate	_	_
the	_	_
accuracy	_	_
of	_	_
each	_	_
model’s	_	_
learned	_	_
correspondence	_	_
by	_	_
removing	_	_
one	_	_
of	_	_
the	_	_
markers	_	_
measured	_	_
in	_	_
both	_	_
experiments	_	_
,	_	_
CD3	_	_
,	_	_
from	_	_
the	_	_
first	_	_
experiment	_	_
.	_	_

#165
Then	_	_
,	_	_
we	_	_
map	_	_
points	_	_
from	_	_
the	_	_
first	_	_
experiment	_	_
to	_	_
the	_	_
second	_	_
experiment	_	_
and	_	_
evaluate	_	_
how	_	_
well	_	_
the	_	_
discovered	_	_
CD3	_	_
values	_	_
correspond	_	_
with	_	_
the	_	_
true	_	_
,	_	_
held-out	_	_
CD3	_	_
values	_	_
for	_	_
each	_	_
cell	_	_
from	_	_
the	_	_
first	_	_
experiment	_	_
.	_	_

#166
Figure	_	_
8a	_	_
shows	_	_
that	_	_
the	_	_
GAN	_	_
without	_	_
the	_	_
correspondence	_	_
loss	_	_
finds	_	_
a	_	_
manifold	_	_
superimposition	_	_
that	_	_
does	_	_
not	_	_
preserve	_	_
the	_	_
values	_	_
of	_	_
CD3	_	_
for	_	_
each	_	_
cell	_	_
accurately	_	_
.	_	_

#167
Quantitatively	_	_
,	_	_
we	_	_
can	_	_
evaluate	_	_
this	_	_
with	_	_
the	_	_
correlation	_	_
coefficient	_	_
between	_	_
the	_	_
real	_	_
,	_	_
held-out	_	_
CD3	_	_
values	_	_
and	_	_
the	_	_
CD3	_	_
values	_	_
predicted	_	_
after	_	_
mapping	_	_
each	_	_
point	_	_
to	_	_
the	_	_
other	_	_
domain	_	_
.	_	_

#168
For	_	_
the	_	_
GAN	_	_
without	_	_
the	_	_
correspondence	_	_
loss	_	_
(	_	_
Figure	_	_
8a	_	_
)	_	_
,	_	_
the	_	_
correlation	_	_
is	_	_
-.275	_	_
,	_	_
while	_	_
for	_	_
the	_	_
MAGAN	_	_
(	_	_
Figure	_	_
8b	_	_
)	_	_
it	_	_
is	_	_
.801	_	_
.	_	_

#169
The	_	_
negative	_	_
correlation	_	_
means	_	_
that	_	_
without	_	_
the	_	_
correspondence	_	_
loss	_	_
,	_	_
the	_	_
GAN	_	_
will	_	_
systematically	_	_
map	_	_
cells	_	_
in	_	_
one	_	_
panel	_	_
to	_	_
different	_	_
cells	_	_
in	_	_
the	_	_
other	_	_
panel	_	_
.	_	_

#170
We	_	_
perform	_	_
cross-validation	_	_
by	_	_
repeating	_	_
this	_	_
test	_	_
with	_	_
each	_	_
of	_	_
the	_	_
16	_	_
shared	_	_
markers	_	_
in	_	_
turn	_	_
for	_	_
the	_	_
GAN	_	_
without	_	_
correspondence	_	_
loss	_	_
(	_	_
Figure	_	_
8c	_	_
)	_	_
and	_	_
the	_	_
MAGAN	_	_
(	_	_
Figure	_	_
8d	_	_
)	_	_
.	_	_

#171
While	_	_
some	_	_
of	_	_
the	_	_
markers	_	_
have	_	_
more	_	_
shared	_	_
information	_	_
than	_	_
others	_	_
and	_	_
are	_	_
recovered	_	_
more	_	_
accurately	_	_
,	_	_
in	_	_
all	_	_
cases	_	_
the	_	_
correlation	_	_
is	_	_
better	_	_
with	_	_
the	_	_
MAGAN	_	_
.	_	_

#172
If	_	_
we	_	_
had	_	_
not	_	_
measured	_	_
one	_	_
of	_	_
these	_	_
in	_	_
the	_	_
first	_	_
experiment	_	_
,	_	_
we	_	_
would	_	_
have	_	_
been	_	_
able	_	_
to	_	_
use	_	_
the	_	_
learned	_	_
value	_	_
from	_	_
the	_	_
mapping	_	_
in	_	_
its	_	_
place	_	_
with	_	_
remarkable	_	_
accuracy	_	_
.	_	_

#173
The	_	_
MAGAN	_	_
can	_	_
powerfully	_	_
increase	_	_
the	_	_
impact	_	_
of	_	_
CyTOF	_	_
experiments	_	_
by	_	_
expanding	_	_
their	_	_
limited	_	_
capacity	_	_
of	_	_
markers	_	_
that	_	_
can	_	_
be	_	_
Fig.	_	_
8	_	_
.	_	_

#174
Using	_	_
the	_	_
MAGAN’s	_	_
correspondence	_	_
loss	_	_
,	_	_
measurements	_	_
from	_	_
each	_	_
experiment	_	_
can	_	_
be	_	_
combined	_	_
.	_	_

#175
Their	_	_
true	_	_
values	_	_
are	_	_
known	_	_
because	_	_
they	_	_
are	_	_
measured	_	_
in	_	_
both	_	_
experiments	_	_
.	_	_

#176
Performing	_	_
cross-validation	_	_
by	_	_
holding	_	_
each	_	_
out	_	_
from	_	_
the	_	_
first	_	_
experiment	_	_
,	_	_
we	_	_
can	_	_
measure	_	_
the	_	_
correlation	_	_
between	_	_
the	_	_
predicted	_	_
value	_	_
and	_	_
the	_	_
real	_	_
,	_	_
correct	_	_
value	_	_
.	_	_

#177
measured	_	_
at	_	_
any	_	_
one	_	_
time	_	_
.	_	_

#178
E.	_	_
Correspondence	_	_
Between	_	_
CyTOF	_	_
and	_	_
scRNA-seq	_	_

#179
To	_	_
demonstrate	_	_
the	_	_
MAGAN	_	_
aligning	_	_
manifolds	_	_
of	_	_
domains	_	_
with	_	_
radically	_	_
different	_	_
dimensionality	_	_
and	_	_
underlying	_	_
structure	_	_
,	_	_
we	_	_
use	_	_
it	_	_
to	_	_
find	_	_
correspondences	_	_
between	_	_
CyTOF	_	_
and	_	_
scRNA-seq	_	_
measurements	_	_
made	_	_
on	_	_
the	_	_
same	_	_
set	_	_
of	_	_
cells	_	_
.	_	_

#180
These	_	_
two	_	_
types	_	_
of	_	_
measurements	_	_
have	_	_
advantages	_	_
and	_	_
disadvantages	_	_
,	_	_
including	_	_
the	_	_
throughput	_	_
,	_	_
quality	_	_
,	_	_
and	_	_
amount	_	_
of	_	_
information	_	_
acquired	_	_
from	_	_
each	_	_
.	_	_

#181
Being	_	_
able	_	_
to	_	_
combine	_	_
their	_	_
information	_	_
offers	_	_
the	_	_
possibility	_	_
of	_	_
getting	_	_
the	_	_
best	_	_
from	_	_
each	_	_
and	_	_
finding	_	_
insights	_	_
that	_	_
might	speculation	_
not	_	_
otherwise	_	_
be	_	_
obtainable	_	_
.	_	_

#182
In	_	_
order	_	_
to	_	_
do	_	_
this	_	_
,	_	_
though	_	_
,	_	_
it	_	_
is	_	_
crucial	_	_
for	_	_
pointwise	_	_
correspondences	_	_
to	_	_
be	_	_
accurate	_	_
,	_	_
or	_	_
else	_	_
features	_	_
of	_	_
a	_	_
data	_	_
point	_	_
in	_	_
the	_	_
scRNA-seq	_	_
domain	_	_
will	_	_
be	_	_
ascribed	_	_
to	_	_
the	_	_
incorrect	_	_
point	_	_
in	_	_
the	_	_
CyTOF	_	_
domain	_	_
and	_	_
the	_	_
relationships	_	_
will	_	_
be	_	_
meaningless	_	_
.	_	_

#183
To	_	_
test	_	_
the	_	_
MAGAN	_	_
in	_	_
this	_	_
setting	_	_
,	_	_
we	_	_
use	_	_
a	_	_
dataset	_	_
consisting	_	_
of	_	_
2830	_	_
measurements	_	_
,	_	_
where	_	_
the	_	_
dimensionality	_	_
of	_	_
each	_	_
domain	_	_
is	_	_
12	_	_
and	_	_
12496	_	_
for	_	_
CyTOF	_	_
and	_	_
scRNA-seq	_	_
,	_	_
respectively	_	_
[	_	_
15	_	_
]	_	_
.	_	_

#184
The	_	_
scRNA-seq	_	_
data	_	_
was	_	_
normalized	_	_
with	_	_
the	_	_
inverse	_	_
hyperbolic	_	_
sine	_	_
transform	_	_
and	_	_
preprocessed	_	_
with	_	_
MAGIC	_	_
[	_	_
16	_	_
]	_	_
.	_	_

#185
Here	_	_
we	_	_
know	_	_
the	_	_
true	_	_
correspondences	_	_
of	_	_
which	_	_
points	_	_
in	_	_
the	_	_
two	_	_
domains	_	_
are	_	_
the	_	_
same	_	_
cell	_	_
.	_	_

#186
In	_	_
this	_	_
setting	_	_
we	_	_
use	_	_
the	_	_
semi-supervised	_	_
correspondence	_	_
loss	_	_
and	_	_
show	_	_
the	_	_
impact	_	_
of	_	_
providing	_	_
the	_	_
pairing	_	_
of	_	_
just	_	_
10	_	_
cells	_	_
,	_	_
which	_	_
can	_	_
easily	_	_
be	_	_
acquired	_	_
with	_	_
a	_	_
few	_	_
minutes	_	_
of	_	_
inspection	_	_
.	_	_

#187
This	_	_
effort	_	_
is	_	_
dwarfed	_	_
by	_	_
the	_	_
time	_	_
and	_	_
expense	_	_
involved	_	_
in	_	_
acquiring	_	_
the	_	_
data	_	_
from	_	_
the	_	_
actual	_	_
biological	_	_
experiments	_	_
themselves	_	_
,	_	_
and	_	_
now	_	_
substantially	_	_
improves	_	_
what	_	_
we	_	_
can	_	_
do	_	_
with	_	_
that	_	_
data	_	_
.	_	_

#188
We	_	_
evaluate	_	_
the	_	_
quality	_	_
of	_	_
the	_	_
correspondences	_	_
learned	_	_
with	_	_
two	_	_
metrics	_	_
.	_	_

#189
First	_	_
,	_	_
we	_	_
calculate	_	_
the	_	_
correspondence	_	_
error	_	_
,	_	_
or	_	_
TABLE	_	_
I	_	_
WITH	_	_
THE	_	_
MAGAN’S	_	_
CORRESPONDENCE	_	_
LOSS	_	_
,	_	_
THE	_	_
ACCURACY	_	_
OF	_	_
THE	_	_
LEARNED	_	_
MAPPING	_	_
IS	_	_
DRAMATICALLY	_	_
IMPROVED	_	_
,	_	_
AS	_	_
MEASURED	_	_
BY	_	_
THE	_	_
MSE	_	_
BETWEEN	_	_
THE	_	_
KNOWN	_	_
REAL	_	_
POINT	_	_
x	_	_
AND	_	_
THE	_	_
PREDICTED	_	_
POINT	_	_
G	_	_
(	_	_
x	_	_
)	_	_
AFTER	_	_
MAPPING	_	_
.	_	_

#190
Paired	_	_
CyTOF	_	_
&	_	_
scRNA-seq	_	_
Without	_	_
Correspondence	_	_
Loss	_	_
With	_	_
Correspondence	_	_
Loss	_	_
MSE	_	_
(	_	_
x1	_	_
,	_	_
G21	_	_
(	_	_
x2	_	_
)	_	_
)	_	_
99.3	_	_
22.0	_	_
MSE	_	_
(	_	_
x2	_	_
,	_	_
G12	_	_
(	_	_
x1	_	_
)	_	_
)	_	_
33.7	_	_
7.1	_	_
MSE	_	_
between	_	_
the	_	_
true	_	_
known	_	_
value	_	_
x1i	_	_
∈	_	_
X1	_	_
and	_	_
the	_	_
predicted	_	_
correspondence	_	_
G21	_	_
(	_	_
x2i	_	_
)	_	_
.	_	_

#191
Table	_	_
I	_	_
shows	_	_
the	_	_
correspondence	_	_
error	_	_
for	_	_
the	_	_
correspondences	_	_
mapping	_	_
to	_	_
and	_	_
from	_	_
each	_	_
domain	_	_
.	_	_

#192
With	_	_
the	_	_
correspondence	_	_
loss	_	_
,	_	_
the	_	_
MAGAN	_	_
cuts	_	_
the	_	_
MSE	_	_
dramatically	_	_
.	_	_

#193
IV	_	_
.	_	_

#194
DISCUSSION	_	_
A	_	_
considerable	_	_
amount	_	_
of	_	_
work	_	_
has	_	_
been	_	_
devoted	_	_
to	_	_
GAN	_	_
architectures	_	_
in	_	_
recent	_	_
years	_	_
.	_	_

#195
After	_	_
the	_	_
original	_	_
paper	_	_
introduced	_	_
the	_	_
GAN	_	_
[	_	_
17	_	_
]	_	_
,	_	_
the	_	_
difficulty	_	_
in	_	_
training	_	_
them	_	_
prompted	_	_
the	_	_
need	_	_
for	_	_
improved	_	_
training	_	_
techniques	_	_
[	_	_
12	_	_
]	_	_
.	_	_

#196
Beyond	_	_
the	_	_
unsupervised	_	_
models	_	_
discussed	_	_
earlier	_	_
,	_	_
other	_	_
models	_	_
have	_	_
tried	_	_
improving	_	_
the	_	_
accuracy	_	_
of	_	_
found	_	_
correspondences	_	_
with	_	_
supervision	_	_
or	_	_
semi-supervision	_	_
.	_	_

#197
These	_	_
models	_	_
have	_	_
included	_	_
forcing	_	_
the	_	_
networks	_	_
to	_	_
model	_	_
specific	_	_
additional	_	_
codes	_	_
or	_	_
representations	_	_
and	_	_
conditioning	_	_
on	_	_
external	_	_
variables	_	_
such	_	_
as	_	_
text	_	_
[	_	_
18	_	_
,	_	_
19	_	_
,	_	_
20	_	_
]	_	_
.	_	_

#198
Other	_	_
approaches	_	_
decompose	_	_
the	_	_
primary	_	_
task	_	_
of	_	_
the	_	_
GAN	_	_
into	_	_
separate	_	_
,	_	_
domain-specific	_	_
tasks	_	_
performed	_	_
sequentially	_	_
[	_	_
21	_	_
,	_	_
22	_	_
,	_	_
23	_	_
]	_	_
.	_	_

#199
All	_	_
of	_	_
these	_	_
have	_	_
focused	_	_
on	_	_
image	_	_
domains	_	_
.	_	_

#200
Compared	_	_
to	_	_
image	_	_
domains	_	_
,	_	_
relatively	_	_
little	_	_
has	_	_
been	_	_
done	_	_
with	_	_
GANs	_	_
in	_	_
biological	_	_
domains	_	_
.	_	_

#201
[	_	_
24	_	_
]	_	_
does	_	_
not	_	_
use	_	_
a	_	_
GAN	_	_
,	_	_
but	_	_
performs	_	_
batch	_	_
correction	_	_
with	_	_
neural	_	_
networks	_	_
.	_	_

#202
We	_	_
show	_	_
here	_	_
how	_	_
GANs	_	_
can	_	_
be	_	_
used	_	_
for	_	_
tasks	_	_
where	_	_
the	_	_
generation	_	_
of	_	_
new	_	_
samples	_	_
from	_	_
a	_	_
given	_	_
distribution	_	_
is	_	_
not	_	_
the	_	_
primary	_	_
goal	_	_
.	_	_

#203
In	_	_
these	_	_
cases	_	_
,	_	_
other	_	_
terms	_	_
in	_	_
the	_	_
objective	_	_
function	_	_
can	_	_
be	_	_
used	_	_
to	_	_
better	_	_
match	_	_
the	_	_
loss	_	_
landscape	_	_
with	_	_
the	_	_
task	_	_
at	_	_
hand	_	_
.	_	_

#204
The	_	_
MAGAN	_	_
illustrates	_	_
one	_	_
such	_	_
re-purposing	_	_
of	_	_
the	_	_
GAN	_	_
architecture	_	_
that	_	_
outperforms	_	_
the	_	_
existing	_	_
architectures	_	_
at	_	_
finding	_	_
point-wise	_	_
correspondences	_	_
between	_	_
domains	_	_
.	_	_

#205
V.	_	_
CONCLUSION	_	_
The	_	_
MAGAN	_	_
discovers	_	_
relationships	_	_
between	_	_
domains	_	_
by	_	_
aligning	_	_
their	_	_
manifolds	_	_
rather	_	_
than	_	_
just	_	_
superimposing	_	_
them	_	_
.	_	_

#206
Crucially	_	_
,	_	_
this	_	_
can	_	_
be	_	_
used	_	_
when	_	_
one	_	_
system	_	_
is	_	_
measured	_	_
in	_	_
two	_	_
different	_	_
ways	_	_
and	_	_
thus	_	_
forms	_	_
two	_	_
different	_	_
manifolds	_	_
.	_	_

#207
In	_	_
this	_	_
case	_	_
,	_	_
the	_	_
point	_	_
in	_	_
each	_	_
manifold	_	_
for	_	_
one	_	_
object	_	_
in	_	_
the	_	_
underlying	_	_
system	_	_
are	_	_
linked	_	_
.	_	_

#208
This	_	_
preserves	_	_
information	_	_
at	_	_
a	_	_
pointwise	_	_
(	_	_
rather	_	_
than	_	_
just	_	_
population	_	_
aggregate	_	_
)	_	_
level	_	_
.	_	_

#209
The	_	_
MAGAN	_	_
facilitates	_	_
integration	_	_
of	_	_
datasets	_	_
from	_	_
multiple	_	_
biological	_	_
modalities	_	_
.	_	_

#210
As	_	_
each	_	_
type	_	_
of	_	_
experiment	_	_
captures	_	_
different	_	_
information	_	_
with	_	_
different	_	_
strengths	_	_
and	_	_
weaknesses	_	_
,	_	_
combining	_	_
them	_	_
makes	_	_
possible	_	_
discoveries	_	_
that	_	_
could	_	_
not	_	_
be	_	_
found	_	_
otherwise	_	_
.	_	_