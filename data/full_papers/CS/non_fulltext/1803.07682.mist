#0
A	_	_
Feature-Driven	_	_
Active	_	_
Framework	_	_
for	_	_
Ultrasound-Based	_	_
Brain	_	_
Shift	_	_
Compensation	_	_
Jie	_	_
Luo1,2	_	_
,	_	_
Matt	_	_
Toews3	_	_
,	_	_
Ines	_	_
Machado1	_	_
,	_	_
Sarah	_	_
Frisken1	_	_
,	_	_
Miaomiao	_	_
Zhang4	_	_
,	_	_
Frank	_	_
Preiswerk1	_	_
,	_	_
Alireza	_	_
Sedghi1	_	_
,	_	_
Hongyi	_	_
Ding5	_	_
,	_	_
Steve	_	_
Pieper1	_	_
,	_	_
Polina	_	_
Golland6	_	_
,	_	_
Alexandra	_	_
Golby1	_	_
,	_	_
Masashi	_	_
Sugiyama7,2	_	_
and	_	_
William	_	_
M.	_	_
Wells	_	_
III1,6	_	_
1Brigham	_	_
and	_	_
Women’s	_	_
Hospital	_	_
,	_	_
Harvard	_	_
Medical	_	_
School	_	_
,	_	_
USA	_	_
2Graduate	_	_
School	_	_
of	_	_
Frontier	_	_
Sciences	_	_
,	_	_
The	_	_
University	_	_
of	_	_
Tokyo	_	_
,	_	_
Japan	_	_
3Ecole	_	_
de	_	_
Technologie	_	_
Superieure	_	_
,	_	_
Canada	_	_
4Computer	_	_
Science	_	_
and	_	_
Engineering	_	_
Department	_	_
,	_	_
Lehigh	_	_
University	_	_
,	_	_
USA	_	_
5Department	_	_
of	_	_
Computer	_	_
Science	_	_
,	_	_
The	_	_
University	_	_
of	_	_
Tokyo	_	_
,	_	_
Japan	_	_
6Computer	_	_
Science	_	_
and	_	_
Artificial	_	_
Intelligence	_	_
Laboratory	_	_
,	_	_
MIT	_	_
,	_	_
USA	_	_
7Center	_	_
for	_	_
Advanced	_	_
Intelligence	_	_
Project	_	_
,	_	_
RIKEN	_	_
,	_	_
Japan	_	_
jluo5	_	_
@	_	_
bwh.harvard.edu	_	_
Abstract	_	_
.	_	_

#1
A	_	_
reliable	_	_
Ultrasound	_	_
(	_	_
US	_	_
)	_	_
-to-US	_	_
registration	_	_
method	_	_
to	_	_
compensate	_	_
for	_	_
brain	_	_
shift	_	_
would	_	_
substantially	_	_
improve	_	_
Image-Guided	_	_
Neurological	_	_
Surgery	_	_
.	_	_

#2
Developing	_	_
such	_	_
a	_	_
registration	_	_
method	_	_
is	_	_
very	_	_
challenging	_	_
,	_	_
due	_	_
to	_	_
factors	_	_
such	_	_
as	_	_
missing	_	_
correspondence	_	_
in	_	_
images	_	_
,	_	_
the	_	_
complexity	_	_
of	_	_
brain	_	_
pathology	_	_
and	_	_
the	_	_
demand	_	_
for	_	_
fast	_	_
computation	_	_
.	_	_

#3
We	_	_
propose	_	_
a	_	_
novel	_	_
feature-driven	_	_
active	_	_
framework	_	_
.	_	_

#4
Here	_	_
,	_	_
landmarks	_	_
and	_	_
their	_	_
displacement	_	_
are	_	_
first	_	_
estimated	_	_
from	_	_
a	_	_
pair	_	_
of	_	_
US	_	_
images	_	_
using	_	_
corresponding	_	_
local	_	_
image	_	_
features	_	_
.	_	_

#5
Subsequently	_	_
,	_	_
a	_	_
Gaussian	_	_
Process	_	_
(	_	_
GP	_	_
)	_	_
model	_	_
is	_	_
used	_	_
to	_	_
interpolate	_	_
a	_	_
dense	_	_
deformation	_	_
field	_	_
from	_	_
the	_	_
sparse	_	_
landmarks	_	_
.	_	_

#6
Kernels	_	_
of	_	_
the	_	_
GP	_	_
are	_	_
estimated	_	_
by	_	_
using	_	_
variograms	_	_
and	_	_
a	_	_
discrete	_	_
grid	_	_
search	_	_
method	_	_
.	_	_

#7
If	_	_
necessary	_	_
,	_	_
the	_	_
user	_	_
can	_	_
actively	_	_
add	_	_
new	_	_
landmarks	_	_
based	_	_
on	_	_
the	_	_
image	_	_
context	_	_
and	_	_
visualization	_	_
of	_	_
the	_	_
uncertainty	_	_
measure	_	_
provided	_	_
by	_	_
the	_	_
GP	_	_
to	_	_
further	_	_
improve	_	_
the	_	_
result	_	_
.	_	_

#8
We	_	_
retrospectively	_	_
demonstrate	_	_
our	_	_
registration	_	_
framework	_	_
as	_	_
a	_	_
robust	_	_
and	_	_
accurate	_	_
brain	_	_
shift	_	_
compensation	_	_
solution	_	_
on	_	_
clinical	_	_
data	_	_
acquired	_	_
during	_	_
neurosurgery	_	_
.	_	_

#9
Keywords	_	_
:	_	_
Brain	_	_
shift	_	_
,	_	_
Feature-based	_	_
registration	_	_
,	_	_
Gaussian	_	_
process	_	_
,	_	_
Variograms	_	_
,	_	_
Uncertainty	_	_
,	_	_
Active	_	_
registration	_	_

#10
1	_	_
Introduction	_	_

#11
Surgical	_	_
resection	_	_
is	_	_
the	_	_
initial	_	_
treatment	_	_
for	_	_
nearly	_	_
all	_	_
brain	_	_
tumors	_	_
.	_	_

#12
The	_	_
achieved	_	_
extent-of-resection	_	_
is	_	_
strongly	_	_
correlated	_	_
with	_	_
prognosis	_	_
and	_	_
is	_	_
the	_	_
single	_	_
greatest	_	_
modifiable	_	_
determinant	_	_
of	_	_
survival	_	_
.	_	_

#13
Brain	_	_
tumors	_	_
are	_	_
intimately	_	_
involved	_	_
in	_	_
surrounding	_	_
functioning	_	_
brain	_	_
tissue	_	_
,	_	_
aggressive	_	_
resection	_	_
must	deontic	_
be	_	_
balanced	_	_
against	_	_
the	_	_
risk	_	_
of	_	_
causing	_	_
new	_	_
neurological	_	_
deficits	_	_
.	_	_

#14
During	_	_
neurosurgery	_	_
,	_	_
Image-Guided	_	_
Neurosurgical	_	_
Systems	_	_
(	_	_
IGNSs	_	_
)	_	_
provide	_	_
a	_	_
patient-to-image	_	_
mapping	_	_
that	_	_
relates	_	_
the	_	_
preoperative	_	_
image	_	_
data	_	_
to	_	_
an	_	_
intra-operative	_	_
patient	_	_
coordinate	_	_
system	_	_
,	_	_
allowing	_	_
surgeons	_	_
to	_	_
infer	_	_
the	_	_
locations	_	_
of	_	_
their	_	_
surgical	_	_
instruments	_	_
relative	_	_
to	_	_
preoperative	_	_
image	_	_
data	_	_
and	_	_
helping	_	_
them	_	_
to	_	_
optimize	_	_
the	_	_
extent	_	_
of	_	_
resection	_	_
while	_	_
avoiding	_	_
damage	_	_
to	_	_
critical	_	_
structures	_	_
.	_	_

#15
Commercial	_	_
IGNSs	_	_
assume	_	_
a	_	_
rigid	_	_
registration	_	_
between	_	_
preoperative	_	_
imaging	_	_
and	_	_
patient	_	_
coordinates	_	_
.	_	_

#16
However	_	_
,	_	_
intraoperative	_	_
deformation	_	_
of	_	_
the	_	_
brain	_	_
,	_	_
which	_	_
is	_	_
also	_	_
known	_	_
as	_	_
brain	_	_
shift	_	_
,	_	_
invalidates	_	_
this	_	_
assumption	_	_
.	_	_

#17
Since	_	_
brain	_	_
shift	_	_
progresses	_	_
during	_	_
surgery	_	_
,	_	_
the	_	_
rigid	_	_
patient-to-image	_	_
mapping	_	_
of	_	_
IGNS	_	_
becomes	_	_
less	_	_
and	_	_
less	_	_
accurate	_	_
.	_	_

#18
Consequently	_	_
,	_	_
most	_	_
surgeons	_	_
only	_	_
use	_	_
IGNS	_	_
to	_	_
make	_	_
a	_	_
surgical	_	_
plan	_	_
but	_	_
justifiably	_	_
do	_	_
not	_	_
trust	_	_
it	_	_
throughout	_	_
the	_	_
course	_	_
of	_	_
an	_	_
operation	_	_
[	_	_
1,2	_	_
]	_	_
.	_	_

#19
Related	_	_
Work	_	_

#20
As	_	_
one	_	_
of	_	_
the	_	_
most	_	_
important	_	_
error	_	_
sources	_	_
in	_	_
IGNS	_	_
,	_	_
intra-operative	_	_
brain	_	_
shift	_	_
must	deontic	_
be	_	_
compensated	_	_
in	_	_
order	_	_
to	_	_
increase	_	_
the	_	_
accuracy	_	_
of	_	_
neurosurgery	_	_
.	_	_

#21
Registration	_	_
between	_	_
the	_	_
Intraoperative	_	_
MRI	_	_
(	_	_
iMRI	_	_
)	_	_
image	_	_
,	_	_
which	_	_
provides	_	_
clinicians	_	_
with	_	_
an	_	_
updated	_	_
view	_	_
of	_	_
anatomy	_	_
during	_	_
surgery	_	_
,	_	_
and	_	_
preoperative	_	_
MRI	_	_
(	_	_
preMRI	_	_
)	_	_
image	_	_
(	_	_
preop-to-intraop	_	_
registration	_	_
)	_	_
has	_	_
been	_	_
a	_	_
successful	_	_
strategy	_	_
for	_	_
brain	_	_
shift	_	_
compensation	_	_
[	_	_
3,4,5,6,7	_	_
]	_	_
.	_	_

#22
However	_	_
,	_	_
iMRI	_	_
acquisition	_	_
is	_	_
disruptive	_	_
,	_	_
expensive	_	_
and	_	_
time	_	_
consuming	_	_
,	_	_
making	_	_
this	_	_
technology	_	_
unavailable	_	_
for	_	_
most	_	_
clinical	_	_
centers	_	_
worldwide	_	_
.	_	_

#23
More	_	_
recently	_	_
,	_	_
3D	_	_
intraoperative	_	_
Ultrasound	_	_
(	_	_
iUS	_	_
)	_	_
appears	_	_
to	_	_
be	_	_
a	_	_
promising	_	_
replacement	_	_
for	_	_
iMRI	_	_
.	_	_

#24
Although	_	_
some	_	_
progress	_	_
has	_	_
been	_	_
made	_	_
by	_	_
previous	_	_
work	_	_
on	_	_
preMRI-to-iUS	_	_
registration	_	_
[	_	_
8,9,10,11,12,13,14	_	_
]	_	_
,	_	_
yet	_	_
there	_	_
are	_	_
still	_	_
no	_	_
clinically	_	_
accepted	_	_
solutions	_	_
and	_	_
no	_	_
commercial	_	_
neuro-navigation	_	_
systems	_	_
that	_	_
provide	_	_
brain	_	_
shift	_	_
compensation	_	_
.	_	_

#25
This	_	_
is	_	_
because	_	_
of	_	_
three	_	_
reasons	_	_
:	_	_
1	_	_
)	_	_
Most	_	_
non-rigid	_	_
registration	_	_
methods	_	_
can	_	_
not	_	_
handle	_	_
artifacts	_	_
and	_	_
missing	_	_
structures	_	_
in	_	_
iUS	_	_
;	_	_
2	_	_
)	_	_
The	_	_
multi-modality	_	_
of	_	_
preMRI-to-iUS	_	_
registration	_	_
makes	_	_
the	_	_
already	_	_
difficult	_	_
problem	_	_
even	_	_
more	_	_
challenging	_	_
;	_	_
3	_	_
)	_	_
A	_	_
few	_	_
methods	_	_
[	_	_
15	_	_
]	_	_
can	_	_
achieve	_	_
a	_	_
reasonable	_	_
alignment	_	_
,	_	_
yet	_	_
they	_	_
take	_	_
around	_	_
50	_	_
minutes	_	_
for	_	_
an	_	_
US	_	_
pair	_	_
and	_	_
are	_	_
too	_	_
slow	_	_
to	_	_
be	_	_
clinically	_	_
applicable	_	_
.	_	_

#26
Another	_	_
shortcoming	_	_
of	_	_
existing	_	_
brain	_	_
shift	_	_
compensation	_	_
approaches	_	_
is	_	_
the	_	_
lack	_	_
of	_	_
an	_	_
uncertainty	_	_
measure	_	_
.	_	_

#27
Brain	_	_
shift	_	_
is	_	_
a	_	_
complex	_	_
spatiotemporal	_	_
phenomenon	_	_
,	_	_
and	_	_
given	_	_
the	_	_
state	_	_
of	_	_
registration	_	_
technology	_	_
,	_	_
and	_	_
the	_	_
importance	_	_
of	_	_
the	_	_
result	_	_
,	_	_
it	_	_
seems	_	_
reasonable	_	_
to	_	_
expect	_	_
,	_	_
e.g.	_	_
,	_	_
error	_	_
bars	_	_
that	_	_
indicate	_	_
the	_	_
confidence	_	_
level	_	_
in	_	_
the	_	_
estimated	_	_
deformation	_	_
.	_	_

#28
In	_	_
fact	_	_
,	_	_
registration	_	_
uncertainty	_	_
can	_	_
actually	_	_
helps	_	_
surgeons	_	_
make	_	_
more	_	_
informed	_	_
decisions	_	_
.	_	_

#29
If	_	_
a	_	_
surgeon	_	_
must	deontic	_
decide	_	_
whether	_	_
to	_	_
continue	_	_
resection	_	_
near	_	_
a	_	_
critical	_	_
structure	_	_
,	_	_
it	_	_
is	_	_
vital	_	_
that	_	_
they	_	_
know	_	_
how	_	_
far	_	_
the	_	_
instrument	_	_
is	_	_
predicted	_	_
to	_	_
be	_	_
from	_	_
the	_	_
structure	_	_
and	_	_
how	_	_
likely	_	_
the	_	_
prediction	_	_
is	_	_
to	_	_
be	_	_
accurate	_	_
.	_	_

#30
Moreover	_	_
,	_	_
if	_	_
a	_	_
large	_	_
registration	_	_
error	_	_
at	_	_
location	_	_
A	_	_
and	_	_
small	_	_
error	_	_
at	_	_
location	_	_
B	_	_
are	_	_
observed	_	_
in	_	_
the	_	_
vicinity	_	_
of	_	_
surgical	_	_
field	_	_
,	_	_
without	_	_
knowledge	_	_
of	_	_
registration	_	_
uncertainty	_	_
,	_	_
the	_	_
surgeon	_	_
would	_	_
probably	_	_
assume	_	_
a	_	_
large	_	_
error	_	_
everywhere	_	_
and	_	_
thus	_	_
ignore	_	_
the	_	_
registration	_	_
altogether	_	_
.	_	_

#31
If	_	_
only	_	_
s/he	_	_
knows	_	_
that	_	_
A	_	_
lies	_	_
in	_	_
an	_	_
area	_	_
of	_	_
high	_	_
uncertainty	_	_
while	_	_
B	_	_
lies	_	_
in	_	_
an	_	_
area	_	_
of	_	_
low	_	_
uncertainty	_	_
,	_	_
s/he	_	_
would	_	_
have	_	_
greater	_	_
confidence	_	_
in	_	_
the	_	_
registration	_	_
at	_	_
B	_	_
and	_	_
other	_	_
locations	_	_
of	_	_
low	_	_
uncertainty	_	_
.	_	_

#32
In	_	_
this	_	_
paper	_	_
,	_	_
we	_	_
propose	_	_
a	_	_
novel	_	_
feature-driven	_	_
active	_	_
framework	_	_
for	_	_
brain	_	_
shift	_	_
compensation	_	_
.	_	_

#33
Here	_	_
,	_	_
landmarks	_	_
and	_	_
their	_	_
displacement	_	_
are	_	_
first	_	_
estimated	_	_
from	_	_
a	_	_
pair	_	_
of	_	_
US	_	_
images	_	_
using	_	_
corresponding	_	_
local	_	_
image	_	_
features	_	_
.	_	_

#34
Subsequently	_	_
,	_	_
A	_	_
Feature-Driven	_	_
Active	_	_
Framework	_	_
for	_	_
US-based	_	_
Brain	_	_
Shift	_	_
Compensation	_	_
3	_	_
a	_	_
Gaussian	_	_
Process	_	_
(	_	_
GP	_	_
)	_	_
model	_	_
[	_	_
18	_	_
]	_	_
is	_	_
used	_	_
to	_	_
interpolate	_	_
a	_	_
dense	_	_
deformation	_	_
field	_	_
from	_	_
the	_	_
sparse	_	_
landmarks	_	_
.	_	_

#35
Kernels	_	_
of	_	_
the	_	_
GP	_	_
are	_	_
estimated	_	_
by	_	_
using	_	_
variograms	_	_
and	_	_
a	_	_
discrete	_	_
grid	_	_
search	_	_
method	_	_
.	_	_

#36
If	_	_
necessary	_	_
,	_	_
for	_	_
areas	_	_
that	_	_
are	_	_
difficult	_	_
to	_	_
align	_	_
,	_	_
the	_	_
user	_	_
can	_	_
actively	_	_
add	_	_
new	_	_
landmarks	_	_
based	_	_
on	_	_
the	_	_
image	_	_
context	_	_
and	_	_
visualization	_	_
of	_	_
the	_	_
uncertainty	_	_
measure	_	_
provided	_	_
by	_	_
the	_	_
GP	_	_
to	_	_
further	_	_
improve	_	_
the	_	_
registration	_	_
accuracy	_	_
.	_	_

#37
Contributions	_	_
and	_	_
novelties	_	_
of	_	_
our	_	_
work	_	_
can	_	_
be	_	_
summarized	_	_
as	_	_
follows	_	_
:	_	_
1	_	_
.	_	_

#38
The	_	_
proposed	_	_
feature-based	_	_
registration	_	_
is	_	_
robust	_	_
for	_	_
aligning	_	_
iUS	_	_
image	_	_
pairs	_	_
with	_	_
missing	_	_
correspondence	_	_
and	_	_
is	_	_
fast	_	_
.	_	_

#39
2	_	_
.	_	_

#40
We	_	_
explore	_	_
applying	_	_
a	_	_
GP	_	_
model	_	_
and	_	_
variograms	_	_
for	_	_
image	_	_
registration	_	_
.	_	_

#41
3	_	_
.	_	_

#42
Registration	_	_
uncertainty	_	_
in	_	_
transformation	_	_
parameters	_	_
can	_	_
be	_	_
naturally	_	_
obtained	_	_
from	_	_
the	_	_
GP	_	_
model	_	_
.	_	_

#43
4	_	_
.	_	_

#44
To	_	_
the	_	_
best	_	_
of	_	_
our	_	_
knowledge	_	_
,	_	_
the	_	_
proposed	_	_
active	_	_
registration	_	_
strategy	_	_
is	_	_
the	_	_
first	_	_
method	_	_
to	_	_
actively	_	_
combine	_	_
user	_	_
expertise	_	_
in	_	_
brain	_	_
shift	_	_
compensation	_	_
.	_	_

#45
5	_	_
.	_	_

#46
We	_	_
retrospectively	_	_
demonstrate	_	_
the	_	_
efficacy	_	_
of	_	_
our	_	_
method	_	_
on	_	_
clinical	_	_
data	_	_
acquired	_	_
during	_	_
neurosurgery	_	_
.	_	_

#47
2	_	_
Method	_	_

#48
2.1	_	_
The	_	_
role	_	_
of	_	_
US-to-US	_	_
registration	_	_

#49
In	_	_
order	_	_
to	_	_
alleviate	_	_
the	_	_
difficulty	_	_
of	_	_
preop-to-intraop	_	_
registration	_	_
,	_	_
instead	_	_
of	_	_
directly	_	_
aligning	_	_
iMRI	_	_
and	_	_
iUS	_	_
images	_	_
,	_	_
we	_	_
choose	_	_
an	_	_
iterative	_	_
compensation	_	_
approach	_	_
which	_	_
is	_	_
similar	_	_
to	_	_
the	_	_
work	_	_
in	_	_
[	_	_
16	_	_
]	_	_
.	_	_

#50
As	_	_
shown	_	_
in	_	_
Fig.1	_	_
.	_	_

#51
acquisition	_	_
processes	_	_
for	_	_
pre-duraUS	_	_
(	_	_
preUS	_	_
)	_	_
and	_	_
postresectionUS	_	_
(	_	_
postUS	_	_
)	_	_
take	_	_
place	_	_
before	_	_
opening	_	_
the	_	_
dura	_	_
and	_	_
after	_	_
tumor	_	_
resection	_	_
,	_	_
respectively	_	_
.	_	_

#52
Since	_	_
most	_	_
brain-shift	_	_
occurs	_	_
after	_	_
taking	_	_
the	_	_
preUS	_	_
,	_	_
a	_	_
rigid	_	_
multi-modal	_	_
registration	_	_
may	_	_
be	_	_
suffice	_	_
to	_	_
achieve	_	_
a	_	_
good	_	_
alignment	_	_
T	_	_
rigid	_	_
between	_	_
preMRI	_	_
and	_	_
preUS	_	_
[	_	_
13	_	_
]	_	_
.	_	_

#53
Next	_	_
,	_	_
we	_	_
register	_	_
the	_	_
preUS	_	_
to	_	_
postUS	_	_
using	_	_
the	_	_
proposed	_	_
feature-driven	_	_
active	_	_
framework	_	_
to	_	_
acquire	_	_
a	_	_
deformable	_	_
mapping	_	_
Tdeform	_	_
.	_	_

#54
After	_	_
propagating	_	_
Trigid	_	_
and	_	_
Tdeform	_	_
to	_	_
the	_	_
preMRI	_	_
,	_	_
surgeons	_	_
may	_	_
use	_	_
it	_	_
as	_	_
an	_	_
updated	_	_
view	_	_
of	_	_
anatomy	_	_
to	_	_
compensate	_	_
for	_	_
brain	_	_
shift	_	_
during	_	_
the	_	_
surgery	_	_
.	_	_

#55
Fig.	_	_
1	_	_
.	_	_

#56
Pipeline	_	_
of	_	_
the	_	_
US-based	_	_
brain	_	_
shift	_	_
compensation	_	_
.	_	_

#57
2.2	_	_
Feature-based	_	_
registration	_	_
strategy	_	_

#58
Because	_	_
of	_	_
tumor	_	_
resection	_	_
,	_	_
compensating	_	_
for	_	_
brain	_	_
shift	_	_
requires	_	_
non-rigid	_	_
registration	_	_
algorithms	_	_
capable	_	_
of	_	_
aligning	_	_
structures	_	_
in	_	_
one	_	_
image	_	_
that	_	_
have	_	_
no	_	_
correspondences	_	_
in	_	_
the	_	_
other	_	_
image	_	_
.	_	_

#59
In	_	_
this	_	_
situation	_	_
,	_	_
many	_	_
image	_	_
registration	_	_
4	_	_
J.Luo	_	_
et	_	_
al.	_	_
Fig.	_	_
2	_	_
.	_	_

#60
Pipeline	_	_
of	_	_
the	_	_
feature-based	_	_
active	_	_
preduraUS-to-postUS	_	_
registration	_	_
.	_	_

#61
methods	_	_
that	_	_
take	_	_
into	_	_
account	_	_
the	_	_
intensity	_	_
pattern	_	_
of	_	_
the	_	_
entire	_	_
image	_	_
will	_	_
become	_	_
trapped	_	_
in	_	_
incorrect	_	_
local	_	_
minima	_	_
.	_	_

#62
We	_	_
therefore	_	_
pursue	_	_
a	_	_
Feature-Based	_	_
Registration	_	_
(	_	_
FBR	_	_
)	_	_
strategy	_	_
due	_	_
to	_	_
its	_	_
robustness	_	_
in	_	_
registering	_	_
images	_	_
with	_	_
missing	_	_
correspondence	_	_
[	_	_
17	_	_
]	_	_
.	_	_

#63
FBR	_	_
mainly	_	_
consists	_	_
of	_	_
3	_	_
steps	_	_
:	_	_
feature-extraction	_	_
,	_	_
feature-matching	_	_
and	_	_
dense	_	_
deformation	_	_
field	_	_
estimation	_	_
.	_	_

#64
An	_	_
optional	_	_
“active	_	_
registration”	_	_
step	_	_
can	_	_
be	_	_
added	_	_
depends	_	_
on	_	_
the	_	_
quality	_	_
of	_	_
FBR	_	_
.	_	_

#65
Feature	_	_
extraction	_	_
and	_	_
matching	_	_
As	_	_
illustrated	_	_
in	_	_
Fig.2	_	_
(	_	_
a	_	_
)	_	_
(	_	_
b	_	_
)	_	_
,	_	_
distinctive	_	_
local	_	_
image	_	_
features	_	_
are	_	_
automatically	_	_
extracted	_	_
and	_	_
identified	_	_
as	_	_
key-points	_	_
on	_	_
preUS	_	_
and	_	_
postUS	_	_
images	_	_
.	_	_

#66
A	_	_
matcher	_	_
searches	_	_
for	_	_
a	_	_
corresponding	_	_
postUS	_	_
key-point	_	_
for	_	_
each	_	_
key-point	_	_
on	_	_
the	_	_
preUS	_	_
image	_	_
[	_	_
17	_	_
]	_	_
.	_	_

#67
From	_	_
a	_	_
matched	_	_
key-point	_	_
pair	_	_
,	_	_
let	_	_
xi	_	_
be	_	_
the	_	_
coordinates	_	_
of	_	_
the	_	_
predUS	_	_
key-point	_	_
and	_	_
xpost	_	_
i	_	_
be	_	_
the	_	_
coordinate	_	_
of	_	_
its	_	_
postUS	_	_
counterpart	_	_
.	_	_

#68
Here	_	_
,	_	_
we	_	_
first	_	_
use	_	_
all	_	_
matched	_	_
PreUS	_	_
key-points	_	_
as	_	_
landmarks	_	_
,	_	_
and	_	_
perform	_	_
a	_	_
land-mark	_	_
based	_	_
preUS-to-postUS	_	_
affine	_	_
registration	_	_
to	_	_
obtain	_	_
a	_	_
rough	_	_
alignment	_	_
.	_	_

#69
xpost	_	_
i	_	_
becomes	_	_
xaffinei	_	_
after	_	_
the	_	_
affine	_	_
registration	_	_
.	_	_

#70
The	_	_
displacement	_	_
vector	_	_
,	_	_
which	_	_
indicates	_	_
the	_	_
movement	_	_
of	_	_
landmark	_	_
xi	_	_
due	_	_
to	_	_
the	_	_
brain	_	_
shift	_	_
process	_	_
,	_	_
can	_	_
be	_	_
calculated	_	_
as	_	_
d	_	_
(	_	_
xi	_	_
)	_	_
=	_	_
xaffinei	_	_
i	_	_
−	_	_
xi	_	_
.	_	_

#71
where	_	_
d	_	_
=	_	_
[	_	_
dx	_	_
,	_	_
dy	_	_
,	_	_
dz	_	_
]	_	_
.	_	_

#72
Dense	_	_
deformation	_	_
field	_	_
The	_	_
goal	_	_
of	_	_
this	_	_
step	_	_
is	_	_
to	_	_
obtain	_	_
a	_	_
dense	_	_
deformation	_	_
field	_	_
from	_	_
a	_	_
set	_	_
of	_	_
N	_	_
sparse	_	_
landmark	_	_
and	_	_
their	_	_
displacements	_	_
D	_	_
=	_	_
{	_	_
(	_	_
xi	_	_
,	_	_
di	_	_
)	_	_
,	_	_
i	_	_
=	_	_
1	_	_
:	_	_
N	_	_
}	_	_
,	_	_
where	_	_
di	_	_
=	_	_
d	_	_
(	_	_
xi	_	_
)	_	_
is	_	_
modeled	_	_
as	_	_
a	_	_
observation	_	_
of	_	_
displacements	_	_
.	_	_

#73
In	_	_
the	_	_
GP	_	_
model	_	_
,	_	_
let	_	_
d	_	_
(	_	_
x	_	_
)	_	_
be	_	_
the	_	_
displacement	_	_
vector	_	_
for	_	_
the	_	_
voxel	_	_
at	_	_
location	_	_
x.	_	_
thus	_	_
it	_	_
has	_	_
a	_	_
prior	_	_
distribution	_	_
as	_	_
d	_	_
(	_	_
x	_	_
)	_	_
∼	_	_
GP	_	_
(	_	_
m	_	_
(	_	_
x	_	_
)	_	_
,	_	_
k	_	_
(	_	_
x	_	_
,	_	_
x′	_	_
)	_	_
)	_	_
,	_	_
where	_	_
m	_	_
(	_	_
x	_	_
)	_	_
is	_	_
the	_	_
mean	_	_
function	_	_
,	_	_
which	_	_
usually	_	_
is	_	_
set	_	_
to	_	_
0	_	_
,	_	_
and	_	_
the	_	_
GP	_	_
kernel	_	_
k	_	_
(	_	_
x	_	_
,	_	_
x′	_	_
)	_	_
represent	_	_
the	_	_
spatial	_	_
correlation	_	_
of	_	_
displacement	_	_
vectors	_	_
.	_	_

#74
By	_	_
the	_	_
model	_	_
assumption	_	_
,	_	_
all	_	_
displacement	_	_
vectors	_	_
follow	_	_
a	_	_
joint	_	_
Gaussian	_	_
distribution	_	_
p	_	_
(	_	_
d	_	_
|	_	_
X	_	_
)	_	_
=	_	_
N	_	_
(	_	_
d	_	_
|	_	_
µ	_	_
,	_	_
K	_	_
)	_	_
,	_	_
where	_	_
Kij	_	_
=	_	_
k	_	_
(	_	_
x	_	_
,	_	_
x′	_	_
)	_	_
and	_	_
µ	_	_
=	_	_
(	_	_
m	_	_
(	_	_
x1	_	_
)	_	_
,	_	_
...	_	_
,	_	_
m	_	_
(	_	_
xN	_	_
)	_	_
)	_	_
.	_	_

#75
As	_	_
a	_	_
result	_	_
,	_	_
the	_	_
displacement	_	_
vectors	_	_
d	_	_
for	_	_
known	_	_
landA	_	_
Feature-Driven	_	_
Active	_	_
Framework	_	_
for	_	_
US-based	_	_
Brain	_	_
Shift	_	_
Compensation	_	_
5	_	_
marks	_	_
and	_	_
N∗	_	_
unknown	_	_
displacement	_	_
vectors	_	_
d∗	_	_
at	_	_
location	_	_
X∗	_	_
,	_	_
which	_	_
we	_	_
want	_	_
to	_	_
predict	_	_
,	_	_
have	_	_
the	_	_
following	_	_
relationship	_	_
:	_	_
(	_	_
d	_	_
d∗	_	_
)	_	_
∼	_	_
	_	_
(	_	_
µ	_	_
µ∗	_	_
)	_	_
,	_	_
(	_	_
K	_	_
K∗	_	_
KT	_	_
∗	_	_
K∗∗	_	_
.	_	_

#76
)	_	_
	_	_
.	_	_

#77
(	_	_
1	_	_
)	_	_
In	_	_
Equation	_	_
(	_	_
1	_	_
)	_	_
,	_	_
K	_	_
=	_	_
k	_	_
(	_	_
X	_	_
,	_	_
X	_	_
)	_	_
is	_	_
the	_	_
N	_	_
×	_	_
N	_	_
matrix	_	_
,	_	_
K∗	_	_
=	_	_
k	_	_
(	_	_
X	_	_
,	_	_
X∗	_	_
)	_	_
is	_	_
the	_	_
N	_	_
×	_	_
N∗	_	_
matrix	_	_
,	_	_
and	_	_
K∗∗	_	_
=	_	_
k	_	_
(	_	_
X∗	_	_
,	_	_
X∗	_	_
)	_	_
is	_	_
the	_	_
N∗	_	_
×	_	_
N∗	_	_
matrix	_	_
.	_	_

#78
The	_	_
mean	_	_
µ∗	_	_
=	_	_
[	_	_
µ∗x	_	_
,	_	_
µ∗y	_	_
,	_	_
µ∗z	_	_
]	_	_
represents	_	_
values	_	_
of	_	_
voxel-wise	_	_
displacement	_	_
vectors	_	_
and	_	_
can	_	_
be	_	_
estimated	_	_
from	_	_
the	_	_
posterior	_	_
Gaussian	_	_
distribution	_	_
p	_	_
(	_	_
d∗	_	_
|	_	_
X∗	_	_
,	_	_
X	_	_
,	_	_
d	_	_
)	_	_
=	_	_
N	_	_
(	_	_
d∗	_	_
|	_	_
µ∗	_	_
,	_	_
Σ∗	_	_
)	_	_
as	_	_
µ∗	_	_
=	_	_
µ	_	_
(	_	_
X∗	_	_
)	_	_
+	_	_
KT	_	_
∗K−1	_	_
(	_	_
d−	_	_
µ	_	_
(	_	_
X	_	_
)	_	_
)	_	_
.	_	_

#79
(	_	_
2	_	_
)	_	_
Given	_	_
µ	_	_
(	_	_
X	_	_
)	_	_
=	_	_
µ	_	_
(	_	_
X∗	_	_
)	_	_
=	_	_
0	_	_
,	_	_
we	_	_
can	_	_
obtain	_	_
the	_	_
dense	_	_
deformation	_	_
field	_	_
for	_	_
the	_	_
preUS	_	_
image	_	_
by	_	_
assigning	_	_
µ∗x	_	_
,	_	_
µ∗y	_	_
,	_	_
µ∗z	_	_
to	_	_
dx	_	_
,	_	_
dy	_	_
and	_	_
dz	_	_
,	_	_
respectively	_	_
.	_	_

#80
Active	_	_
registration	_	_
Automatic	_	_
approaches	_	_
may	_	_
have	_	_
difficulty	_	_
in	_	_
the	_	_
preop-to-intraop	_	_
image	_	_
registration	_	_
,	_	_
especially	_	_
for	_	_
areas	_	_
near	_	_
the	_	_
tumor	_	_
resection	_	_
site	_	_
.	_	_

#81
Another	_	_
advantage	_	_
of	_	_
the	_	_
GP	_	_
framework	_	_
is	_	_
the	_	_
possibility	_	_
of	_	_
incorporate	_	_
user	_	_
expertise	_	_
to	_	_
further	_	_
improve	_	_
the	_	_
registration	_	_
result	_	_
.	_	_

#82
From	_	_
Equation	_	_
(	_	_
1	_	_
)	_	_
,	_	_
we	_	_
can	_	_
also	_	_
compute	_	_
the	_	_
covariance	_	_
matrix	_	_
of	_	_
the	_	_
posterior	_	_
Gaussian	_	_
p	_	_
(	_	_
d∗	_	_
|	_	_
X∗	_	_
,	_	_
X	_	_
,	_	_
d	_	_
)	_	_
as	_	_
Σ∗	_	_
=	_	_
K∗∗	_	_
−KT	_	_
∗K−1K∗.	_	_
(	_	_
3	_	_
)	_	_

#83
Entries	_	_
on	_	_
the	_	_
diagonal	_	_
of	_	_
Σ∗	_	_
are	_	_
the	_	_
marginal	_	_
variances	_	_
of	_	_
predicted	_	_
values	_	_
.	_	_

#84
They	_	_
can	_	_
be	_	_
used	_	_
as	_	_
an	_	_
uncertainty	_	_
measure	_	_
to	_	_
indicates	_	_
the	_	_
confidence	_	_
in	_	_
the	_	_
estimated	_	_
transformation	_	_
parameters	_	_
.	_	_

#85
If	_	_
users	_	_
are	_	_
not	_	_
satisfied	_	_
by	_	_
the	_	_
FBR	_	_
alignment	_	_
result	_	_
,	_	_
they	_	_
could	capability-feasibility	_
manually	_	_
,	_	_
guided	_	_
by	_	_
the	_	_
image	_	_
context	_	_
and	_	_
visualization	_	_
of	_	_
registration	_	_
uncertainty	_	_
,	_	_
add	_	_
new	_	_
corresponding	_	_
pairs	_	_
of	_	_
key-points	_	_
to	_	_
drive	_	_
the	_	_
GP	_	_
towards	_	_
better	_	_
results	_	_
.	_	_

#86
2.3	_	_
GP	_	_
kernel	_	_
estimation	_	_

#87
The	_	_
performance	_	_
of	_	_
GP	_	_
registration	_	_
depends	_	_
exclusively	_	_
on	_	_
the	_	_
suitability	_	_
of	_	_
the	_	_
chosen	_	_
kernels	_	_
and	_	_
its	_	_
parameters	_	_
.	_	_

#88
In	_	_
this	_	_
study	_	_
,	_	_
we	_	_
explore	_	_
two	_	_
schemes	_	_
for	_	_
the	_	_
kernel	_	_
estimation	_	_
:	_	_
Variograms	_	_
and	_	_
discrete	_	_
grid	_	_
search	_	_
.	_	_

#89
Variograms	_	_
While	_	_
being	_	_
used	_	_
extensively	_	_
in	_	_
geostatistics	_	_
to	_	_
characterize	_	_
the	_	_
spatial	_	_
dependence	_	_
of	_	_
a	_	_
stochastic	_	_
process	_	_
[	_	_
19	_	_
]	_	_
,	_	_
variograms	_	_
have	_	_
not	_	_
yet	_	_
received	_	_
much	_	_
attention	_	_
in	_	_
the	_	_
medical	_	_
imaging	_	_
field	_	_
.	_	_

#90
Although	_	_
GP	_	_
regression	_	_
for	_	_
medical	_	_
image	_	_
registration	_	_
,	_	_
and	_	_
variograms	_	_
,	_	_
were	_	_
described	_	_
in	_	_
[	_	_
20	_	_
]	_	_
,	_	_
neither	_	_
quantitative	_	_
results	_	_
,	_	_
nor	_	_
estimation	_	_
of	_	_
the	_	_
posterior	_	_
uncertainty	_	_
were	_	_
provided	_	_
.	_	_

#91
In	_	_
the	_	_
GP	_	_
registration	_	_
context	_	_
,	_	_
d	_	_
(	_	_
x	_	_
)	_	_
is	_	_
modelled	_	_
as	_	_
a	_	_
random	_	_
quantity	_	_
,	_	_
variograms	_	_
can	_	_
measure	_	_
the	_	_
extent	_	_
of	_	_
pairwise	_	_
spatial	_	_
correlation	_	_
between	_	_
displacement	_	_
vectors	_	_
with	_	_
respect	_	_
to	_	_
their	_	_
distance	_	_
,	_	_
and	_	_
in	_	_
advance	_	_
give	_	_
insight	_	_
into	_	_
choosing	_	_
the	_	_
suitable	_	_
GP	_	_
kernel	_	_
.	_	_

#92
6	_	_
J.Luo	_	_
et	_	_
al.	_	_
Fig.	_	_
3	_	_
.	_	_

#93
(	_	_
a	_	_
)	_	_
∥∥dx	_	_
(	_	_
x2	_	_
)	_	_
−	_	_
dx	_	_
(	_	_
x1	_	_
)	_	_
∥∥	_	_
and	_	_
h	_	_
;	_	_
(	_	_
b	_	_
)	_	_
Empirical	_	_
variogram	_	_
cloud	_	_
;	_	_
(	_	_
c	_	_
)	_	_
Variogram	_	_
cloud	_	_
divided	_	_
into	_	_
bins	_	_
with	_	_
their	_	_
means	_	_
marked	_	_
as	_	_
blue	_	_
.	_	_

#94
In	_	_
practice	_	_
,	_	_
we	_	_
estimate	_	_
the	_	_
empirical	_	_
variogram	_	_
of	_	_
landmarks’	_	_
displacement	_	_
vectors	_	_
as	_	_
γ̂	_	_
(	_	_
h±	_	_
δ	_	_
)	_	_
:	_	_
=	_	_
2|N	_	_
(	_	_
h±	_	_
δ	_	_
)	_	_
|	_	_
∑	_	_
(	_	_
i	_	_
,	_	_
j	_	_
)	_	_
∈N	_	_
(	_	_
h±δ	_	_
)	_	_
∥∥d	_	_
(	_	_
xi	_	_
)	_	_
−	_	_
d	_	_
(	_	_
xj	_	_
)	_	_
∥∥2	_	_
.	_	_

#95
(	_	_
4	_	_
)	_	_
For	_	_
the	_	_
norm	_	_
term	_	_
∥∥d	_	_
(	_	_
xi	_	_
)	_	_
−	_	_
d	_	_
(	_	_
xj	_	_
)	_	_
∥∥	_	_
,	_	_
we	_	_
compute	_	_
its	_	_
3	_	_
components	_	_
dx	_	_
dy	_	_
dz	_	_
and	_	_
construct	_	_
3	_	_
variograms	_	_
,	_	_
respectively	_	_
.	_	_

#96
As	_	_
shown	_	_
in	_	_
Fig.3	_	_
(	_	_
a	_	_
)	_	_
,	_	_
for	_	_
displacement	_	_
vectors	_	_
d	_	_
(	_	_
x1	_	_
)	_	_
and	_	_
d	_	_
(	_	_
x2	_	_
)	_	_
,	_	_
∥∥dx	_	_
(	_	_
x2	_	_
)	_	_
−	_	_
dx	_	_
(	_	_
x1	_	_
)	_	_
∥∥	_	_
is	_	_
the	_	_
vector	_	_
difference	_	_
with	_	_
respect	_	_
to	_	_
the	_	_
x	_	_
axis	_	_
,	_	_
etc	_	_
.	_	_

#97
h	_	_
represents	_	_
the	_	_
distance	_	_
between	_	_
two	_	_
displacement	_	_
vectors	_	_
.	_	_

#98
To	_	_
construct	_	_
an	_	_
empirical	_	_
variogram	_	_
,	_	_
the	_	_
first	_	_
step	_	_
is	_	_
to	_	_
make	_	_
a	_	_
variogram	_	_
cloud	_	_
by	_	_
plotting	_	_
∥∥d	_	_
(	_	_
x2	_	_
)	_	_
−	_	_
d	_	_
(	_	_
x1	_	_
)	_	_
∥∥2	_	_
and	_	_
hij	_	_
for	_	_
all	_	_
displacement	_	_
pairs	_	_
.	_	_

#99
Next	_	_
,	_	_
we	_	_
introduce	_	_
a	_	_
variable	_	_
δ	_	_
,	_	_
and	_	_
divide	_	_
the	_	_
variogram	_	_
cloud	_	_
into	_	_
bins	_	_
with	_	_
a	_	_
bin	_	_
width	_	_
setting	_	_
to	_	_
2δ	_	_
.	_	_

#100
Lastly	_	_
,	_	_
the	_	_
mean	_	_
of	_	_
each	_	_
bin	_	_
is	_	_
calculated	_	_
and	_	_
further	_	_
plotted	_	_
with	_	_
the	_	_
mean	_	_
distance	_	_
of	_	_
that	_	_
bin	_	_
to	_	_
form	_	_
an	_	_
empirical	_	_
variogram	_	_
.	_	_

#101
Fig.4	_	_
(	_	_
a	_	_
)	_	_
shows	_	_
an	_	_
empirical	_	_
variogram	_	_
of	_	_
a	_	_
real	_	_
US	_	_
image	_	_
pair	_	_
that	_	_
has	_	_
71	_	_
landmarks	_	_
.	_	_

#102
The	_	_
empirical	_	_
variogram	_	_
only	_	_
consists	_	_
of	_	_
value	_	_
differences	_	_
at	_	_
a	_	_
finite	_	_
set	_	_
of	_	_
discrete	_	_
distances	_	_
,	_	_
whereas	_	_
the	_	_
GP	_	_
kernels	_	_
are	_	_
continuous	_	_
for	_	_
all	_	_
h.	_	_
Therefore	_	_
,	_	_
the	_	_
next	_	_
step	_	_
is	_	_
to	_	_
fit	_	_
a	_	_
smooth	_	_
curve	_	_
to	_	_
the	_	_
empirical	_	_
values	_	_
and	_	_
derive	_	_
the	_	_
kernel	_	_
function	_	_
from	_	_
that	_	_
fitted	_	_
curve	_	_
.	_	_

#103
Fig.	_	_
4	_	_
.	_	_

#104
(	_	_
a	_	_
)	_	_
X-axis	_	_
empirical	_	_
variogram	_	_
of	_	_
a	_	_
US	_	_
images	_	_
pair	_	_
;	_	_
(	_	_
b	_	_
)	_	_
Sill	_	_
,	_	_
range	_	_
and	_	_
nugget	_	_
;	_	_
(	_	_
c	_	_
)	_	_
Fitting	_	_
a	_	_
continuous	_	_
model	_	_
to	_	_
an	_	_
empirical	_	_
variogram	_	_
.	_	_

#105
Fig.4	_	_
(	_	_
b	_	_
)	_	_
is	_	_
an	_	_
example	_	_
of	_	_
a	_	_
fitted	_	_
curve	_	_
.	_	_

#106
The	_	_
curve	_	_
is	_	_
commonly	_	_
describe	_	_
by	_	_
the	_	_
following	_	_
characteristics	_	_
:	_	_
Nugget	_	_
The	_	_
non-zero	_	_
value	_	_
at	_	_
h	_	_
=	_	_
0	_	_
.	_	_

#107
Sill	_	_
The	_	_
value	_	_
at	_	_
which	_	_
the	_	_
curve	_	_
reaches	_	_
its	_	_
maximum	_	_
.	_	_

#108
Range	_	_
The	_	_
value	_	_
of	_	_
distance	_	_
h	_	_
where	_	_
the	_	_
sill	_	_
is	_	_
reached	_	_
.	_	_

#109
Conventionally	_	_
,	_	_
displacement	_	_
vectors	_	_
that	_	_
are	_	_
separated	_	_
by	_	_
distances	_	_
further	_	_
than	_	_
the	_	_
range	_	_
are	_	_
considered	_	_
uncorrelated	_	_
[	_	_
19	_	_
]	_	_
.	_	_

#110
In	_	_
general	_	_
,	_	_
the	_	_
curve	_	_
must	deontic	_
have	_	_
a	_	_
mathematical	_	_
expression	_	_
that	_	_
can	_	_
describe	_	_
the	_	_
variances	_	_
of	_	_
a	_	_
random	_	_
process	_	_
.	_	_

#111
Practically	_	_
,	_	_
the	_	_
choice	_	_
is	_	_
limited	_	_
to	_	_
a	_	_
few	_	_
options	_	_
,	_	_
such	_	_
as	_	_
exponential	_	_
and	_	_
Gaussian	_	_
models	_	_
.	_	_

#112
For	_	_
instance	_	_
,	_	_
the	_	_
Gaussian	_	_
variogram	_	_
function	_	_
is	_	_
γ	_	_
(	_	_
h	_	_
)	_	_
=	_	_
c0	_	_
+	_	_
c	_	_
{	_	_
1−	_	_
exp	_	_
(	_	_
−h	_	_
a	_	_
)	_	_
}	_	_
.	_	_
(	_	_
5	_	_
)	_	_

#113
In	_	_
equation	_	_
(	_	_
5	_	_
)	_	_
,	_	_
c0	_	_
is	_	_
the	_	_
nugget	_	_
,	_	_
c	_	_
=	_	_
Sill−	_	_
c0	_	_
,	_	_
and	_	_
a	_	_
is	_	_
the	_	_
model	_	_
parameter	_	_
.	_	_

#114
This	_	_
function	_	_
asymptotically	_	_
approaches	_	_
its	_	_
sill	_	_
,	_	_
and	_	_
has	_	_
an	_	_
effective	_	_
range	_	_
as	_	_
r′	_	_
=	_	_
√	_	_
3a	_	_
.	_	_

#115
Fitting	_	_
a	_	_
model	_	_
to	_	_
an	_	_
empirical	_	_
variogram	_	_
is	_	_
implemented	_	_
in	_	_
most	_	_
geostatistis	_	_
software	_	_
.	_	_

#116
A	_	_
popular	_	_
choice	_	_
is	_	_
choosing	_	_
several	_	_
models	_	_
that	_	_
appear	_	_
to	_	_
have	_	_
the	_	_
right	_	_
shape	_	_
and	_	_
use	_	_
the	_	_
one	_	_
with	_	_
smallest	_	_
weighted	_	_
squared	_	_
error	_	_
[	_	_
19	_	_
]	_	_
.	_	_

#117
Discrete	_	_
grid	_	_
search	_	_
The	_	_
variogram	_	_
scheme	_	_
often	_	_
requires	_	_
many	_	_
landmarks	_	_
to	_	_
work	_	_
well	_	_
[	_	_
19	_	_
]	_	_
.	_	_

#118
For	_	_
US	_	_
pairs	_	_
that	_	_
have	_	_
fewer	_	_
landmarks	_	_
,	_	_
we	_	_
predefine	_	_
some	_	_
kernel	_	_
functions	_	_
,	_	_
and	_	_
use	_	_
cross	_	_
validation	_	_
in	_	_
a	_	_
discrete	_	_
search	_	_
for	_	_
the	_	_
model	_	_
parameters	_	_
.	_	_

#119
3	_	_
Experiments	_	_

#120
The	_	_
experimental	_	_
dataset	_	_
consists	_	_
of	_	_
6	_	_
preUS	_	_
and	_	_
postUS	_	_
image	_	_
pairs	_	_
that	_	_
were	_	_
acquired	_	_
on	_	_
a	_	_
BK	_	_
Ultrasound	_	_
3000	_	_
system	_	_
(	_	_
BK	_	_
Medical	_	_
,	_	_
Analogic	_	_
Corporations	_	_
,	_	_
Peabody	_	_
,	_	_
USA	_	_
)	_	_
that	_	_
is	_	_
directly	_	_
connected	_	_
to	_	_
the	_	_
Brainlab	_	_
VectorVision	_	_
Sky	_	_
neuronavigaton	_	_
system	_	_
(	_	_
Brainlab	_	_
,	_	_
Munich	_	_
,	_	_
Germany	_	_
)	_	_
during	_	_
surgery	_	_
.	_	_

#121
We	_	_
use	_	_
the	_	_
mean	_	_
euclidean	_	_
distance	_	_
between	_	_
the	_	_
predicted	_	_
and	_	_
ground	_	_
truth	_	_
of	_	_
landmarks’	_	_
coordinates	_	_
,	_	_
measured	_	_
in	_	_
mm	_	_
,	_	_
for	_	_
the	_	_
registration	_	_
evaluation	_	_
.	_	_

#122
Compared	_	_
methods	_	_
include	_	_
:	_	_
affine	_	_
,	_	_
thin-plate	_	_
kernel	_	_
FBR	_	_
,	_	_
variograms	_	_
FBR	_	_
and	_	_
gaussian	_	_
kernel	_	_
FBR	_	_
.	_	_

#123
For	_	_
US	_	_
pairs	_	_
that	_	_
have	_	_
less	_	_
than	_	_
50	_	_
landmarks	_	_
,	_	_
we	_	_
use	_	_
leave-one-out	_	_
cross	_	_
validation	_	_
,	_	_
otherwise	_	_
5-fold	_	_
cross	_	_
validation	_	_
.	_	_

#124
All	_	_
of	_	_
compared	_	_
methods	_	_
can	_	_
be	_	_
finished	_	_
within	_	_
10	_	_
minutes	_	_
.	_	_

#125
Table	_	_
1	_	_
.	_	_

#126
Registration	_	_
evaluation	_	_
results	_	_
(	_	_
in	_	_
mm	_	_
)	_	_
Landmarks	_	_
Before	_	_
Reg	_	_
.	_	_

#127
Affine	_	_
Thin-plate	_	_
Variograms	_	_
GaussianK	_	_
Patient	_	_
1	_	_
123	_	_
5.56±1.05	_	_
2.99±1.21	_	_
1.79±0.70	_	_
2.11±0.74	_	_
1.75±0.68	_	_
Patient	_	_
2	_	_
71	_	_
3.35±1.22	_	_
2.08±1.13	_	_
2.06±1.18	_	_
2.06±1.12	_	_
1.97±1.05	_	_
Patient	_	_
3	_	_
49	_	_
2.48±1.56	_	_
1.93±1.75	_	_
1.25±1.95	_	_
n/a	_	_
1.23±1.77	_	_
Patient	_	_
4	_	_
12	_	_
4.40±1.79	_	_
3.06±2.35	_	_
1.45±1.99	_	_
n/a	_	_
1.42±2.04	_	_
Patient	_	_
5	_	_
64	_	_
2.91±1.33	_	_
1.86±1.24	_	_
1.29±1.17	_	_
n/a	_	_
1.33±1.40	_	_
Patient	_	_
6	_	_
98	_	_
3.29±1.09	_	_
2.12±1.16	_	_
2.02±1.21	_	_
2.05±1.40	_	_
1.96±1.38	_	_
In	_	_
addition	_	_
,	_	_
we	_	_
demonstrate	_	_
the	_	_
preliminary	_	_
result	_	_
of	_	_
active	_	_
registration	_	_
.	_	_

#128
As	_	_
shown	_	_
in	_	_
Fig.5	_	_
,	_	_
(	_	_
a	_	_
)	_	_
is	_	_
the	_	_
registered	_	_
source	_	_
preUS	_	_
image	_	_
,	_	_
(	_	_
b	_	_
)	_	_
is	_	_
the	_	_
target	_	_
postUS	_	_
image	_	_
.	_	_

#129
Noticing	_	_
that	_	_
the	_	_
FBR	_	_
does	_	_
not	_	_
well	_	_
align	_	_
the	_	_
tumor	_	_
boundary	_	_
due	_	_
to	_	_
lacking	_	_
of	_	_
landmarks	_	_
.	_	_

#130
In	_	_
the	_	_
active	_	_
registration	_	_
step	_	_
,	_	_
a	_	_
user	_	_
manually	_	_
added	_	_
3	_	_
new	_	_
key-point	_	_
pairs	_	_
based	_	_
on	_	_
the	_	_
image	_	_
context	_	_
and	_	_
a	_	_
color	_	_
mapping	_	_
of	_	_
registration	_	_
uncertainty	_	_
.	_	_

#131
By	_	_
visual	_	_
inspection	_	_
,	_	_
we	_	_
can	_	_
see	_	_
the	_	_
alignment	_	_
of	_	_
tumor	_	_
boundary	_	_
substantially	_	_
improved	_	_
.	_	_

#132
8	_	_
J.Luo	_	_
et	_	_
al.	_	_
Fig.	_	_
5	_	_
.	_	_

#133
(	_	_
a	_	_
)	_	_
FR	_	_
result	_	_
of	_	_
the	_	_
preUS	_	_
image	_	_
;	_	_
(	_	_
b	_	_
)	_	_
PostUS	_	_
image	_	_
;	_	_
(	_	_
c	_	_
)	_	_
Overlaying	_	_
the	_	_
visualization	_	_
of	_	_
uncertainty	_	_
on	_	_
the	_	_
preUS	_	_
image	_	_
;	_	_
(	_	_
d	_	_
)	_	_
Improved	_	_
registration	_	_
result	_	_
.	_	_

#134
4	_	_
Conclusion	_	_

#135
We	_	_
proposed	_	_
a	_	_
novel	_	_
feature-based	_	_
active	_	_
registration	_	_
framework	_	_
to	_	_
compensate	_	_
for	_	_
the	_	_
brain	_	_
shift	_	_
.	_	_

#136
We	_	_
believe	_	_
this	_	_
framework	_	_
has	_	_
the	_	_
potential	_	_
to	_	_
be	_	_
eventually	_	_
applied	_	_
in	_	_
the	_	_
operating	_	_
room	_	_
.	_	_

#137
Future	_	_
work	_	_
includes	_	_
exploring	_	_
non-isotropic	_	_
variograms	_	_
and	_	_
other	_	_
advanced	_	_
schemes	_	_
for	_	_
GP	_	_
kernel	_	_
estimation	_	_
.	_	_

#138
Implementing	_	_
our	_	_
framework	_	_
into	_	_
clinical	_	_
software	_	_
,	_	_
such	_	_
as	_	_
3D	_	_
slicer	_	_
,	_	_
is	_	_
also	_	_
of	_	_
interest	_	_
.	_	_