#0
MX-LSTM	_	_
:	_	_
mixing	_	_
tracklets	_	_
and	_	_
vislets	_	_
to	_	_
jointly	_	_
forecast	_	_
trajectories	_	_
and	_	_
head	_	_
poses	_	_
Irtiza	_	_
Hasan1,2	_	_
,	_	_
Francesco	_	_
Setti1	_	_
,	_	_
Theodore	_	_
Tsesmelis1,2,3	_	_
,	_	_
Alessio	_	_
Del	_	_
Bue3	_	_
,	_	_
Fabio	_	_
Galasso2	_	_
,	_	_
and	_	_
Marco	_	_
Cristani1	_	_

#1
1	_	_
University	_	_
of	_	_
Verona	_	_
(	_	_
UNIVR	_	_
)	_	_
2	_	_
OSRAM	_	_
GmbH	_	_
3	_	_
Istituto	_	_
Italiano	_	_
di	_	_
Tecnologia	_	_
(	_	_
IIT	_	_
)	_	_

#2
{	_	_
irtiza.hasan	_	_
,	_	_
francesco.setti	_	_
,	_	_
marco.cristani	_	_
}	_	_
@	_	_
univr.it	_	_
,	_	_
{	_	_
t.tsesmelis	_	_
,	_	_
f.galasso	_	_
}	_	_
@	_	_
osram.com	_	_
,	_	_
alessio.delbue	_	_
@	_	_
iit.it	_	_

#3
Abstract	_	_

#4
Recent	_	_
approaches	_	_
on	_	_
trajectory	_	_
forecasting	_	_
use	_	_
tracklets	_	_
to	_	_
predict	_	_
the	_	_
future	_	_
positions	_	_
of	_	_
pedestrians	_	_
exploiting	_	_
Long	_	_
Short	_	_
Term	_	_
Memory	_	_
(	_	_
LSTM	_	_
)	_	_
architectures	_	_
.	_	_

#5
This	_	_
paper	_	_
shows	_	_
that	_	_
adding	_	_
vislets	_	_
,	_	_
that	_	_
is	_	_
,	_	_
short	_	_
sequences	_	_
of	_	_
head	_	_
pose	_	_
estimations	_	_
,	_	_
allows	_	_
to	_	_
increase	_	_
significantly	_	_
the	_	_
trajectory	_	_
forecasting	_	_
performance	_	_
.	_	_

#6
We	_	_
then	_	_
propose	_	_
to	_	_
use	_	_
vislets	_	_
in	_	_
a	_	_
novel	_	_
framework	_	_
called	_	_
MX-LSTM	_	_
,	_	_
capturing	_	_
the	_	_
interplay	_	_
between	_	_
tracklets	_	_
and	_	_
vislets	_	_
thanks	_	_
to	_	_
a	_	_
joint	_	_
unconstrained	_	_
optimization	_	_
of	_	_
full	_	_
covariance	_	_
matrices	_	_
during	_	_
the	_	_
LSTM	_	_
backpropagation	_	_
.	_	_

#7
At	_	_
the	_	_
same	_	_
time	_	_
,	_	_
MX-LSTM	_	_
predicts	_	_
the	_	_
future	_	_
head	_	_
poses	_	_
,	_	_
increasing	_	_
the	_	_
standard	_	_
capabilities	_	_
of	_	_
the	_	_
long-term	_	_
trajectory	_	_
forecasting	_	_
approaches	_	_
.	_	_

#8
With	_	_
standard	_	_
head	_	_
pose	_	_
estimators	_	_
and	_	_
an	_	_
attentional-based	_	_
social	_	_
pooling	_	_
,	_	_
MX-LSTM	_	_
scores	_	_
the	_	_
new	_	_
trajectory	_	_
forecasting	_	_
state-of-the-art	_	_
in	_	_
all	_	_
the	_	_
considered	_	_
datasets	_	_
(	_	_
Zara01	_	_
,	_	_
Zara02	_	_
,	_	_
UCY	_	_
,	_	_
and	_	_
TownCentre	_	_
)	_	_
with	_	_
a	_	_
dramatic	_	_
margin	_	_
when	_	_
the	_	_
pedestrians	_	_
slow	_	_
down	_	_
,	_	_
a	_	_
case	_	_
where	_	_
most	_	_
of	_	_
the	_	_
forecasting	_	_
approaches	_	_
struggle	_	_
to	_	_
provide	_	_
an	_	_
accurate	_	_
solution	_	_
.	_	_

#9
1	_	_
.	_	_

#10
Introduction	_	_
Anticipating	_	_
the	_	_
trajectories	_	_
that	_	_
could	_	_
occur	_	_
in	_	_
the	_	_
future	_	_
is	_	_
important	_	_
for	_	_
several	_	_
reasons	_	_
:	_	_
in	_	_
computer	_	_
vision	_	_
,	_	_
path	_	_
forecasting	_	_
helps	_	_
the	_	_
dynamics	_	_
modeling	_	_
for	_	_
target	_	_
tracking	_	_
[	_	_
40	_	_
,	_	_
47	_	_
,	_	_
48	_	_
,	_	_
59	_	_
]	_	_
and	_	_
behavior	_	_
understanding	_	_
[	_	_
3	_	_
,	_	_
30	_	_
,	_	_
33	_	_
,	_	_
35	_	_
,	_	_
47	_	_
]	_	_
;	_	_
in	_	_
robotics	_	_
,	_	_
autonomous	_	_
systems	_	_
should	_	_
plan	_	_
routes	_	_
that	_	_
will	_	_
avoid	_	_
collisions	_	_
and	_	_
be	_	_
respectful	_	_
of	_	_
the	_	_
human	_	_
proxemics	_	_
[	_	_
13	_	_
,	_	_
21	_	_
,	_	_
31	_	_
,	_	_
36	_	_
,	_	_
53	_	_
,	_	_
62	_	_
]	_	_
.	_	_

#11
Recently	_	_
,	_	_
path	_	_
forecasting	_	_
has	_	_
benefited	_	_
from	_	_
the	_	_
introduction	_	_
of	_	_
Long	_	_
Short	_	_
Term	_	_
Memory	_	_
(	_	_
LSTM	_	_
)	_	_
architectures	_	_
[	_	_
3	_	_
,	_	_
22	_	_
,	_	_
26	_	_
,	_	_
50	_	_
,	_	_
51	_	_
,	_	_
55	_	_
]	_	_
.	_	_

#12
All	_	_
of	_	_
these	_	_
approaches	_	_
use	_	_
exclusively	_	_
the	_	_
(	_	_
x	_	_
,	_	_
y	_	_
)	_	_
position	_	_
coordinates	_	_
for	_	_
the	_	_
prediction	_	_
,	_	_
forgetting	_	_
that	_	_
humans	_	_
act	_	_
and	_	_
react	_	_
using	_	_
their	_	_
senses	_	_
to	_	_
explore	_	_
the	_	_
environment	_	_
,	_	_
in	_	_
particular	_	_
,	_	_
through	_	_
the	_	_
visual	_	_
information	_	_
conveyed	_	_
by	_	_
the	_	_
gaze	_	_
and	_	_
inferred	_	_
by	_	_
the	_	_
head	_	_
pose	_	_
[	_	_
8	_	_
,	_	_
9	_	_
,	_	_
11	_	_
,	_	_
14	_	_
,	_	_
15	_	_
,	_	_
16	_	_
,	_	_
27	_	_
,	_	_
39	_	_
,	_	_
46	_	_
,	_	_
49	_	_
,	_	_
54	_	_
]	_	_
.	_	_

#13
In	_	_
particular	_	_
,	_	_
[	_	_
8	_	_
,	_	_
11	_	_
,	_	_
14	_	_
,	_	_
15	_	_
,	_	_
16	_	_
,	_	_
27	_	_
,	_	_
39	_	_
,	_	_
54	_	_
]	_	_
found	_	_
that	_	_
the	_	_
head	_	_
pose	_	_
correlates	_	_
to	_	_
the	_	_
person	_	_
destination	_	_
and	_	_
pathway	_	_
:	_	_
these	_	_
findings	_	_
are	_	_
also	_	_
supported	_	_
by	_	_
a	_	_
statistical	_	_
analysis	_	_
presented	_	_
in	_	_
our	_	_
paper	_	_
(	_	_
Sec	_	_
.	_	_

#14
4	_	_
)	_	_
.	_	_

#15
For	_	_
the	_	_
first	_	_
time	_	_
this	_	_
work	_	_
considers	_	_
the	_	_
head	_	_
pose	_	_
,	_	_
jointly	_	_
with	_	_
the	_	_
positional	_	_
information	_	_
,	_	_
as	_	_
a	_	_
cue	_	_
to	_	_
perform	_	_
forecasting	_	_
.	_	_

#16
In	_	_
particular	_	_
,	_	_
tracklets	_	_
(	_	_
sequences	_	_
of	_	_
(	_	_
x	_	_
,	_	_
y	_	_
)	_	_
coordinates	_	_
)	_	_
and	_	_
vislets	_	_
,	_	_
that	_	_
is	_	_
,	_	_
reference	_	_
points	_	_
indicating	_	_
the	_	_
head	_	_
pan	_	_
orientation	_	_
,	_	_
are	_	_
the	_	_
input	_	_
of	_	_
the	_	_
novel	_	_
MiXing	_	_
LSTM	_	_
(	_	_
MX-LSTM	_	_
)	_	_
,	_	_
an	_	_
LSTM-based	_	_
model	_	_
that	_	_
learns	_	_
how	_	_
tracklet	_	_
and	_	_
vislet	_	_
streams	_	_
are	_	_
related	_	_
,	_	_
mixing	_	_
them	_	_
together	_	_
in	_	_
the	_	_
LSTM	_	_
hidden	_	_
state	_	_
recursion	_	_
by	_	_
means	_	_
of	_	_
cross-stream	_	_
full	_	_
covariance	_	_
matrices	_	_
,	_	_
optimized	_	_
during	_	_
backpropagation	_	_
.	_	_

#17
MX-LSTM	_	_
is	_	_
able	_	_
to	_	_
encode	_	_
how	_	_
movements	_	_
of	_	_
the	_	_
head	_	_
and	_	_
the	_	_
people	_	_
dynamics	_	_
are	_	_
connected	_	_
.	_	_

#18
For	_	_
example	_	_
,	_	_
it	_	_
captures	_	_
the	_	_
fact	_	_
that	_	_
rotating	_	_
the	_	_
head	_	_
towards	_	_
a	_	_
particular	_	_
direction	_	_
may	_	_
anticipate	_	_
a	_	_
trajectory	_	_
drifting	_	_
with	_	_
an	_	_
acceleration	_	_
(	_	_
as	_	_
in	_	_
the	_	_
case	_	_
of	_	_
a	_	_
person	_	_
leaving	_	_
a	_	_
group	_	_
after	_	_
a	_	_
conversation	_	_
)	_	_
.	_	_

#19
This	_	_
happens	_	_
thanks	_	_
to	_	_
a	_	_
novel	_	_
optimization	_	_
of	_	_
the	_	_
LSTM	_	_
parameters	_	_
using	_	_
a	_	_
Gaussian	_	_
full	_	_
covariance	_	_
through	_	_
an	_	_
unconstrained	_	_
log-Cholesky	_	_
parameterization	_	_
in	_	_
the	_	_
backpropagation	_	_
,	_	_
securing	_	_
positive	_	_
semidefinite	_	_
matrices	_	_
.	_	_

#20
To	_	_
the	_	_
best	_	_
of	_	_
our	_	_
knowledge	_	_
,	_	_
this	_	_
is	_	_
the	_	_
first	_	_
time	_	_
Gaussian	_	_
distributions	_	_
with	_	_
covariance	_	_
matrices	_	_
of	_	_
order	_	_
higher	_	_
than	_	_
two	_	_
are	_	_
optimized	_	_
in	_	_
LSTMs	_	_
.	_	_

#21
Vislet	_	_
information	_	_
is	_	_
also	_	_
used	_	_
to	_	_
build	_	_
a	_	_
scene	_	_
context	_	_
,	_	_
i.e.	_	_
where	_	_
are	_	_
the	_	_
other	_	_
people	_	_
and	_	_
how	_	_
they	_	_
are	_	_
moving	_	_
,	_	_
by	_	_
a	_	_
shared	_	_
state	_	_
pooling	_	_
as	_	_
in	_	_
[	_	_
3	_	_
,	_	_
55	_	_
]	_	_
,	_	_
that	_	_
here	_	_
is	_	_
further	_	_
improved	_	_
using	_	_
the	_	_
head	_	_
pose	_	_
by	_	_
discarding	_	_
the	_	_
people	_	_
that	_	_
an	_	_
individual	_	_
can	_	_
not	_	_
see	_	_
.	_	_

#22
As	_	_
a	_	_
by-product	_	_
,	_	_
MX-LSTM	_	_
predicts	_	_
head	_	_
orientations	_	_
too	_	_
,	_	_
allowing	_	_
to	_	_
reason	_	_
where	_	_
people	_	_
will	_	_
most	_	_
probably	_	_
look	_	_
at	_	_
,	_	_
providing	_	_
a	_	_
fine	_	_
grained	_	_
level	_	_
of	_	_
long-term	_	_
prediction	_	_
never	_	_
reached	_	_
so	_	_
far	_	_
in	_	_
crowded	_	_
scenarios	_	_
.	_	_

#23
ar	_	_
X	_	_
iv	_	_
:1	_	_
5	_	_
.	_	_

#24
2v	_	_
1	_	_
[	_	_
cs	_	_
.C	_	_
V	_	_
]	_	_
2	_	_
M	_	_
ay	_	_
2	_	_
Adopting	_	_
standard	_	_
protocols	_	_
for	_	_
trajectory	_	_
forecasting	_	_
[	_	_
3	_	_
,	_	_
34	_	_
,	_	_
40	_	_
]	_	_
and	_	_
using	_	_
head	_	_
poses	_	_
information	_	_
given	_	_
by	_	_
a	_	_
standard	_	_
head	_	_
pose	_	_
estimator	_	_
[	_	_
32	_	_
]	_	_
,	_	_
MX-LSTM	_	_
defines	_	_
the	_	_
new	_	_
state-of-the-art	_	_
both	_	_
in	_	_
the	_	_
UCY	_	_
sequences	_	_
(	_	_
Zara01	_	_
,	_	_
Zara02	_	_
and	_	_
UCY	_	_
)	_	_
and	_	_
in	_	_
the	_	_
TownCentre	_	_
dataset	_	_
.	_	_

#25
In	_	_
particular	_	_
,	_	_
MX-LSTM	_	_
has	_	_
the	_	_
ability	_	_
to	_	_
forecast	_	_
people	_	_
when	_	_
they	_	_
are	_	_
moving	_	_
slowly	_	_
,	_	_
the	_	_
Achille’s	_	_
heel	_	_
of	_	_
all	_	_
the	_	_
other	_	_
approaches	_	_
proposed	_	_
so	_	_
far	_	_
.	_	_

#26
As	_	_
main	_	_
contributions	_	_
,	_	_
in	_	_
this	_	_
paper	_	_
:	_	_
•	_	_
We	_	_
show	_	_
that	_	_
trajectory	_	_
forecasting	_	_
can	_	_
be	_	_
dramatically	_	_
ameliorated	_	_
by	_	_
considering	_	_
head	_	_
pose	_	_
estimates	_	_
;	_	_
•	_	_
We	_	_
propose	_	_
a	_	_
novel	_	_
LSTM	_	_
architecture	_	_
,	_	_
MX-LSTM	_	_
,	_	_
which	_	_
exploits	_	_
positional	_	_
(	_	_
tracklets	_	_
)	_	_
and	_	_
orientational	_	_
(	_	_
vislets	_	_
)	_	_
information	_	_
thanks	_	_
to	_	_
an	_	_
optimization	_	_
of	_	_
dvariate	_	_
Gaussian	_	_
parameters	_	_
including	_	_
full	_	_
covariances	_	_
with	_	_
d	_	_
>	_	_
2	_	_
;	_	_
•	_	_
We	_	_
motivate	_	_
the	_	_
need	_	_
for	_	_
MX-LSTM	_	_
showing	_	_
that	_	_
head	_	_
poses	_	_
are	_	_
related	_	_
with	_	_
the	_	_
trajectories	_	_
,	_	_
even	_	_
at	_	_
low	_	_
velocities	_	_
,	_	_
where	_	_
most	_	_
of	_	_
the	_	_
forecasting	_	_
approaches	_	_
fail	_	_
;	_	_
•	_	_
We	_	_
define	_	_
a	_	_
novel	_	_
type	_	_
of	_	_
social	_	_
pooling	_	_
,	_	_
in	_	_
the	_	_
sense	_	_
of	_	_
[	_	_
3	_	_
,	_	_
55	_	_
]	_	_
,	_	_
by	_	_
exploiting	_	_
the	_	_
vislet	_	_
information	_	_
;	_	_
•	_	_
Thanks	_	_
to	_	_
MX-LSTM	_	_
,	_	_
we	_	_
define	_	_
state-of-the-art	_	_
forecasting	_	_
results	_	_
on	_	_
different	_	_
datasets	_	_
;	_	_
•	_	_
We	_	_
present	_	_
MX-LSTM	_	_
results	_	_
of	_	_
head	_	_
pose	_	_
forecasting	_	_
,	_	_
showing	_	_
new	_	_
long-term	_	_
behavior	_	_
analysis	_	_
capabilities	_	_
.	_	_

#27
The	_	_
rest	_	_
of	_	_
the	_	_
paper	_	_
is	_	_
organized	_	_
as	_	_
follows	_	_
.	_	_

#28
Sec	_	_
.	_	_

#29
2	_	_
reviews	_	_
the	_	_
related	_	_
literature	_	_
.	_	_

#30
Sec	_	_
.	_	_

#31
3	_	_
presents	_	_
the	_	_
proposed	_	_
MX-LSTM	_	_
while	_	_
Sec	_	_
.	_	_

#32
4	_	_
motivates	_	_
its	_	_
design	_	_
by	_	_
showing	_	_
how	_	_
head	_	_
pose	_	_
and	_	_
trajectories	_	_
are	_	_
related	_	_
in	_	_
the	_	_
most	_	_
popular	_	_
forecasting	_	_
datasets	_	_
.	_	_

#33
We	_	_
show	_	_
quantitative	_	_
and	_	_
qualitative	_	_
experiments	_	_
in	_	_
Sec	_	_
.	_	_

#34
5	_	_
,	_	_
concluding	_	_
the	_	_
paper	_	_
in	_	_
Sec	_	_
.	_	_

#35
6	_	_
.	_	_

#36
2	_	_
.	_	_

#37
Related	_	_
work	_	_
Classical	_	_
forecasting	_	_
approaches	_	_
[	_	_
38	_	_
]	_	_
adopted	_	_
Kalman	_	_
filters	_	_
[	_	_
29	_	_
]	_	_
,	_	_
linear	_	_
[	_	_
37	_	_
]	_	_
or	_	_
Gaussian	_	_
regression	_	_
models	_	_
[	_	_
44	_	_
,	_	_
45	_	_
,	_	_
57	_	_
,	_	_
58	_	_
]	_	_
,	_	_
autoregressive	_	_
models	_	_
[	_	_
2	_	_
]	_	_
and	_	_
time-series	_	_
analysis	_	_
[	_	_
43	_	_
]	_	_
.	_	_

#38
These	_	_
approaches	_	_
ignore	_	_
human-human	_	_
interactions	_	_
,	_	_
which	_	_
instead	_	_
play	_	_
a	_	_
major	_	_
role	_	_
in	_	_
recent	_	_
literature	_	_
.	_	_

#39
Human-human	_	_
interactions	_	_
.	_	_

#40
The	_	_
consideration	_	_
of	_	_
other	_	_
pedestrians	_	_
in	_	_
the	_	_
scene	_	_
and	_	_
their	_	_
innate	_	_
avoidance	_	_
of	_	_
collisions	_	_
was	_	_
first	_	_
pioneered	_	_
by	_	_
[	_	_
24	_	_
]	_	_
.	_	_

#41
This	_	_
initial	_	_
seed	_	_
was	_	_
further	_	_
developed	_	_
by	_	_
[	_	_
34	_	_
]	_	_
,	_	_
[	_	_
35	_	_
]	_	_
and	_	_
[	_	_
40	_	_
]	_	_
,	_	_
which	_	_
respectively	_	_
introduced	_	_
a	_	_
data-driven	_	_
,	_	_
a	_	_
continuous	_	_
,	_	_
and	_	_
a	_	_
game	_	_
theoretical	_	_
model	_	_
.	_	_

#42
Notably	_	_
,	_	_
these	_	_
approaches	_	_
successfully	_	_
employ	_	_
essential	_	_
cues	_	_
for	_	_
track	_	_
prediction	_	_
such	_	_
as	_	_
the	_	_
human-human	_	_
interaction	_	_
and	_	_
the	_	_
people	_	_
intended	_	_
destination	_	_
.	_	_

#43
More	_	_
recent	_	_
works	_	_
encode	_	_
the	_	_
human-human	_	_
interactions	_	_
into	_	_
a	_	_
“social”	_	_
descriptor	_	_
[	_	_
4	_	_
]	_	_
or	_	_
propose	_	_
human	_	_
attributes	_	_
[	_	_
60	_	_
]	_	_
for	_	_
the	_	_
forecasting	_	_
in	_	_
crowds	_	_
.	_	_

#44
More	_	_
implicitly	_	_
,	_	_
other	_	_
methods	_	_
[	_	_
3	_	_
,	_	_
55	_	_
]	_	_
embed	_	_
proxemic	_	_
reasoning	_	_
in	_	_
the	_	_
prediction	_	_
by	_	_
pooling	_	_
hidden	_	_
variables	_	_
representing	_	_
the	_	_
probable	_	_
location	_	_
of	_	_
a	_	_
pedestrian	_	_
in	_	_
a	_	_
LSTM	_	_
.	_	_

#45
Our	_	_
work	_	_
mainly	_	_
differentiates	_	_
from	_	_
[	_	_
3	_	_
,	_	_
34	_	_
,	_	_
40	_	_
,	_	_
55	_	_
]	_	_
because	_	_
we	_	_
only	_	_
consider	_	_
for	_	_
interactions	_	_
those	_	_
people	_	_
who	_	_
are	_	_
within	_	_
the	_	_
cone	_	_
of	_	_
attention	_	_
of	_	_
the	_	_
person	_	_
,	_	_
(	_	_
as	_	_
also	_	_
verified	_	_
by	_	_
psychological	_	_
studies	_	_
[	_	_
27	_	_
]	_	_
)	_	_
.	_	_

#46
Destination-focused	_	_
path	_	_
forecast	_	_
.	_	_

#47
Path	_	_
forecasting	_	_
has	_	_
also	_	_
been	_	_
framed	_	_
as	_	_
an	_	_
inverse	_	_
optimal	_	_
control	_	_
(	_	_
IOC	_	_
)	_	_
problem	_	_
[	_	_
30	_	_
]	_	_
.	_	_

#48
Follow-up	_	_
work	_	_
adopted	_	_
inverse	_	_
reinforcement	_	_
learning	_	_
[	_	_
1	_	_
,	_	_
61	_	_
]	_	_
and	_	_
dynamic	_	_
reward	_	_
functions	_	_
[	_	_
33	_	_
]	_	_
to	_	_
address	_	_
the	_	_
occurring	_	_
changes	_	_
in	_	_
the	_	_
environment	_	_
.	_	_

#49
We	_	_
describe	_	_
these	_	_
approaches	_	_
as	_	_
destination-focused	_	_
because	_	_
they	_	_
all	_	_
require	_	_
the	_	_
end-point	_	_
of	_	_
the	_	_
person	_	_
track	_	_
to	_	_
be	_	_
known	_	_
,	_	_
which	_	_
later	_	_
works	_	_
have	_	_
relaxed	_	_
to	_	_
a	_	_
set	_	_
of	_	_
plausible	_	_
path	_	_
ends	_	_
[	_	_
13	_	_
,	_	_
36	_	_
]	_	_
.	_	_

#50
Here	_	_
we	_	_
discard	_	_
this	_	_
information	_	_
,	_	_
that	_	_
in	_	_
our	_	_
opinion	_	_
undermines	_	_
the	_	_
reason	_	_
why	_	_
we	_	_
may	_	_
be	_	_
predicting	_	_
the	_	_
tracks	_	_
.	_	_

#51
The	_	_
head	_	_
pose	_	_
and	_	_
the	_	_
social	_	_
motivation	_	_
.	_	_

#52
The	_	_
interest	_	_
into	_	_
the	_	_
head	_	_
pose	_	_
stems	_	_
from	_	_
sociological	_	_
studies	_	_
such	_	_
as	_	_
[	_	_
8	_	_
,	_	_
11	_	_
,	_	_
14	_	_
,	_	_
15	_	_
,	_	_
16	_	_
,	_	_
39	_	_
,	_	_
54	_	_
]	_	_
,	_	_
whereby	_	_
head	_	_
pose	_	_
has	_	_
been	_	_
shown	_	_
to	_	_
correlate	_	_
to	_	_
the	_	_
person	_	_
destination	_	_
and	_	_
pathway	_	_
.	_	_

#53
In	_	_
this	_	_
paper	_	_
,	_	_
we	_	_
also	_	_
discover	_	_
that	_	_
the	_	_
head	_	_
pose	_	_
is	_	_
correlated	_	_
with	_	_
the	_	_
movement	_	_
,	_	_
especially	_	_
at	_	_
high	_	_
velocities	_	_
,	_	_
while	_	_
slowing	_	_
down	_	_
this	_	_
correlation	_	_
decreases	_	_
too	_	_
,	_	_
but	_	_
still	_	_
remaining	_	_
statistically	_	_
significant	_	_
.	_	_

#54
These	_	_
studies	_	_
motivate	_	_
the	_	_
use	_	_
of	_	_
the	_	_
head	_	_
pose	_	_
as	_	_
a	_	_
proxy	_	_
to	_	_
the	_	_
track	_	_
forecasting	_	_
.	_	_

#55
Using	_	_
head	_	_
pose	_	_
comes	_	_
with	_	_
the	_	_
further	_	_
advantage	_	_
that	_	_
it	_	_
can	_	_
be	_	_
estimated	_	_
at	_	_
small	_	_
resolutions	_	_
[	_	_
5	_	_
,	_	_
17	_	_
,	_	_
23	_	_
,	_	_
32	_	_
,	_	_
46	_	_
,	_	_
49	_	_
,	_	_
52	_	_
]	_	_
,	_	_
thus	_	_
requiring	_	_
no	_	_
oracle	_	_
information	_	_
and	_	_
enabling	_	_
a	_	_
real-time	_	_
system	_	_
.	_	_

#56
Without	_	_
loss	_	_
of	_	_
generality	_	_
,	_	_
for	_	_
the	_	_
head	_	_
pose	_	_
estimation	_	_
we	_	_
adopt	_	_
the	_	_
publicly	_	_
available	_	_
algorithm	_	_
of	_	_
[	_	_
32	_	_
]	_	_
.	_	_

#57
LSTM	_	_
models	_	_
.	_	_

#58
LSTM	_	_
models	_	_
[	_	_
26	_	_
]	_	_
are	_	_
employed	_	_
in	_	_
those	_	_
tasks	_	_
where	_	_
the	_	_
output	_	_
is	_	_
conditioned	_	_
on	_	_
a	_	_
varying	_	_
number	_	_
of	_	_
inputs	_	_
[	_	_
20	_	_
,	_	_
56	_	_
]	_	_
,	_	_
notably	_	_
hand	_	_
writing	_	_
generation	_	_
[	_	_
19	_	_
]	_	_
and	_	_
tracking	_	_
[	_	_
10	_	_
]	_	_
.	_	_

#59
As	_	_
for	_	_
trajectory	_	_
forecasting	_	_
,	_	_
[	_	_
3	_	_
]	_	_
models	_	_
pedestrians	_	_
as	_	_
LSTMs	_	_
that	_	_
share	_	_
their	_	_
hidden	_	_
states	_	_
through	_	_
a	_	_
“social”	_	_
pooling	_	_
layer	_	_
,	_	_
avoiding	_	_
to	_	_
forecast	_	_
colliding	_	_
trajectories	_	_
.	_	_

#60
This	_	_
idea	_	_
has	_	_
been	_	_
successfully	_	_
adopted	_	_
by	_	_
[	_	_
55	_	_
]	_	_
,	_	_
and	_	_
further	_	_
developed	_	_
in	_	_
[	_	_
48	_	_
]	_	_
for	_	_
modeling	_	_
the	_	_
tracking	_	_
dynamics	_	_
.	_	_

#61
A	_	_
similar	_	_
idea	_	_
has	_	_
been	_	_
embedded	_	_
directly	_	_
in	_	_
the	_	_
LSTM	_	_
memory	_	_
unit	_	_
as	_	_
a	_	_
regularization	_	_
that	_	_
models	_	_
the	_	_
local	_	_
spatial	_	_
and	_	_
temporal	_	_
dependency	_	_
between	_	_
neighboring	_	_
pedestrians	_	_
[	_	_
22	_	_
,	_	_
50	_	_
]	_	_
.	_	_

#62
As	_	_
written	_	_
above	_	_
,	_	_
here	_	_
we	_	_
modify	_	_
the	_	_
social	_	_
pooling	_	_
by	_	_
considering	_	_
a	_	_
visibility	_	_
attentional	_	_
area	_	_
driven	_	_
by	_	_
the	_	_
head	_	_
pose	_	_
.	_	_

#63
In	_	_
most	_	_
of	_	_
the	_	_
cases	_	_
,	_	_
the	_	_
training	_	_
of	_	_
LSTMs	_	_
for	_	_
forecasting	_	_
minimizes	_	_
the	_	_
negative	_	_
log-likelihood	_	_
over	_	_
Gaussians	_	_
[	_	_
3	_	_
,	_	_
55	_	_
]	_	_
or	_	_
mixture	_	_
of	_	_
Guassians	_	_
[	_	_
19	_	_
]	_	_
.	_	_

#64
In	_	_
general	_	_
,	_	_
when	_	_
it	_	_
comes	_	_
to	_	_
Gaussian	_	_
log-likelihood	_	_
loss	_	_
functions	_	_
,	_	_
only	_	_
bidimensional	_	_
data	_	_
(	_	_
i.e.	_	_
(	_	_
x	_	_
,	_	_
y	_	_
)	_	_
coordinates	_	_
)	_	_
have	_	_
been	_	_
considered	_	_
so	_	_
far	_	_
,	_	_
leading	_	_
to	_	_
the	_	_
estimation	_	_
of	_	_
2×	_	_
2	_	_
covariance	_	_
matrices	_	_
.	_	_

#65
These	_	_
can	_	_
be	_	_
optimized	_	_
without	_	_
considering	_	_
the	_	_
positive	_	_
semidefinite	_	_
requirement	_	_
[	_	_
18	_	_
]	_	_
,	_	_
which	_	_
is	_	_
one	_	_
of	_	_
the	_	_
most	_	_
important	_	_
problems	_	_
for	_	_
the	_	_
covariances	_	_
obtained	_	_
by	_	_
optimization	_	_
[	_	_
41	_	_
]	_	_
(	_	_
see	_	_
Sec	_	_
.	_	_

#66
3.4	_	_
)	_	_
.	_	_

#67
Here	_	_
for	_	_
the	_	_
first	_	_
time	_	_
,	_	_
we	_	_
study	_	_
the	_	_
problem	_	_
of	_	_
optimizing	_	_
Gaussian	_	_
parameters	_	_
of	_	_
higher	_	_
dimensionality	_	_
.	_	_

#68
3	_	_
.	_	_

#69
Our	_	_
approach	_	_
In	_	_
this	_	_
section	_	_
we	_	_
present	_	_
the	_	_
MX-LSTM	_	_
,	_	_
capable	_	_
of	_	_
jointly	_	_
forecasting	_	_
positions	_	_
and	_	_
head	_	_
orientations	_	_
of	_	_
an	_	_
individual	_	_
thanks	_	_
to	_	_
the	_	_
presence	_	_
of	_	_
two	_	_
information	_	_
streams	_	_
:	_	_
Tracklets	_	_
and	_	_
vislets	_	_
.	_	_

#70
3.1	_	_
.	_	_

#71
Tracklets	_	_
and	_	_
vislets	_	_
Given	_	_
a	_	_
subject	_	_
i	_	_
,	_	_
a	_	_
tracklet	_	_
(	_	_
see	_	_
Fig.	_	_
1a	_	_
)	_	_
)	_	_
is	_	_
formed	_	_
by	_	_
consecutive	_	_
(	_	_
x	_	_
,	_	_
y	_	_
)	_	_
positions	_	_
on	_	_
the	_	_
ground	_	_
plane	_	_
,	_	_
{	_	_
x	_	_
(	_	_
i	_	_
)	_	_
t	_	_
}	_	_
t=1	_	_
,	_	_
...	_	_
,	_	_
T	_	_
,	_	_
x	_	_
(	_	_
i	_	_
)	_	_
t	_	_
=	_	_
(	_	_
x	_	_
,	_	_
y	_	_
)	_	_
∈	_	_
R2	_	_
,	_	_
while	_	_
a	_	_
vislet	_	_
is	_	_
formed	_	_
by	_	_
anchor	_	_
points	_	_
{	_	_
a	_	_
(	_	_
i	_	_
)	_	_
t	_	_
}	_	_
t=1	_	_
,	_	_
...	_	_
,	_	_
T	_	_
,	_	_
with	_	_
a	_	_
(	_	_
i	_	_
)	_	_
t	_	_
=	_	_
(	_	_
ax	_	_
,	_	_
ay	_	_
)	_	_
∈	_	_
R2	_	_
indicating	_	_
a	_	_
reference	_	_
point	_	_
at	_	_
a	_	_
fixed	_	_
distance	_	_
r	_	_
from	_	_
the	_	_
corresponding	_	_
x	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
towards	_	_
which	_	_
the	_	_
face	_	_
is	_	_
oriented1	_	_
.	_	_

#72
In	_	_
b	_	_
)	_	_
γ	_	_
d	_	_
a	_	_
)	_	_
)	_	_
(	_	_
i	_	_
ta	_	_
)	_	_
(	_	_
i	_	_
tx	_	_
)	_	_
(	_	_
i	_	_
tα	_	_
r	_	_
)	_	_
(	_	_
i	_	_
t+x	_	_
c	_	_
)	_	_
1+tx	_	_
ta	_	_
tx	_	_
tα	_	_
tβ	_	_
tω	_	_
Figure	_	_
1	_	_
.	_	_

#73
Graphical	_	_
explanations	_	_
;	_	_
a	_	_
)	_	_
tracklets	_	_
x	_	_
(	_	_
i	_	_
)	_	_
t	_	_
and	_	_
x	_	_
(	_	_
i	_	_
)	_	_
t+1	_	_
and	_	_
vislet	_	_
anchor	_	_
point	_	_
a	_	_
(	_	_
i	_	_
)	_	_
t	_	_
;	_	_
b	_	_
)	_	_
visual	_	_
frustum	_	_
pooling	_	_
;	_	_
c	_	_
)	_	_
angles	_	_
for	_	_
the	_	_
correlation	_	_
analysis	_	_
(	_	_
see	_	_
Sec	_	_
.	_	_

#74
4	_	_
)	_	_
.	_	_

#75
practice	_	_
,	_	_
a	_	_
(	_	_
i	_	_
)	_	_
t	_	_
is	_	_
a	_	_
fixed	_	_
size	_	_
vector	_	_
originating	_	_
from	_	_
x	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
whose	_	_
direction	_	_
implicitly	_	_
indicates	_	_
the	_	_
pan	_	_
angle	_	_
α	_	_
(	_	_
i	_	_
)	_	_
t	_	_
of	_	_
the	_	_
head	_	_
.	_	_

#76
In	_	_
principle	_	_
,	_	_
it	_	_
would	_	_
be	_	_
possible	_	_
to	_	_
encode	_	_
the	_	_
head	_	_
orientation	_	_
directly	_	_
with	_	_
an	_	_
angle	_	_
.	_	_

#77
We	_	_
prefer	_	_
the	_	_
vislet	_	_
representation	_	_
because	_	_
it	_	_
does	_	_
not	_	_
show	_	_
discontinuity	_	_
(	_	_
between	_	_
360◦	_	_
and	_	_
0◦	_	_
)	_	_
and	_	_
because	_	_
it	_	_
is	_	_
closer	_	_
to	_	_
the	_	_
(	_	_
x	_	_
,	_	_
y	_	_
)	_	_
position	_	_
representation	_	_
and	_	_
therefore	_	_
more	_	_
convenient	_	_
for	_	_
the	_	_
vislet-position	_	_
interplay	_	_
.	_	_

#78
In	_	_
the	_	_
forecasting	_	_
literature	_	_
[	_	_
3	_	_
,	_	_
53	_	_
,	_	_
59	_	_
]	_	_
it	_	_
is	_	_
assumed	_	_
that	_	_
the	_	_
prediction	_	_
follows	_	_
an	_	_
“observation”	_	_
period	_	_
in	_	_
which	_	_
ground-truth	_	_
data	_	_
is	_	_
fed	_	_
into	_	_
the	_	_
machine	_	_
.	_	_

#79
Here	_	_
,	_	_
the	_	_
observation	_	_
tracklets	_	_
and	_	_
vislets	_	_
are	_	_
fed	_	_
into	_	_
the	_	_
MX-LSTM	_	_
,	_	_
which	_	_
mixes	_	_
together	_	_
the	_	_
two	_	_
streams	_	_
to	_	_
understand	_	_
their	_	_
relationship	_	_
,	_	_
providing	_	_
a	_	_
joint	_	_
prediction	_	_
.	_	_

#80
In	_	_
the	_	_
experiments	_	_
we	_	_
evaluate	_	_
the	_	_
cases	_	_
in	_	_
which	_	_
the	_	_
past	_	_
vislets	_	_
are	_	_
ground	_	_
truth	_	_
,	_	_
but	_	_
also	_	_
the	_	_
“in-the-wild”	_	_
case	_	_
,	_	_
in	_	_
which	_	_
head	_	_
pose	_	_
is	_	_
given	_	_
by	_	_
a	_	_
real	_	_
head	_	_
detector	_	_
.	_	_

#81
In	_	_
this	_	_
way	_	_
,	_	_
MX-LSTM	_	_
will	_	_
1The	_	_
distance	_	_
r	_	_
is	_	_
not	_	_
influent	_	_
in	_	_
this	_	_
work	_	_
,	_	_
and	_	_
it	_	_
can	_	_
be	_	_
any	_	_
value	_	_
;	_	_
in	_	_
this	_	_
work	_	_
we	_	_
set	_	_
it	_	_
at	_	_
0.5	_	_
for	_	_
the	_	_
visualization	_	_
sake	_	_
.	_	_

#82
require	_	_
no	_	_
additional	_	_
annotations	_	_
in	_	_
respect	_	_
with	_	_
former	_	_
approaches	_	_
.	_	_

#83
A	_	_
single	_	_
MX-LSTM	_	_
is	_	_
instantiated	_	_
for	_	_
each	_	_
pedestrian	_	_
i	_	_
,	_	_
accepting	_	_
tracklets	_	_
and	_	_
vislets	_	_
with	_	_
two	_	_
separate	_	_
embedding	_	_
functions	_	_
:	_	_
e	_	_
(	_	_
x	_	_
,	_	_
i	_	_
)	_	_
t	_	_
=	_	_
φ	_	_
(	_	_
x	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
Wx	_	_
)	_	_
(	_	_
1	_	_
)	_	_
e	_	_
(	_	_
a	_	_
,	_	_
i	_	_
)	_	_
t	_	_
=	_	_
φ	_	_
(	_	_
a	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
Wa	_	_
)	_	_
(	_	_
2	_	_
)	_	_
where	_	_
the	_	_
embedding	_	_
function	_	_
φ	_	_
consists	_	_
in	_	_
a	_	_
linear	_	_
projection	_	_
through	_	_
the	_	_
embedding	_	_
weigths	_	_
Wx	_	_
and	_	_
Wa	_	_
into	_	_
a	_	_
D-dimensional	_	_
vector	_	_
,	_	_
multiplied	_	_
by	_	_
a	_	_
RELU	_	_
nonlinearity	_	_
,	_	_
where	_	_
D	_	_
is	_	_
the	_	_
dimension	_	_
of	_	_
the	_	_
hidden	_	_
space	_	_
.	_	_

#84
3.2	_	_
.	_	_

#85
VFOA	_	_
social	_	_
pooling	_	_
The	_	_
social	_	_
pooling	_	_
introduced	_	_
in	_	_
[	_	_
3	_	_
]	_	_
is	_	_
an	_	_
effective	_	_
way	_	_
to	_	_
let	_	_
the	_	_
LSTM	_	_
capture	_	_
how	_	_
people	_	_
move	_	_
in	_	_
a	_	_
crowded	_	_
scene	_	_
avoiding	_	_
collisions	_	_
.	_	_

#86
This	_	_
work	_	_
considers	_	_
an	_	_
isotropic	_	_
interest	_	_
area	_	_
around	_	_
the	_	_
single	_	_
pedestrian	_	_
,	_	_
in	_	_
which	_	_
the	_	_
hidden	_	_
states	_	_
of	_	_
the	_	_
the	_	_
neighbors	_	_
are	_	_
considered	_	_
,	_	_
including	_	_
those	_	_
which	_	_
are	_	_
behind	_	_
the	_	_
pedestrian	_	_
.	_	_

#87
In	_	_
our	_	_
case	_	_
,	_	_
we	_	_
improve	_	_
this	_	_
module	_	_
using	_	_
the	_	_
vislet	_	_
information	_	_
by	_	_
selecting	_	_
which	_	_
individuals	_	_
to	_	_
consider	_	_
,	_	_
by	_	_
building	_	_
a	_	_
view	_	_
frustum	_	_
of	_	_
attention	_	_
(	_	_
VFOA	_	_
)	_	_
,	_	_
that	_	_
is	_	_
a	_	_
triangle	_	_
originating	_	_
from	_	_
x	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
aligned	_	_
with	_	_
a	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
and	_	_
with	_	_
an	_	_
aperture	_	_
given	_	_
by	_	_
the	_	_
angle	_	_
γ	_	_
and	_	_
a	_	_
depth	_	_
d	_	_
;	_	_
these	_	_
parameters	_	_
have	_	_
been	_	_
learned	_	_
by	_	_
cross-validation	_	_
on	_	_
the	_	_
training	_	_
partition	_	_
of	_	_
the	_	_
TownCentre	_	_
dataset	_	_
(	_	_
see	_	_
Sec	_	_
.	_	_

#88
5	_	_
)	_	_
.	_	_

#89
Our	_	_
view-frustum	_	_
social	_	_
pooling	_	_
is	_	_
a	_	_
No	_	_
×No	_	_
×D	_	_
tensor	_	_
,	_	_
in	_	_
which	_	_
the	_	_
space	_	_
around	_	_
the	_	_
pedestrian	_	_
is	_	_
divided	_	_
into	_	_
a	_	_
grid	_	_
of	_	_
No	_	_
×	_	_
No	_	_
cells	_	_
as	_	_
in	_	_
[	_	_
3	_	_
]	_	_
,	_	_
in	_	_
which	_	_
the	_	_
VFOA	_	_
is	_	_
located	_	_
,	_	_
acting	_	_
as	_	_
the	_	_
new	_	_
interest	_	_
region	_	_
where	_	_
people	_	_
have	_	_
to	_	_
be	_	_
taken	_	_
into	_	_
account	_	_
.	_	_

#90
The	_	_
pooling	_	_
occurs	_	_
as	_	_
follows	_	_
:	_	_
H	_	_
(	_	_
i	_	_
)	_	_
t	_	_
(	_	_
m	_	_
,	_	_
n	_	_
,	_	_
:	_	_
)	_	_
=	_	_
∑	_	_
j∈V	_	_
FOAi	_	_
h	_	_
(	_	_
j	_	_
)	_	_
t	_	_
,	_	_
(	_	_
3	_	_
)	_	_
where	_	_
the	_	_
m	_	_
and	_	_
n	_	_
indices	_	_
run	_	_
over	_	_
the	_	_
No	_	_
×	_	_
No	_	_
grid	_	_
and	_	_
the	_	_
condition	_	_
j	_	_
∈	_	_
V	_	_
FOAi	_	_
is	_	_
satisfied	_	_
when	_	_
the	_	_
subject	_	_
j	_	_
is	_	_
in	_	_
the	_	_
VFOA	_	_
of	_	_
subject	_	_
i	_	_
.	_	_

#91
The	_	_
pooling	_	_
vector	_	_
is	_	_
then	_	_
embedded	_	_
into	_	_
a	_	_
D-dimensional	_	_
vector	_	_
by	_	_
e	_	_
(	_	_
H	_	_
,	_	_
i	_	_
)	_	_
t	_	_
=	_	_
φ	_	_
(	_	_
H	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
WH	_	_
)	_	_
.	_	_

#92
(	_	_
4	_	_
)	_	_
Finally	_	_
,	_	_
the	_	_
MX-LSTM	_	_
recursion	_	_
equation	_	_
is	_	_
h	_	_
(	_	_
i	_	_
)	_	_
t	_	_
=	_	_
LSTM	_	_
(	_	_
h	_	_
(	_	_
i	_	_
)	_	_
t−1	_	_
,	_	_
e	_	_
(	_	_
x	_	_
,	_	_
i	_	_
)	_	_
t	_	_
,	_	_
e	_	_
(	_	_
a	_	_
,	_	_
i	_	_
)	_	_
t	_	_
,	_	_
e	_	_
(	_	_
H	_	_
,	_	_
i	_	_
)	_	_
t	_	_
,	_	_
WLSTM	_	_
)	_	_
.	_	_

#93
(	_	_
5	_	_
)	_	_
3.3	_	_
.	_	_

#94
LSTM	_	_
recursion	_	_
In	_	_
principle	_	_
(	_	_
but	_	_
in	_	_
the	_	_
next	_	_
subsection	_	_
we	_	_
will	_	_
ultimately	_	_
modify	_	_
the	_	_
formulation	_	_
)	_	_
,	_	_
the	_	_
hidden	_	_
state	_	_
is	_	_
enforced	_	_
to	_	_
contain	_	_
the	_	_
parameters	_	_
of	_	_
a	_	_
four	_	_
dimensional	_	_
Gaussian	_	_
multivariate	_	_
distribution	_	_
N	_	_
(	_	_
µ	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
Σ	_	_
(	_	_
i	_	_
)	_	_
t	_	_
)	_	_
as	_	_
follows	_	_
:	_	_
[	_	_
µ	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
Σ̂	_	_
(	_	_
i	_	_
)	_	_
t	_	_
]	_	_
=	_	_
Woh	_	_
(	_	_
i	_	_
)	_	_
t−1	_	_
,	_	_
(	_	_
6	_	_
)	_	_
where	_	_
Σ̂	_	_
(	_	_
i	_	_
)	_	_
t	_	_
is	_	_
the	_	_
vectorized	_	_
version	_	_
of	_	_
Σ	_	_
(	_	_
i	_	_
)	_	_
t	_	_
.	_	_

#95
In	_	_
practice	_	_
µ	_	_
(	_	_
i	_	_
)	_	_
t	_	_
=	_	_
[	_	_
µ	_	_
(	_	_
x	_	_
,	_	_
i	_	_
)	_	_
t	_	_
,	_	_
µ	_	_
(	_	_
y	_	_
,	_	_
i	_	_
)	_	_
t	_	_
,	_	_
µ	_	_
(	_	_
ax	_	_
,	_	_
i	_	_
)	_	_
t	_	_
,	_	_
µ	_	_
(	_	_
ay	_	_
,	_	_
i	_	_
)	_	_
t	_	_
]	_	_
and	_	_
Σ	_	_
(	_	_
i	_	_
)	_	_
t	_	_
contains	_	_
the	_	_
covariances	_	_
among	_	_
the	_	_
(	_	_
x	_	_
,	_	_
y	_	_
)	_	_
coordinate	_	_
distributions	_	_
of	_	_
the	_	_
tracklets	_	_
and	_	_
the	_	_
vislets	_	_
.	_	_

#96
The	_	_
distribution	_	_
is	_	_
then	_	_
sampled	_	_
to	_	_
generate	_	_
the	_	_
joint	_	_
prediction	_	_
of	_	_
tracklets	_	_
and	_	_
vislet	_	_
points	_	_
[	_	_
x̂t	_	_
,	_	_
ât	_	_
]	_	_
.	_	_

#97
In	_	_
other	_	_
words	_	_
,	_	_
we	_	_
are	_	_
able	_	_
at	_	_
the	_	_
same	_	_
time	_	_
of	_	_
forecasting	_	_
trajectries	_	_
and	_	_
head	_	_
poses	_	_
.	_	_

#98
The	_	_
weight	_	_
parameters	_	_
of	_	_
the	_	_
LSTM	_	_
are	_	_
found	_	_
by	_	_
minimizing	_	_
the	_	_
multivariate	_	_
Gaussian	_	_
log-likelihood	_	_
for	_	_
the	_	_
i−th	_	_
trajectory	_	_
Li	_	_
(	_	_
Wx	_	_
,	_	_
Wa	_	_
,	_	_
WH	_	_
,	_	_
WLSTM	_	_
,	_	_
Wo	_	_
)	_	_
=	_	_
−	_	_
Tpred∑	_	_
Tobs+1	_	_
log	_	_
(	_	_
P	_	_
(	_	_
[	_	_
x	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
a	_	_
(	_	_
i	_	_
)	_	_
t	_	_
]	_	_
,	_	_
µ	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
Σ	_	_
(	_	_
i	_	_
)	_	_
t	_	_
)	_	_
)	_	_
,	_	_
(	_	_
7	_	_
)	_	_
where	_	_
Tobs	_	_
is	_	_
the	_	_
time	_	_
frame	_	_
until	_	_
when	_	_
the	_	_
ground	_	_
truth	_	_
data	_	_
is	_	_
observed	_	_
by	_	_
the	_	_
LSTM	_	_
,	_	_
while	_	_
Tobs+1	_	_
,	_	_
.	_	_

#99
.	_	_

#100
.	_	_

#101
,	_	_
Tpred	_	_
are	_	_
the	_	_
time	_	_
frames	_	_
for	_	_
which	_	_
is	_	_
requested	_	_
the	_	_
prediction	_	_
.	_	_

#102
The	_	_
loss	_	_
of	_	_
Eq.	_	_
7	_	_
is	_	_
minimized	_	_
over	_	_
all	_	_
the	_	_
training	_	_
sequences	_	_
,	_	_
and	_	_
to	_	_
prevent	_	_
overfitting	_	_
we	_	_
include	_	_
an	_	_
l2	_	_
regularization	_	_
term	_	_
.	_	_

#103
3.4.	_	_
MX-LSTM	_	_
optimization	_	_

#104
The	_	_
optimization	_	_
provides	_	_
the	_	_
weight	_	_
matrices	_	_
of	_	_
the	_	_
MX-LSTM	_	_
,	_	_
which	_	_
in	_	_
turn	_	_
produce	_	_
the	_	_
set	_	_
of	_	_
Gaussian	_	_
parameters	_	_
,	_	_
including	_	_
the	_	_
full	_	_
covariance	_	_
Σ	_	_
.	_	_

#105
The	_	_
latter	_	_
is	_	_
needed	_	_
to	_	_
enforce	_	_
the	_	_
LSTM	_	_
in	_	_
encoding	_	_
the	_	_
relations	_	_
among	_	_
the	_	_
(	_	_
x	_	_
,	_	_
y	_	_
)	_	_
coordinate	_	_
distributions	_	_
of	_	_
the	_	_
tracklets	_	_
and	_	_
the	_	_
vislets	_	_
,	_	_
which	_	_
we	_	_
will	_	_
further	_	_
discuss	_	_
in	_	_
Sec.	_	_
4	_	_
.	_	_

#106
In	_	_
general	_	_
,	_	_
the	_	_
estimation	_	_
of	_	_
a	_	_
full	_	_
covariance	_	_
matrix	_	_
through	_	_
optimization	_	_
of	_	_
an	_	_
objective	_	_
function	_	_
(	_	_
as	_	_
the	_	_
log-likelihood	_	_
of	_	_
Eq.	_	_
(	_	_
7	_	_
)	_	_
)	_	_
is	_	_
a	_	_
difficult	_	_
numerical	_	_
problem	_	_
[	_	_
41	_	_
]	_	_
,	_	_
since	_	_
one	_	_
must	deontic	_
guarantee	_	_
that	_	_
the	_	_
resulting	_	_
estimate	_	_
is	_	_
a	_	_
proper	_	_
covariance	_	_
,	_	_
i.e.	_	_
,	_	_
a	_	_
positive	_	_
semi-definite	_	_
(	_	_
p.s.d.	_	_
)	_	_
matrix	_	_
.	_	_

#107
LSTMs	_	_
involving	_	_
log-likelihood	_	_
losses	_	_
over	_	_
Gaussian	_	_
distributions	_	_
have	_	_
been	_	_
restricted	_	_
so	_	_
far	_	_
to	_	_
two	_	_
dimensions	_	_
for	_	_
simple	_	_
Gaussian	_	_
[	_	_
3	_	_
]	_	_
or	_	_
mixture	_	_
of	_	_
Gaussian	_	_
[	_	_
19	_	_
]	_	_
distributions	_	_
,	_	_
in	_	_
which	_	_
the	_	_
2	_	_
×	_	_
2	_	_
covariance	_	_
matrices	_	_
have	_	_
been	_	_
obtained	_	_
by	_	_
simply	_	_
optimizing	_	_
the	_	_
scalar	_	_
correlation	_	_
index	_	_
ρx	_	_
,	_	_
y	_	_
,	_	_
which	_	_
becomes	_	_
the	_	_
covariance	_	_
term	_	_
of	_	_
Σ	_	_
with	_	_
σx	_	_
,	_	_
y	_	_
=	_	_
ρx	_	_
,	_	_
yσxσy	_	_
[	_	_
19	_	_
]	_	_
.	_	_

#108
In	_	_
the	_	_
case	_	_
of	_	_
higher	_	_
dimensional	_	_
problems	_	_
,	_	_
pairwise	_	_
correlation	_	_
terms	_	_
can	_	_
not	_	_
be	_	_
optimized	_	_
and	_	_
used	_	_
to	_	_
build	_	_
Σ	_	_
,	_	_
since	_	_
the	_	_
optimization	_	_
process	_	_
for	_	_
each	_	_
correlation	_	_
term	_	_
is	_	_
independent	_	_
from	_	_
each	_	_
other	_	_
,	_	_
while	_	_
the	_	_
positive-definiteness	_	_
is	_	_
a	_	_
simultaneous	_	_
constraint	_	_
on	_	_
multiple	_	_
variables	_	_
[	_	_
42	_	_
]	_	_
.	_	_

#109
This	_	_
lacks	_	_
of	_	_
coordination	_	_
provides	_	_
matrices	_	_
far	_	_
from	_	_
being	_	_
s.d.p.	_	_
,	_	_
that	_	_
in	_	_
turns	_	_
require	_	_
a	_	_
correction	_	_
procedures	_	_
by	_	_
projecting	_	_
into	_	_
the	_	_
closest	_	_
s.d.p	_	_
.	_	_

#110
matrix	_	_
using	_	_
,	_	_
for	_	_
instance	_	_
,	_	_
a	_	_
cost	_	_
function	_	_
based	_	_
on	_	_
the	_	_
Frobenious	_	_
norm	_	_
[	_	_
7	_	_
,	_	_
25	_	_
]	_	_
.	_	_

#111
These	_	_
procedures	_	_
are	_	_
costly	_	_
[	_	_
41	_	_
]	_	_
,	_	_
and	_	_
difficult	_	_
to	_	_
be	_	_
embedded	_	_
into	_	_
the	_	_
optimization	_	_
process	_	_
[	_	_
12	_	_
]	_	_
,	_	_
especially	_	_
in	_	_
the	_	_
case	_	_
of	_	_
the	_	_
LSTM	_	_
,	_	_
where	_	_
nonlinearities	_	_
due	_	_
to	_	_
the	_	_
embedding	_	_
weights	_	_
make	_	_
the	_	_
analytical	_	_
derivation	_	_
hard	_	_
to	_	_
formulate	_	_
.	_	_

#112
So	_	_
far	_	_
,	_	_
no	_	_
LSTM	_	_
loss	_	_
has	_	_
involved	_	_
full	_	_
covariances	_	_
of	_	_
dimension	_	_
>	_	_
2	_	_
.	_	_

#113
Our	_	_
solution	_	_
involves	_	_
unconstrained	_	_
optimization	_	_
,	_	_
where	_	_
an	_	_
opportune	_	_
parameterization	_	_
of	_	_
the	_	_
variables	_	_
to	_	_
learn	_	_
enforces	_	_
the	_	_
positive	_	_
semi-definite	_	_
constraint	_	_
,	_	_
which	_	_
is	_	_
easier	_	_
to	_	_
express	_	_
,	_	_
dramatically	_	_
improving	_	_
the	_	_
convergence	_	_
properties	_	_
of	_	_
the	_	_
optimization	_	_
algorithm	_	_
.	_	_

#114
In	_	_
practice	_	_
,	_	_
we	_	_
consider	_	_
the	_	_
Choleski	_	_
family	_	_
of	_	_
parameterizations	_	_
[	_	_
42	_	_
]	_	_
:	_	_
let	_	_
Σ	_	_
denote	_	_
a	_	_
definite	_	_
positive	_	_
n	_	_
×	_	_
n	_	_
(	_	_
in	_	_
our	_	_
case	_	_
,	_	_
n	_	_
=	_	_
4	_	_
)	_	_
covariance	_	_
matrix	_	_
.	_	_

#115
Since	_	_
Σ	_	_
is	_	_
symmetric	_	_
,	_	_
only	_	_
n	_	_
(	_	_
n	_	_
+	_	_
1	_	_
)	_	_
/2	_	_
parameters	_	_
are	_	_
requested	_	_
to	_	_
represent	_	_
it	_	_
.	_	_

#116
The	_	_
Choleski	_	_
factorization	_	_
is	_	_
given	_	_
by	_	_
:	_	_
Σ	_	_
=	_	_
LTL	_	_
,	_	_
(	_	_
8	_	_
)	_	_
where	_	_
L	_	_
is	_	_
a	_	_
n×	_	_
n	_	_
upper	_	_
triangular	_	_
matrix	_	_
.	_	_

#117
In	_	_
practice	_	_
,	_	_
the	_	_
optimization	_	_
process	_	_
would	_	_
focus	_	_
on	_	_
finding	_	_
the	_	_
n	_	_
(	_	_
n+1	_	_
)	_	_
/2	_	_
distinct	_	_
scalar	_	_
values	_	_
for	_	_
L	_	_
,	_	_
which	_	_
then	_	_
solve	_	_
for	_	_
the	_	_
covariance	_	_
given	_	_
Eq.	_	_
(	_	_
8	_	_
)	_	_
.	_	_

#118
One	_	_
problem	_	_
with	_	_
the	_	_
Cholesky	_	_
factorization	_	_
is	_	_
its	_	_
non-uniqueness	_	_
:	_	_
any	_	_
matrix	_	_
obtained	_	_
by	_	_
multiplying	_	_
a	_	_
subset	_	_
of	_	_
the	_	_
rows	_	_
of	_	_
L	_	_
by	_	_
-1	_	_
is	_	_
valid	_	_
;	_	_
as	_	_
a	_	_
consequence	_	_
,	_	_
non-uniqueness	_	_
of	_	_
the	_	_
solution	_	_
makes	_	_
the	_	_
optimization	_	_
process	_	_
hard	_	_
to	_	_
converge	_	_
.	_	_

#119
To	_	_
make	_	_
L	_	_
unique	_	_
,	_	_
its	_	_
diagonal	_	_
elements	_	_
have	_	_
to	_	_
be	_	_
all	_	_
positive	_	_
.	_	_

#120
To	_	_
this	_	_
end	_	_
,	_	_
the	_	_
Log-Cholesky	_	_
parameterization	_	_
[	_	_
42	_	_
]	_	_
assumes	_	_
that	_	_
the	_	_
values	_	_
found	_	_
by	_	_
the	_	_
optimizer	_	_
of	_	_
the	_	_
main	_	_
covariance	_	_
diagonal	_	_
are	_	_
the	_	_
log	_	_
of	_	_
the	_	_
values	_	_
of	_	_
L	_	_
:	_	_
Formally	_	_
,	_	_
the	_	_
values	_	_
found	_	_
by	_	_
the	_	_
optimizer	_	_
can	_	_
be	_	_
written	_	_
as	_	_
θL	_	_
=	_	_
	_	_
log	_	_
l1,1	_	_
l1,2	_	_
l1,3	_	_
l1,4	_	_
0	_	_
log	_	_
l2,2	_	_
l2,3	_	_
l2,4	_	_
0	_	_
0	_	_
log	_	_
l3,3	_	_
l3,4	_	_
0	_	_
0	_	_
0	_	_
log	_	_
l4,4	_	_
	_	_
.	_	_

#121
In	_	_
practice	_	_
,	_	_
after	_	_
the	_	_
estimation	_	_
of	_	_
Wx	_	_
,	_	_
Wa	_	_
,	_	_
WH	_	_
,	_	_
WLSTM	_	_
,	_	_
Wo	_	_
parameters	_	_
,	_	_
the	_	_
values	_	_
of	_	_
θL	_	_
are	_	_
extracted	_	_
by	_	_
[	_	_
µ	_	_
(	_	_
i	_	_
)	_	_
t	_	_
,	_	_
θ̂L	_	_
(	_	_
i	_	_
)	_	_
t	_	_
]	_	_
=	_	_
Woh	_	_
(	_	_
i	_	_
)	_	_
t−1	_	_
,	_	_
(	_	_
9	_	_
)	_	_
where	_	_
θ̂L	_	_
is	_	_
the	_	_
vectorized	_	_
version	_	_
of	_	_
θL	_	_
.	_	_

#122
Then	_	_
,	_	_
the	_	_
diagonal	_	_
values	_	_
of	_	_
θL	_	_
are	_	_
exponentiated	_	_
to	_	_
form	_	_
L	_	_
and	_	_
obtaining	_	_
Σ	_	_
through	_	_
Eq.	_	_
(	_	_
8	_	_
)	_	_
.	_	_

#123
4	_	_
.	_	_

#124
Motivation	_	_
for	_	_
the	_	_
MX-LSTM	_	_
So	_	_
far	_	_
,	_	_
no	_	_
quantitative	_	_
studies	_	_
focused	_	_
on	_	_
how	_	_
head	_	_
pose	_	_
knowledge	_	_
impacts	_	_
on	_	_
the	_	_
trajectory	_	_
forecasting	_	_
.	_	_

#125
Here	_	_
,	_	_
we	_	_
show	_	_
a	_	_
preliminary	_	_
analysis	_	_
of	_	_
the	_	_
common	_	_
forecasting	_	_
datasets	_	_
with	_	_
emphasis	_	_
on	_	_
the	_	_
head	_	_
pose	_	_
,	_	_
that	_	_
motivated	_	_
the	_	_
design	_	_
of	_	_
the	_	_
MX-LSTM	_	_
.	_	_

#126
In	_	_
particular	_	_
,	_	_
we	_	_
focus	_	_
on	_	_
the	_	_
UCY	_	_
dataset	_	_
[	_	_
34	_	_
]	_	_
,	_	_
composed	_	_
by	_	_
the	_	_
Zara01	_	_
,	_	_
Zara02	_	_
,	_	_
and	_	_
UCY	_	_
sequences	_	_
,	_	_
which	_	_
provides	_	_
the	_	_
annotations	_	_
for	_	_
the	_	_
pan	_	_
angle	_	_
of	_	_
the	_	_
head	_	_
pose	_	_
of	_	_
all	_	_
the	_	_
pedestrians	_	_
.	_	_

#127
We	_	_
also	_	_
consider	_	_
the	_	_
Town	_	_
Center	_	_
(	_	_
d	_	_
eg	_	_
re	_	_
es	_	_
)	_	_
0.5	_	_
1.5	_	_
2.5	_	_
3.5	_	_
4.5	_	_
er	_	_
ro	_	_
r	_	_
(	_	_
m	_	_
et	_	_
er	_	_
s	_	_
)	_	_
0	_	_
500	_	_
1000	_	_
1500	_	_
2000	_	_
2500	_	_
3000	_	_
3500	_	_
4000	_	_
4500	_	_
5000	_	_
sequences	_	_
0.5	_	_
1.5	_	_
2.5	_	_
3.5	_	_
ve	_	_
lo	_	_
ci	_	_
ty	_	_
(	_	_
m	_	_
/s	_	_
ec	_	_
)	_	_
average	_	_
velocity	_	_
average	_	_
MAD	_	_
errors	_	_
(	_	_
various	_	_
methods	_	_
)	_	_
Social	_	_
Force	_	_
model	_	_
(	_	_
SF	_	_
)	_	_
[	_	_
59	_	_
]	_	_
Linear	_	_
Trajectory	_	_
Avoidance	_	_
(	_	_
LTA	_	_
)	_	_
[	_	_
40	_	_
]	_	_
Vanilla	_	_
LSTM	_	_
[	_	_
3	_	_
]	_	_
Social	_	_
LSTM	_	_
(	_	_
S-LSTM	_	_
)	_	_
[	_	_
3	_	_
]	_	_
MX-LSTM	_	_
0	_	_
0.5	_	_
1	_	_
1.5	_	_
2	_	_
2.5	_	_
velocity	_	_
(	_	_
m/sec	_	_
)	_	_
0.7	_	_
0.75	_	_
0.8	_	_
0.85	_	_
0.9	_	_
0.95	_	_
(	_	_
α	_	_
,	_	_
β	_	_
)	_	_
c	_	_
or	_	_
re	_	_
la	_	_
ti	_	_
on	_	_
(	_	_
P	_	_
ea	_	_
rs	_	_
on	_	_
;	_	_
p	_	_
-v	_	_
al	_	_
ue	_	_
<	_	_
0.	_	_
)	_	_

#128
MAD	_	_
error	_	_
(	_	_
MX-LSTM	_	_
)	_	_
ω	_	_
ω	_	_
Figure	_	_
2	_	_
.	_	_

#129
Motivating	_	_
the	_	_
MX-LSTM	_	_
:	_	_
a	_	_
)	_	_
analysis	_	_
between	_	_
the	_	_
angle	_	_
discrepancy	_	_
ω	_	_
between	_	_
head	_	_
pose	_	_
and	_	_
movement	_	_
,	_	_
the	_	_
pedestrain	_	_
smoothed	_	_
velocity	_	_
and	_	_
the	_	_
average	_	_
errors	_	_
of	_	_
different	_	_
approaches	_	_
on	_	_
the	_	_
UCY	_	_
sequence	_	_
[	_	_
34	_	_
]	_	_
;	_	_
b	_	_
)	_	_
correlation	_	_
between	_	_
movement	_	_
angle	_	_
β	_	_
and	_	_
head	_	_
orientation	_	_
angle	_	_
α	_	_
when	_	_
the	_	_
velocity	_	_
is	_	_
varying	_	_
(	_	_
better	_	_
in	_	_
color	_	_
)	_	_
.	_	_

#130
dataset	_	_
[	_	_
6	_	_
]	_	_
,	_	_
where	_	_
we	_	_
manually	_	_
annotated	_	_
the	_	_
head	_	_
pose	_	_
,	_	_
using	_	_
the	_	_
same	_	_
annotation	_	_
protocol	_	_
of	_	_
[	_	_
34	_	_
]	_	_
.	_	_

#131
We	_	_
discover	_	_
the	_	_
following	_	_
facts2	_	_
:	_	_
1	_	_
)	_	_
People	_	_
often	_	_
do	_	_
not	_	_
watch	_	_
their	_	_
steps	_	_
.	_	_

#132
To	_	_
show	_	_
this	_	_
fact	_	_
,	_	_
for	_	_
each	_	_
individual	_	_
trajectory	_	_
composed	_	_
by	_	_
T	_	_
frames	_	_
(	_	_
omitting	_	_
the	_	_
individual	_	_
indices	_	_
)	_	_
,	_	_
we	_	_
calculate	_	_
all	_	_
the	_	_
αt	_	_
,	_	_
βt	_	_
and	_	_
ωt	_	_
of	_	_
Fig.1c	_	_
.	_	_

#133
The	_	_
αt	_	_
is	_	_
the	_	_
head	_	_
pose	_	_
pan	_	_
angle	_	_
with	_	_
respect	_	_
to	_	_
a	_	_
given	_	_
reference	_	_
system	_	_
;	_	_
similarly	_	_
,	_	_
βt	_	_
is	_	_
the	_	_
angle	_	_
of	_	_
motion	_	_
,	_	_
and	_	_
ωt	_	_
is	_	_
showing	_	_
the	_	_
discrepancy	_	_
between	_	_
the	_	_
two	_	_
.	_	_

#134
For	_	_
each	_	_
individual	_	_
trajectory	_	_
,	_	_
we	_	_
compute	_	_
the	_	_
average	_	_
ω	_	_
=	_	_
1/N	_	_
∑	_	_
t=1	_	_
...	_	_
T	_	_
ωt	_	_
.	_	_

#135
On	_	_
the	_	_
multi-y-axis	_	_
Fig.	_	_
2a	_	_
,	_	_
we	_	_
show	_	_
the	_	_
ω	_	_
value	_	_
(	_	_
in	_	_
degrees	_	_
)	_	_
of	_	_
all	_	_
the	_	_
sequences	_	_
,	_	_
in	_	_
an	_	_
increasing	_	_
order	_	_
(	_	_
blue	_	_
line	_	_
and	_	_
axis	_	_
)	_	_
.	_	_

#136
From	_	_
the	_	_
figure	_	_
,	_	_
we	_	_
omit	_	_
those	_	_
sequences	_	_
where	_	_
the	_	_
speed	_	_
is	_	_
below	_	_
0.45m/sec	_	_
.	_	_

#137
:	_	_
in	_	_
those	_	_
cases	_	_
the	_	_
individual	_	_
is	_	_
essentially	_	_
still	_	_
and	_	_
the	_	_
movement	_	_
vector	_	_
#	_	_
»	_	_
xt+1	_	_
−	_	_
xt	_	_
carry	_	_
few	_	_
if	_	_
no	_	_
meaning	_	_
,	_	_
and	_	_
consequently	_	_
the	_	_
angle	_	_
βt	_	_
can	_	_
not	_	_
be	_	_
taken	_	_
into	_	_
account	_	_
.	_	_

#138
The	_	_
ω	_	_
value	_	_
ranges	_	_
from	_	_
0.02◦	_	_
to	_	_
72◦	_	_
.	_	_

#139
We	_	_
conclude	_	_
that	_	_
in	_	_
25	_	_
%	_	_
of	_	_
the	_	_
video	_	_
sequences	_	_
the	_	_
misalignment	_	_
between	_	_
the	_	_
head	_	_
pose	_	_
and	_	_
the	_	_
step	_	_
direction	_	_
is	_	_
larger	_	_
than	_	_
20◦	_	_
.	_	_

#140
2	_	_
)	_	_
Head	_	_
pose	_	_
and	_	_
movements	_	_
are	_	_
(	_	_
statistically	_	_
)	_	_
correlated	_	_
;	_	_
On	_	_
the	_	_
same	_	_
figure	_	_
,	_	_
we	_	_
report	_	_
the	_	_
velocity	_	_
curve	_	_
(	_	_
black	_	_
solid	_	_
line	_	_
and	_	_
axis	_	_
)	_	_
,	_	_
where	_	_
each	_	_
y-point	_	_
gives	_	_
the	_	_
average	_	_
speed	_	_
of	_	_
the	_	_
i	_	_
−	_	_
th	_	_
ordered	_	_
trajectory	_	_
on	_	_
the	_	_
x-axis	_	_
.	_	_

#141
For	_	_
the	_	_
sake	_	_
of	_	_
readability	_	_
,	_	_
the	_	_
curve	_	_
has	_	_
been	_	_
smoothed	_	_
with	_	_
moving	_	_
average	_	_
filter	_	_
of	_	_
size	_	_
10	_	_
.	_	_

#142
As	_	_
it	_	_
shows	_	_
,	_	_
there	_	_
is	_	_
a	_	_
relation	_	_
of	_	_
inverse	_	_
proportionality	_	_
between	_	_
the	_	_
ω	_	_
and	_	_
the	_	_
pedestrian	_	_
speed	_	_
:	_	_
the	_	_
alignment	_	_
between	_	_
the	_	_
head	_	_
towards	_	_
the	_	_
direction	_	_
of	_	_
movement	_	_
is	_	_
higher	_	_
when	_	_
the	_	_
speed	_	_
is	_	_
higher	_	_
;	_	_
when	_	_
the	_	_
person	_	_
slows	_	_
down	_	_
the	_	_
head	_	_
pose	_	_
is	_	_
dramatically	_	_
misaligned	_	_
.	_	_

#143
The	_	_
relation	_	_
is	_	_
statistically	_	_
significant	_	_
:	_	_
we	_	_
consider	_	_
the	_	_
Pearson	_	_
circular	_	_
correlation	_	_
coefficient	_	_
[	_	_
28	_	_
]	_	_
between	_	_
the	_	_
angles	_	_
αt	_	_
and	_	_
βt	_	_
,	_	_
computed	_	_
over	_	_
all	_	_
2Here	_	_
is	_	_
presented	_	_
the	_	_
analysis	_	_
on	_	_
the	_	_
UCY	_	_
sequence	_	_
,	_	_
which	_	_
is	_	_
similar	_	_
to	_	_
what	_	_
we	_	_
observed	_	_
on	_	_
the	_	_
other	_	_
sequences	_	_
.	_	_

#144
the	_	_
frames	_	_
of	_	_
the	_	_
sequences	_	_
considered	_	_
for	_	_
that	_	_
figure	_	_
.	_	_

#145
On	_	_
the	_	_
whole	_	_
data	_	_
,	_	_
the	_	_
correlation	_	_
is	_	_
0.83	_	_
(	_	_
p-value	_	_
<	_	_
0.01	_	_
)	_	_
.	_	_

#146
We	_	_
also	_	_
investigate	_	_
how	_	_
the	_	_
correlation	_	_
changes	_	_
with	_	_
the	_	_
speed	_	_
:	_	_
Fig.	_	_
2b	_	_
shows	_	_
the	_	_
correlation	_	_
values	_	_
against	_	_
velocity	_	_
,	_	_
computed	_	_
by	_	_
pooling	_	_
the	_	_
αt	_	_
and	_	_
βt	_	_
angles	_	_
around	_	_
a	_	_
certain	_	_
velocity	_	_
value	_	_
;	_	_
in	_	_
particular	_	_
,	_	_
each	_	_
correlation	_	_
value	_	_
at	_	_
velocity	_	_
τ	_	_
has	_	_
been	_	_
computed	_	_
by	_	_
considering	_	_
all	_	_
of	_	_
the	_	_
samples	_	_
in	_	_
the	_	_
range	_	_
[	_	_
τ	_	_
−	_	_
0.01R	_	_
,	_	_
τ	_	_
+	_	_
0.01R	_	_
]	_	_
,	_	_
where	_	_
R	_	_
is	_	_
the	_	_
whole	_	_
velocity	_	_
range	_	_
.	_	_

#147
All	_	_
the	_	_
reported	_	_
values	_	_
have	_	_
statistical	_	_
significance	_	_
(	_	_
p-value	_	_
<	_	_
0.01	_	_
)	_	_
.	_	_

#148
The	_	_
plot	_	_
shows	_	_
clearly	_	_
that	_	_
the	_	_
correlation	_	_
is	_	_
lower	_	_
at	_	_
low	_	_
velocities	_	_
,	_	_
where	_	_
the	_	_
discrepancy	_	_
between	_	_
the	_	_
αt	_	_
and	_	_
βt	_	_
angles	_	_
is	_	_
in	_	_
general	_	_
higher	_	_
.	_	_

#149
The	_	_
challenge	_	_
here	_	_
is	_	_
to	_	_
investigate	_	_
whether	_	_
this	_	_
discrepancy	_	_
can	_	_
be	_	_
learned	_	_
by	_	_
the	_	_
MX-LSTM	_	_
to	_	_
improve	_	_
the	_	_
forecasting	_	_
.	_	_

#150
More	_	_
intriguingly	_	_
,	_	_
MX-LSTM	_	_
should	_	_
learn	_	_
how	_	_
these	_	_
relations	_	_
evolve	_	_
in	_	_
time	_	_
,	_	_
which	_	_
has	_	_
not	_	_
been	_	_
investigated	_	_
yet	_	_
,	_	_
since	_	_
the	_	_
analysis	_	_
done	_	_
so	_	_
far	_	_
consider	_	_
each	_	_
time	_	_
instant	_	_
as	_	_
independent	_	_
from	_	_
each	_	_
other	_	_
.	_	_

#151
3	_	_
)	_	_
Forecasting	_	_
errors	_	_
are	_	_
in	_	_
general	_	_
higher	_	_
when	_	_
the	_	_
speed	_	_
of	_	_
the	_	_
pedestrian	_	_
is	_	_
lower	_	_
;	_	_
In	_	_
Fig.	_	_
2	_	_
are	_	_
reported	_	_
the	_	_
Mean	_	_
Average	_	_
Displacement	_	_
(	_	_
MAD	_	_
)	_	_
error	_	_
[	_	_
40	_	_
]	_	_
(	_	_
red	_	_
line	_	_
and	_	_
axis	_	_
)	_	_
of	_	_
the	_	_
following	_	_
approaches	_	_
:	_	_
SF	_	_
[	_	_
59	_	_
]	_	_
,	_	_
LTA	_	_
[	_	_
53	_	_
]	_	_
,	_	_
vanilla	_	_
LSTM	_	_
and	_	_
Social	_	_
LSTM	_	_
[	_	_
3	_	_
]	_	_
,	_	_
together	_	_
with	_	_
our	_	_
MX-LSTM	_	_
approach	_	_
.	_	_

#152
In	_	_
general	_	_
,	_	_
lower	_	_
velocities	_	_
bring	_	_
to	_	_
higher	_	_
errors	_	_
,	_	_
since	_	_
when	_	_
people	_	_
are	_	_
walking	_	_
very	_	_
slowly	_	_
their	_	_
behavior	_	_
become	_	_
less	_	_
predictable	_	_
,	_	_
due	_	_
to	_	_
physical	_	_
reasons	_	_
(	_	_
less	_	_
inertia	_	_
)	_	_
but	_	_
also	_	_
behavioral	_	_
(	_	_
people	_	_
walking	_	_
slowly	_	_
are	_	_
usually	_	_
involved	_	_
into	_	_
other	_	_
activities	_	_
,	_	_
like	_	_
talking	_	_
with	_	_
other	_	_
people	_	_
,	_	_
looking	_	_
around	_	_
)	_	_
.	_	_

#153
On	_	_
the	_	_
contrary	_	_
,	_	_
it	_	_
is	_	_
shown	_	_
here	_	_
that	_	_
MX-LSTM	_	_
is	_	_
performing	_	_
well	_	_
even	_	_
at	_	_
lower	_	_
velocities	_	_
,	_	_
reaching	_	_
errors	_	_
very	_	_
close	_	_
to	_	_
zero	_	_
with	_	_
static	_	_
people	_	_
(	_	_
more	_	_
details	_	_
in	_	_
Sec.5	_	_
)	_	_
.	_	_

#154
Summarizing	_	_
,	_	_
head	_	_
pose	_	_
is	_	_
correlated	_	_
with	_	_
the	_	_
movement	_	_
,	_	_
especially	_	_
when	_	_
people	_	_
move	_	_
fast	_	_
.	_	_

#155
When	_	_
people	_	_
move	_	_
slow	_	_
,	_	_
the	_	_
correlation	_	_
is	_	_
weaker	_	_
but	_	_
significant	_	_
,	_	_
the	_	_
prediction	_	_
errors	_	_
are	_	_
larger	_	_
,	_	_
and	_	_
the	_	_
head	_	_
pose	_	_
is	_	_
drastically	_	_
misaligned	_	_
with	_	_
the	_	_
movement	_	_
.	_	_

#156
These	_	_
facts	_	_
justify	_	_
and	_	_
motivate	_	_
our	_	_
objective	_	_
with	_	_
the	_	_
MX-LSTM	_	_
,	_	_
to	_	_
capture	_	_
the	_	_
head	_	_
pose	_	_
information	_	_
jointly	_	_
with	_	_
the	_	_
movement	_	_
and	_	_
use	_	_
it	_	_
for	_	_
a	_	_
better	_	_
forecasting	_	_
.	_	_

#157
5	_	_
.	_	_

#158
Experiments	_	_
We	_	_
present	_	_
here	_	_
both	_	_
quantitative	_	_
and	_	_
qualitative	_	_
experiments	_	_
.	_	_

#159
Quantitative	_	_
results	_	_
validate	_	_
the	_	_
proposed	_	_
MX-LSTM	_	_
model	_	_
,	_	_
setting	_	_
the	_	_
new	_	_
state-of-the-art	_	_
for	_	_
trajectory	_	_
forecasting	_	_
;	_	_
results	_	_
are	_	_
also	_	_
provided	_	_
for	_	_
an	_	_
ablation	_	_
study	_	_
showing	_	_
the	_	_
importance	_	_
of	_	_
the	_	_
different	_	_
parts	_	_
of	_	_
the	_	_
MXLSTM	_	_
.	_	_

#160
Finally	_	_
,	_	_
we	_	_
present	_	_
the	_	_
very	_	_
first	_	_
results	_	_
on	_	_
head	_	_
pose	_	_
forecasting	_	_
.	_	_

#161
Qualitative	_	_
results	_	_
unveil	_	_
the	_	_
interplay	_	_
between	_	_
tracklets	_	_
and	_	_
vislets	_	_
that	_	_
the	_	_
MX-LSTM	_	_
has	_	_
learnt	_	_
.	_	_

#162
5.1	_	_
.	_	_

#163
Quantitative	_	_
results	_	_
We	_	_
evaluate	_	_
our	_	_
model	_	_
against	_	_
all	_	_
the	_	_
published	_	_
approaches	_	_
which	_	_
made	_	_
their	_	_
code	_	_
publicly	_	_
available	_	_
:	_	_
Social	_	_
Force	_	_
model	_	_
(	_	_
SF	_	_
)	_	_
[	_	_
59	_	_
]	_	_
,	_	_
Linear	_	_
Trajectory	_	_
Avoidance	_	_
(	_	_
LTA	_	_
)	_	_
[	_	_
40	_	_
]	_	_
,	_	_
Vanilla	_	_
LSTM	_	_
and	_	_
Social	_	_
LSTM	_	_
(	_	_
S-LSTM	_	_
)	_	_
[	_	_
3	_	_
]	_	_
.	_	_

#164
Experiments	_	_
follow	_	_
the	_	_
widely-used	_	_
evaluation	_	_
protocol	_	_
of	_	_
[	_	_
40	_	_
]	_	_
,	_	_
in	_	_
which	_	_
the	_	_
algorithm	_	_
first	_	_
observes	_	_
8	_	_
“observation”	_	_
ground	_	_
truth	_	_
(	_	_
GT	_	_
)	_	_
frames	_	_
of	_	_
a	_	_
trajectory	_	_
,	_	_
predicting	_	_
the	_	_
following	_	_
12	_	_
ones	_	_
.	_	_

#165
For	_	_
the	_	_
three	_	_
UCY	_	_
sequences	_	_
three	_	_
models	_	_
have	_	_
been	_	_
trained	_	_
:	_	_
for	_	_
each	_	_
one	_	_
we	_	_
used	_	_
two	_	_
sequences	_	_
as	_	_
training	_	_
data	_	_
and	_	_
then	_	_
we	_	_
tested	_	_
on	_	_
the	_	_
third	_	_
sequence	_	_
.	_	_

#166
For	_	_
Town	_	_
Centre	_	_
dataset	_	_
the	_	_
model	_	_
has	_	_
been	_	_
trained	_	_
and	_	_
tested	_	_
on	_	_
the	_	_
respective	_	_
provided	_	_
sets	_	_
.	_	_

#167
The	_	_
grid	_	_
for	_	_
the	_	_
social	_	_
pooling	_	_
(	_	_
Eq.	_	_
(	_	_
3	_	_
)	_	_
)	_	_
has	_	_
No	_	_
×	_	_
No	_	_
cells	_	_
with	_	_
No	_	_
=	_	_
32	_	_
.	_	_

#168
The	_	_
view	_	_
frustum	_	_
aperture	_	_
angle	_	_
has	_	_
been	_	_
cross-validated	_	_
on	_	_
the	_	_
training	_	_
partition	_	_
of	_	_
the	_	_
TownCenter	_	_
and	_	_
kept	_	_
fixed	_	_
for	_	_
the	_	_
remaining	_	_
trials	_	_
(	_	_
γ	_	_
=	_	_
40◦	_	_
)	_	_
,	_	_
while	_	_
the	_	_
depth	_	_
d	_	_
is	_	_
simply	_	_
bounded	_	_
by	_	_
the	_	_
social	_	_
pooling	_	_
grid	_	_
.	_	_

#169
Trajectory	_	_
prediction	_	_
performances	_	_
are	_	_
analyzed	_	_
with	_	_
the	_	_
Mean	_	_
Average	_	_
Displacement	_	_
(	_	_
MAD	_	_
)	_	_
error	_	_
(	_	_
euclidean	_	_
distance	_	_
between	_	_
predicted	_	_
and	_	_
GT	_	_
points	_	_
,	_	_
averaged	_	_
over	_	_
the	_	_
sequence	_	_
)	_	_
,	_	_
and	_	_
Final	_	_
Average	_	_
Displacement	_	_
(	_	_
FAD	_	_
)	_	_
error	_	_
(	_	_
distance	_	_
between	_	_
the	_	_
last	_	_
predicted	_	_
point	_	_
and	_	_
the	_	_
corresponding	_	_
GT	_	_
point	_	_
)	_	_
[	_	_
40	_	_
]	_	_
.	_	_

#170
Results	_	_
are	_	_
reported	_	_
in	_	_
Table	_	_
1	_	_
.	_	_

#171
The	_	_
MX-LSTM	_	_
outperforms	_	_
the	_	_
state-of-the-art	_	_
methods	_	_
in	_	_
every	_	_
single	_	_
sequence	_	_
and	_	_
with	_	_
both	_	_
metrics	_	_
,	_	_
with	_	_
an	_	_
average	_	_
improvement	_	_
of	_	_
32.7	_	_
%	_	_
.	_	_

#172
The	_	_
highest	_	_
relative	_	_
gain	_	_
is	_	_
achieved	_	_
in	_	_
Zara02	_	_
dataset	_	_
,	_	_
where	_	_
complex	_	_
non-linear	_	_
paths	_	_
are	_	_
mostly	_	_
caused	_	_
by	_	_
standing	_	_
conversational	_	_
groups	_	_
and	_	_
people	_	_
that	_	_
walk	_	_
close	_	_
to	_	_
them	_	_
,	_	_
avoiding	_	_
collisions	_	_
.	_	_

#173
People	_	_
slowing	_	_
down	_	_
and	_	_
looking	_	_
at	_	_
the	_	_
window	_	_
shops	_	_
pose	_	_
also	_	_
a	_	_
challenge	_	_
.	_	_

#174
As	_	_
shown	_	_
in	_	_
Fig.	_	_
2	_	_
,	_	_
slow	_	_
moving	_	_
and	_	_
interacting	_	_
pedestrians	_	_
cause	_	_
troubles	_	_
to	_	_
the	_	_
competing	_	_
methods	_	_
,	_	_
while	_	_
MX-LSTM	_	_
clearly	_	_
overcomes	_	_
such	_	_
shortcomings	_	_
denoting	_	_
a	_	_
better	_	_
model	_	_
.	_	_

#175
Qualitative	_	_
motivations	_	_
will	_	_
follow	_	_
in	_	_
Sec	_	_
.	_	_

#176
5.2	_	_
.	_	_

#177
Please	_	_
note	_	_
that	_	_
different	_	_
methods	_	_
rely	_	_
on	_	_
different	_	_
input	_	_
data	_	_
:	_	_
both	_	_
SF	_	_
and	_	_
LTA	_	_
require	_	_
the	_	_
destination	_	_
point	_	_
of	_	_
each	_	_
individual	_	_
,	_	_
while	_	_
SF	_	_
also	_	_
requires	_	_
annotations	_	_
about	_	_
social	_	_
groups	_	_
;	_	_
MX-LSTM	_	_
requires	_	_
the	_	_
head	_	_
pose	_	_
of	_	_
each	_	_
individual	_	_
for	_	_
the	_	_
first	_	_
8	_	_
frames	_	_
,	_	_
but	_	_
this	_	_
can	_	_
be	_	_
estimated	_	_
by	_	_
a	_	_
head	_	_
pose	_	_
estimator	_	_
.	_	_

#178
This	_	_
motivates	_	_
our	_	_
next	_	_
experiment	_	_
:	_	_
we	_	_
automatically	_	_
estimate	_	_
the	_	_
head	_	_
bounding	_	_
box	_	_
given	_	_
the	_	_
feet	_	_
positions	_	_
on	_	_
the	_	_
floor	_	_
plane	_	_
,	_	_
assuming	_	_
people	_	_
being	_	_
1.80m	_	_
tall	_	_
.	_	_

#179
Then	_	_
,	_	_
we	_	_
apply	_	_
the	_	_
head	_	_
pose	_	_
estimator	_	_
of	_	_
[	_	_
32	_	_
]	_	_
which	_	_
gives	_	_
continuous	_	_
angles	_	_
that	_	_
can	_	_
be	_	_
used	_	_
as	_	_
input	_	_
of	_	_
our	_	_
approach	_	_
now	_	_
named	_	_
“MX-LSTM-HPE”	_	_
.	_	_

#180
As	_	_
shown	_	_
by	_	_
the	_	_
scores	_	_
in	_	_
Table	_	_
1	_	_
,	_	_
MX-LSTM-HPE	_	_
does	_	_
not	_	_
suffer	_	_
about	_	_
small	_	_
errors	_	_
in	_	_
the	_	_
input	_	_
head	_	_
pose	_	_
,	_	_
with	_	_
an	_	_
average	_	_
drop	_	_
in	_	_
performances	_	_
of	_	_
only	_	_
5	_	_
%	_	_
.	_	_

#181
Note	_	_
that	_	_
MX-LSTM-HPE	_	_
still	_	_
outperforms	_	_
all	_	_
competing	_	_
methods	_	_
on	_	_
all	_	_
dataset	_	_
even	_	_
with	_	_
the	_	_
noisy	_	_
estimated	_	_
head	_	_
pose	_	_
information	_	_
.	_	_

#182
How	_	_
accurate	_	_
should	_	_
the	_	_
head	_	_
pose	_	_
estimation	_	_
be	_	_
,	_	_
for	_	_
the	_	_
MX-LSTM-HPE	_	_
to	_	_
have	_	_
convincing	_	_
performances	_	_
,	_	_
for	_	_
example	_	_
outperforming	_	_
the	_	_
Social	_	_
LSTM	_	_
?	_	_

#183
We	_	_
answer	_	_
this	_	_
question	_	_
by	_	_
corrupting	_	_
the	_	_
true	_	_
head	_	_
pose	_	_
estimate	_	_
with	_	_
additive	_	_
Gaussian	_	_
noise∼	_	_
N	_	_
(	_	_
αt	_	_
,	_	_
σ̂	_	_
)	_	_
,	_	_
where	_	_
αt	_	_
is	_	_
the	_	_
correct	_	_
head	_	_
pose	_	_
and	_	_
σ̂	_	_
the	_	_
standard	_	_
deviation	_	_
.	_	_

#184
MX-LSTM-HPE	_	_
outperforms	_	_
social-LSTM	_	_
up	_	_
to	_	_
a	_	_
noise	_	_
of	_	_
σ̂	_	_
=	_	_
24◦	_	_
.	_	_

#185
5.1.1	_	_
Ablation	_	_
study	_	_

#186
Aside	_	_
with	_	_
the	_	_
models	_	_
in	_	_
the	_	_
literature	_	_
,	_	_
we	_	_
investigate	_	_
three	_	_
variations	_	_
of	_	_
the	_	_
MX-LSTM	_	_
to	_	_
capture	_	_
the	_	_
net	_	_
contributions	_	_
of	_	_
the	_	_
different	_	_
parts	_	_
that	_	_
characterize	_	_
our	_	_
approach	_	_
.	_	_

#187
Block-Diagonal	_	_
MX-LSTM	_	_
(	_	_
BD-MX-LSTM	_	_
)	_	_
:	_	_
it	_	_
serves	_	_
to	_	_
highlight	_	_
the	_	_
importance	_	_
of	_	_
estimating	_	_
full	_	_
covariances	_	_
to	_	_
understand	_	_
the	_	_
interplay	_	_
between	_	_
tracklets	_	_
and	_	_
vislets	_	_
.	_	_

#188
Essentially	_	_
,	_	_
the	_	_
approach	_	_
estimates	_	_
two	_	_
bidimensional	_	_
covariances3	_	_
Σx	_	_
and	_	_
Σa	_	_
for	_	_
the	_	_
trajectory	_	_
and	_	_
the	_	_
vislet	_	_
modeling	_	_
respectively	_	_
,	_	_
without	_	_
capturing	_	_
the	_	_
cross-stream	_	_
covariances	_	_
.	_	_

#189
NoFrustum	_	_
MX-LSTM	_	_
:	_	_
this	_	_
variation	_	_
of	_	_
the	_	_
MX-LSTM	_	_
uses	_	_
social	_	_
pooling	_	_
as	_	_
in	_	_
[	_	_
3	_	_
]	_	_
,	_	_
in	_	_
which	_	_
the	_	_
interest	_	_
area	_	_
where	_	_
people	_	_
hidden	_	_
states	_	_
{	_	_
hjt	_	_
}	_	_
are	_	_
pooled	_	_
into	_	_
the	_	_
social	_	_
tensor	_	_
all	_	_
around	_	_
the	_	_
individual	_	_
.	_	_

#190
In	_	_
other	_	_
words	_	_
,	_	_
no	_	_
frustum	_	_
selecting	_	_
the	_	_
people	_	_
that	_	_
have	_	_
to	_	_
be	_	_
considered	_	_
is	_	_
used	_	_
here	_	_
.	_	_

#191
Individual	_	_
MX-LSTM	_	_
:	_	_
In	_	_
this	_	_
case	_	_
,	_	_
no	_	_
social	_	_
pooling	_	_
is	_	_
taken	_	_
into	_	_
account	_	_
,	_	_
therefore	_	_
the	_	_
embedding	_	_
operation	_	_
of	_	_
Eq.	_	_
(	_	_
4	_	_
)	_	_
is	_	_
absent	_	_
,	_	_
and	_	_
the	_	_
weight	_	_
matrix	_	_
WH	_	_
vanishes	_	_
.	_	_

#192
In	_	_
practice	_	_
,	_	_
this	_	_
variant	_	_
learns	_	_
independent	_	_
models	_	_
for	_	_
each	_	_
person	_	_
,	_	_
each	_	_
one	_	_
considering	_	_
the	_	_
tracklet	_	_
and	_	_
vislet	_	_
points	_	_
.	_	_

#193
Table	_	_
1	_	_
,	_	_
last	_	_
three	_	_
columns	_	_
,	_	_
reports	_	_
numerical	_	_
results	_	_
for	_	_
all	_	_
the	_	_
MX-LSTM	_	_
simplifications	_	_
on	_	_
all	_	_
the	_	_
datasets	_	_
.	_	_

#194
The	_	_
main	_	_
facts	_	_
that	_	_
emerge	_	_
are	_	_
:	_	_
1	_	_
)	_	_
the	_	_
highest	_	_
variations	_	_
are	_	_
with	_	_
the	_	_
Zara02	_	_
sequence	_	_
,	_	_
where	_	_
MX-LSTM	_	_
doubles	_	_
the	_	_
performances	_	_
of	_	_
the	_	_
worst	_	_
approach	_	_
(	_	_
Individual	_	_
MX-LSTM	_	_
)	_	_
;	_	_
2	_	_
)	_	_
the	_	_
worst	_	_
performing	_	_
is	_	_
in	_	_
general	_	_
Individual	_	_
MX-LSTM	_	_
,	_	_
3The	_	_
2	_	_
×	_	_
2	_	_
covariance	_	_
is	_	_
estimated	_	_
employing	_	_
two	_	_
variances	_	_
σ1	_	_
,	_	_
σ2	_	_
and	_	_
a	_	_
correlation	_	_
terms	_	_
ρ	_	_
as	_	_
presented	_	_
in	_	_
[	_	_
19	_	_
]	_	_
Eq.	_	_
(	_	_
24	_	_
)	_	_
and	_	_
(	_	_
25	_	_
)	_	_
.	_	_

#195
Table	_	_
1	_	_
.	_	_

#196
Mean	_	_
and	_	_
Final	_	_
Average	_	_
Displacement	_	_
errors	_	_
(	_	_
in	_	_
meters	_	_
)	_	_
for	_	_
all	_	_
the	_	_
methods	_	_
on	_	_
all	_	_
the	_	_
datasets	_	_
.	_	_

#197
The	_	_
first	_	_
5	_	_
columns	_	_
are	_	_
the	_	_
comparative	_	_
methods	_	_
and	_	_
our	_	_
proposed	_	_
model	_	_
trained	_	_
and	_	_
tested	_	_
with	_	_
GT	_	_
annotations	_	_
.	_	_

#198
MX-LSTM-HPE	_	_
is	_	_
our	_	_
model	_	_
tested	_	_
with	_	_
the	_	_
output	_	_
of	_	_
a	_	_
real	_	_
head	_	_
pose	_	_
estimator	_	_
[	_	_
32	_	_
]	_	_
.	_	_

#199
The	_	_
last	_	_
3	_	_
columns	_	_
are	_	_
variations	_	_
of	_	_
our	_	_
approach	_	_
trained	_	_
and	_	_
tested	_	_
on	_	_
GT	_	_
annotations	_	_
.	_	_

#200
Metric	_	_
Dataset	_	_
SF	_	_
[	_	_
59	_	_
]	_	_
LTA	_	_
[	_	_
40	_	_
]	_	_
Vanilla	_	_
LSTM	_	_
[	_	_
3	_	_
]	_	_
Social	_	_
LSTM	_	_
[	_	_
3	_	_
]	_	_
MX-LSTM	_	_
MX-LSTM-HPE	_	_
Individual	_	_
MX-LSTM	_	_
NoFrustum	_	_
MX-LSTM	_	_
BD-MX-LSTM	_	_
MAD	_	_
Zara01	_	_
2.88	_	_
2.74	_	_
0.90	_	_
0.68	_	_
0.59	_	_
0.66	_	_
0.63	_	_
0.63	_	_
0.60	_	_
Zara02	_	_
2.32	_	_
2.23	_	_
1.09	_	_
0.63	_	_
0.35	_	_
0.37	_	_
0.72	_	_
0.36	_	_
0.41	_	_
UCY	_	_
2.57	_	_
2.49	_	_
0.67	_	_
0.62	_	_
0.49	_	_
0.55	_	_
0.53	_	_
0.51	_	_
0.54	_	_
TownCentre	_	_
9.35	_	_
9.14	_	_
4.62	_	_
1.96	_	_
1.15	_	_
1.21	_	_
2.09	_	_
1.70	_	_
1.40	_	_
FAD	_	_
Zara01	_	_
5.55	_	_
5.55	_	_
1.85	_	_
1.53	_	_
1.31	_	_
1.43	_	_
1.37	_	_
1.40	_	_
1.51	_	_
Zara02	_	_
4.35	_	_
4.35	_	_
2.15	_	_
1.43	_	_
0.79	_	_
0.82	_	_
1.56	_	_
0.84	_	_
1.00	_	_
UCY	_	_
4.62	_	_
4.66	_	_
1.39	_	_
1.40	_	_
1.12	_	_
1.20	_	_
1.16	_	_
1.15	_	_
1.23	_	_
TownCentre	_	_
16.01	_	_
16.08	_	_
8.26	_	_
3.96	_	_
2.30	_	_
2.38	_	_
4.00	_	_
3.40	_	_
2.90	_	_
Table	_	_
2	_	_
.	_	_

#201
Mean	_	_
angular	_	_
error	_	_
(	_	_
in	_	_
degrees	_	_
)	_	_
for	_	_
the	_	_
state-of-the-art	_	_
head	_	_
pose	_	_
estimator	_	_
[	_	_
32	_	_
]	_	_
,	_	_
and	_	_
the	_	_
MX-LSTM	_	_
model	_	_
fed	_	_
with	_	_
GT	_	_
annotations	_	_
and	_	_
estimated	_	_
values	_	_
(	_	_
MX-LSTM-HPE	_	_
)	_	_
.	_	_

#202
Metric	_	_
Zara01	_	_
Zara02	_	_
UCY	_	_
Town	_	_
Centre	_	_
HPE	_	_
[	_	_
32	_	_
]	_	_
14.29	_	_
20.02	_	_
19.90	_	_
25.08	_	_
MX-LSTM	_	_
12.98	_	_
20.55	_	_
21.36	_	_
26.48	_	_
MX-LSTM-HPE	_	_
17.69	_	_
21.92	_	_
24.37	_	_
28.55	_	_
showing	_	_
that	_	_
social	_	_
reasoning	_	_
is	_	_
indeed	_	_
necessary	_	_
;	_	_
3	_	_
)	_	_
social	_	_
reasoning	_	_
is	_	_
systematically	_	_
improved	_	_
with	_	_
the	_	_
help	_	_
of	_	_
the	_	_
vislet-based	_	_
view-frustum	_	_
;	_	_
4	_	_
)	_	_
full	_	_
covariance	_	_
estimation	_	_
has	_	_
a	_	_
role	_	_
in	_	_
pushing	_	_
down	_	_
the	_	_
error	_	_
which	_	_
is	_	_
already	_	_
small	_	_
with	_	_
the	_	_
adoption	_	_
of	_	_
vislets	_	_
.	_	_

#203
Summarizing	_	_
the	_	_
results	_	_
so	_	_
far	_	_
,	_	_
having	_	_
vislets	_	_
as	_	_
input	_	_
allows	_	_
to	_	_
definitely	_	_
increase	_	_
the	_	_
trajectory	_	_
forecasting	_	_
performance	_	_
,	_	_
even	_	_
if	_	_
vislets	_	_
are	_	_
estimated	_	_
with	_	_
noise	_	_
.	_	_

#204
Vislets	_	_
should	_	_
be	_	_
used	_	_
to	_	_
understand	_	_
social	_	_
interactions	_	_
with	_	_
social	_	_
pooling	_	_
,	_	_
by	_	_
building	_	_
a	_	_
view	_	_
frustum	_	_
that	_	_
tells	_	_
which	_	_
are	_	_
the	_	_
people	_	_
currently	_	_
observed	_	_
by	_	_
each	_	_
individual	_	_
.	_	_

#205
All	_	_
of	_	_
these	_	_
features	_	_
are	_	_
done	_	_
efficiently	_	_
by	_	_
the	_	_
MX-LSTM	_	_
:	_	_
in	_	_
fact	_	_
the	_	_
training	_	_
time	_	_
is	_	_
the	_	_
same	_	_
with	_	_
having	_	_
an	_	_
LSTM	_	_
with	_	_
social	_	_
pooling	_	_
.	_	_

#206
5.1.2	_	_
Head	_	_
pose	_	_
forecasting	_	_

#207
As	_	_
done	_	_
with	_	_
trajectories	_	_
,	_	_
we	_	_
are	_	_
also	_	_
providing	_	_
a	_	_
forecast	_	_
of	_	_
the	_	_
head	_	_
pose	_	_
of	_	_
each	_	_
individual	_	_
at	_	_
each	_	_
frame	_	_
which	_	_
is	_	_
a	_	_
distinctive	_	_
attribute	_	_
of	_	_
our	_	_
method	_	_
.	_	_

#208
We	_	_
evaluate	_	_
the	_	_
performances	_	_
of	_	_
this	_	_
estimation	_	_
in	_	_
terms	_	_
of	_	_
mean	_	_
angular	_	_
error	_	_
eα	_	_
,	_	_
which	_	_
is	_	_
the	_	_
mean	_	_
absolute	_	_
difference	_	_
between	_	_
the	_	_
estimated	_	_
pose	_	_
(	_	_
angle	_	_
αt	_	_
,	_	_
·	_	_
in	_	_
Fig.	_	_
1c	_	_
)	_	_
and	_	_
the	_	_
annotated	_	_
GT	_	_
.	_	_

#209
Table	_	_
2	_	_
shows	_	_
numerical	_	_
results	_	_
of	_	_
the	_	_
static	_	_
head	_	_
pose	_	_
estimator	_	_
[	_	_
32	_	_
]	_	_
(	_	_
HPE	_	_
)	_	_
,	_	_
the	_	_
MX-LSTM	_	_
using	_	_
GT	_	_
head	_	_
poses	_	_
,	_	_
and	_	_
the	_	_
MX-LSTM	_	_
fed	_	_
with	_	_
the	_	_
output	_	_
of	_	_
HPE	_	_
during	_	_
the	_	_
observation	_	_
period	_	_
(	_	_
MX-LSTM-HPE	_	_
)	_	_
.	_	_

#210
In	_	_
all	_	_
the	_	_
cases	_	_
our	_	_
forecast	_	_
output	_	_
is	_	_
comparable	_	_
with	_	_
the	_	_
one	_	_
of	_	_
HPE	_	_
,	_	_
but	_	_
in	_	_
our	_	_
case	_	_
we	_	_
do	_	_
not	_	_
use	_	_
appearance	_	_
cues	_	_
–	_	_
i.e.	_	_
we	_	_
do	_	_
not	_	_
look	_	_
at	_	_
the	_	_
images	_	_
at	_	_
all	_	_
.	_	_

#211
In	_	_
case	_	_
of	_	_
Zara01	_	_
,	_	_
the	_	_
MX-LSTM	_	_
is	_	_
even	_	_
better	_	_
that	_	_
the	_	_
static	_	_
prediction	_	_
showing	_	_
the	_	_
forecasting	_	_
power	_	_
of	_	_
our	_	_
model	_	_
.	_	_

#212
In	_	_
our	_	_
opinion	_	_
this	_	_
is	_	_
due	_	_
to	_	_
the	_	_
fact	_	_
that	_	_
in	_	_
this	_	_
sequence	_	_
trajectories	_	_
are	_	_
mostly	_	_
very	_	_
linear	_	_
and	_	_
fast	_	_
,	_	_
and	_	_
heads	_	_
are	_	_
mostly	_	_
aligned	_	_
with	_	_
the	_	_
direction	_	_
of	_	_
motion	_	_
.	_	_

#213
When	_	_
we	_	_
provide	_	_
estimations	_	_
to	_	_
the	_	_
MX-LSTM	_	_
model	_	_
during	_	_
the	_	_
observation	_	_
period	_	_
,	_	_
angular	_	_
error	_	_
increases	_	_
,	_	_
as	_	_
expected	_	_
.	_	_

#214
Despite	_	_
this	_	_
,	_	_
the	_	_
error	_	_
is	_	_
surprisingly	_	_
limited	_	_
.	_	_

#215
5.2	_	_
.	_	_

#216
Qualitative	_	_
results	_	_
Fig.	_	_
3	_	_
shows	_	_
qualitative	_	_
results	_	_
on	_	_
the	_	_
Zara02	_	_
dataset	_	_
,	_	_
which	_	_
has	_	_
been	_	_
shown	_	_
to	_	_
be	_	_
the	_	_
most	_	_
complex	_	_
scenario	_	_
in	_	_
the	_	_
quantitative	_	_
experiments	_	_
Fig.	_	_
3a	_	_
presents	_	_
MX-LSTM	_	_
results	_	_
:	_	_
a	_	_
group	_	_
scenario	_	_
is	_	_
taken	_	_
into	_	_
account	_	_
,	_	_
with	_	_
the	_	_
attention	_	_
focused	_	_
on	_	_
the	_	_
girl	_	_
in	_	_
the	_	_
bottom-left	_	_
corner	_	_
.	_	_

#217
In	_	_
the	_	_
left	_	_
column	_	_
,	_	_
the	_	_
green	_	_
ground-truth	_	_
prediction	_	_
vislets	_	_
show	_	_
that	_	_
the	_	_
girl	_	_
is	_	_
conversing	_	_
with	_	_
the	_	_
group	_	_
members	_	_
,	_	_
with	_	_
a	_	_
movement	_	_
close	_	_
to	_	_
zero	_	_
and	_	_
the	_	_
pan	_	_
head	_	_
angle	_	_
which	_	_
oscillates	_	_
.	_	_

#218
In	_	_
magenta	_	_
,	_	_
the	_	_
behavior	_	_
of	_	_
the	_	_
S-LSTM	_	_
,	_	_
predicting	_	_
erroneously	_	_
the	_	_
girl	_	_
leaving	_	_
the	_	_
group	_	_
.	_	_

#219
This	_	_
error	_	_
confirms	_	_
the	_	_
problem	_	_
of	_	_
competing	_	_
methods	_	_
in	_	_
forecasting	_	_
the	_	_
motion	_	_
of	_	_
people	_	_
slowly	_	_
moving	_	_
or	_	_
static	_	_
as	_	_
discussed	_	_
in	_	_
Sec.4	_	_
,	_	_
and	_	_
further	_	_
confirmed	_	_
by	_	_
the	_	_
results	_	_
of	_	_
the	_	_
quantitative	_	_
experiments	_	_
.	_	_

#220
In	_	_
the	_	_
central	_	_
column	_	_
,	_	_
the	_	_
observation	_	_
sequence	_	_
given	_	_
to	_	_
the	_	_
MX-LSTM	_	_
is	_	_
shown	_	_
in	_	_
orange	_	_
(	_	_
almost	_	_
static	_	_
with	_	_
oscillating	_	_
vislets	_	_
)	_	_
.	_	_

#221
The	_	_
related	_	_
prediction	_	_
(	_	_
in	_	_
yellow	_	_
)	_	_
shows	_	_
oscillating	_	_
vislets	_	_
,	_	_
and	_	_
almost	_	_
no	_	_
movement	_	_
,	_	_
confirming	_	_
that	_	_
the	_	_
MX-LSTM	_	_
has	_	_
learnt	_	_
this	_	_
particular	_	_
social	_	_
behavior	_	_
.	_	_

#222
If	_	_
we	_	_
provide	_	_
to	_	_
MX-LSTM	_	_
an	_	_
artificial	_	_
observation	_	_
sequence	_	_
with	_	_
the	_	_
annotated	_	_
positions	_	_
(	_	_
real	_	_
trajectory	_	_
)	_	_
but	_	_
vislets	_	_
oriented	_	_
toward	_	_
west	_	_
(	_	_
third	_	_
column	_	_
,	_	_
orange	_	_
arrows	_	_
)	_	_
,	_	_
where	_	_
no	_	_
people	_	_
are	_	_
present	_	_
,	_	_
the	_	_
MX-LSTM	_	_
predicts	_	_
a	_	_
trajectory	_	_
departing	_	_
from	_	_
the	_	_
group	_	_
(	_	_
cyan	_	_
trajectory	_	_
and	_	_
arrows	_	_
)	_	_
.	_	_

#223
The	_	_
two	_	_
rows	_	_
of	_	_
Fig.	_	_
3b	_	_
)	_	_
analyze	_	_
the	_	_
Individual	_	_
MXLSTM	_	_
,	_	_
in	_	_
which	_	_
no	_	_
social	_	_
pooling	_	_
is	_	_
taken	_	_
into	_	_
account	_	_
.	_	_

#224
Therefore	_	_
,	_	_
here	_	_
each	_	_
pedestrian	_	_
is	_	_
not	_	_
influenced	_	_
by	_	_
the	_	_
surrounding	_	_
people	_	_
,	_	_
and	_	_
the	_	_
relationship	_	_
between	_	_
the	_	_
tracklets	_	_
and	_	_
the	_	_
vislets	_	_
in	_	_
the	_	_
prediction	_	_
can	_	_
be	_	_
observed	_	_
without	_	_
any	_	_
confounding	_	_
factor	_	_
.	_	_

#225
Fig.	_	_
3b	_	_
)	_	_
first	_	_
row	_	_
shows	_	_
three	_	_
situations	_	_
in	_	_
which	_	_
the	_	_
vislets	_	_
of	_	_
the	_	_
observation	_	_
sequence	_	_
are	_	_
artificially	_	_
made	_	_
pointing	_	_
north	_	_
(	_	_
orange	_	_
arrows	_	_
)	_	_
,	_	_
resulting	_	_
not	_	_
aligned	_	_
with	_	_
the	_	_
trajectory	_	_
.	_	_

#226
In	_	_
this	_	_
case	_	_
the	_	_
Individual	_	_
MX-LSTM	_	_
predicts	_	_
a	_	_
decelerating	_	_
trajectory	_	_
drifting	_	_
toward	_	_
north	_	_
(	_	_
magenta	_	_
trajectory	_	_
and	_	_
vislets	_	_
)	_	_
,	_	_
especially	_	_
in	_	_
Figure	_	_
3	_	_
.	_	_

#227
Qualitative	_	_
results	_	_
:	_	_
a	_	_
)	_	_
MX-LSTM	_	_
b	_	_
)	_	_
Ablation	_	_
qualitative	_	_
study	_	_
on	_	_
Individual	_	_
MX-LSTM	_	_
(	_	_
better	_	_
in	_	_
color	_	_
)	_	_
.	_	_

#228
the	_	_
second	_	_
and	_	_
third	_	_
pictures	_	_
.	_	_

#229
If	_	_
the	_	_
observation	_	_
has	_	_
the	_	_
legit	_	_
vislets	_	_
(	_	_
green	_	_
arrows	_	_
,	_	_
barely	_	_
visible	_	_
since	_	_
they	_	_
are	_	_
aligned	_	_
with	_	_
the	_	_
trajectory	_	_
)	_	_
,	_	_
the	_	_
resulting	_	_
trajectory	_	_
(	_	_
yellow	_	_
trajectory	_	_
and	_	_
vislets	_	_
)	_	_
has	_	_
a	_	_
different	_	_
behavior	_	_
,	_	_
closer	_	_
to	_	_
the	_	_
GT	_	_
(	_	_
green	_	_
trajectory	_	_
and	_	_
vislets	_	_
)	_	_
.	_	_

#230
The	_	_
second	_	_
row	_	_
is	_	_
similar	_	_
,	_	_
with	_	_
the	_	_
observation	_	_
vislets	_	_
made	_	_
pointing	_	_
to	_	_
south	_	_
.	_	_

#231
The	_	_
prediction	_	_
with	_	_
the	_	_
modified	_	_
vislets	_	_
is	_	_
in	_	_
black	_	_
.	_	_

#232
The	_	_
only	_	_
difference	_	_
is	_	_
in	_	_
the	_	_
bottom	_	_
left	_	_
picture	_	_
:	_	_
here	_	_
the	_	_
observation	_	_
vislets	_	_
pointing	_	_
south	_	_
are	_	_
in	_	_
accord	_	_
with	_	_
the	_	_
movement	_	_
,	_	_
so	_	_
that	_	_
the	_	_
resulting	_	_
predicted	_	_
trajectory	_	_
is	_	_
not	_	_
decelerating	_	_
as	_	_
in	_	_
the	_	_
other	_	_
cases	_	_
,	_	_
but	_	_
accelerating	_	_
toward	_	_
south	_	_
.	_	_

#233
6	_	_
.	_	_

#234
Conclusion	_	_
This	_	_
paper	_	_
showed	_	_
that	_	_
sequences	_	_
of	_	_
consecutive	_	_
head	_	_
poses	_	_
,	_	_
i.e.	_	_
,	_	_
the	_	_
vislets	_	_
,	_	_
are	_	_
of	_	_
great	_	_
help	_	_
for	_	_
trajectory	_	_
forecasting	_	_
.	_	_

#235
We	_	_
introduced	_	_
a	_	_
model	_	_
to	_	_
incorporate	_	_
vislets	_	_
and	_	_
tracklets	_	_
,	_	_
the	_	_
MX-LSTM	_	_
,	_	_
which	_	_
mixes	_	_
together	_	_
the	_	_
two	_	_
streams	_	_
of	_	_
information	_	_
providing	_	_
cross-stream	_	_
4	_	_
×	_	_
4	_	_
covariances	_	_
,	_	_
that	_	_
explain	_	_
how	_	_
head	_	_
poses	_	_
and	_	_
positions	_	_
on	_	_
the	_	_
plane	_	_
are	_	_
correlated	_	_
,	_	_
providing	_	_
accurate	_	_
forecasting	_	_
prediction	_	_
for	_	_
both	_	_
of	_	_
them	_	_
.	_	_

#236
This	_	_
has	_	_
been	_	_
possible	_	_
thanks	_	_
to	_	_
an	_	_
optimization	_	_
process	_	_
embedded	_	_
into	_	_
the	_	_
LSTM	_	_
backpropagation	_	_
which	_	_
uses	_	_
a	_	_
log-Cholesky	_	_
parameterization	_	_
,	_	_
leading	_	_
to	_	_
unconstrained	_	_
optimization	_	_
.	_	_

#237
We	_	_
believe	_	_
that	_	_
consideration	_	_
of	_	_
vislets	_	_
would	_	_
allow	_	_
us	_	_
,	_	_
in	_	_
future	_	_
work	_	_
,	_	_
to	_	_
also	_	_
encode	_	_
specific	_	_
areas	_	_
of	_	_
interest	_	_
into	_	_
the	_	_
trajectory	_	_
forecasting	_	_
.	_	_

#238
Acknowledgements	_	_
:	_	_
This	_	_
work	_	_
has	_	_
received	_	_
funding	_	_
from	_	_
the	_	_
European	_	_
Union’s	_	_
Horizon	_	_
2020	_	_
research	_	_
and	_	_
innovation	_	_
programme	_	_
under	_	_
the	_	_
Marie	_	_
Sklodowska-Curie	_	_
Grant	_	_
Agreement	_	_
No	_	_
.	_	_

#239
676455	_	_
,	_	_
and	_	_
has	_	_
been	_	_
partially	_	_
supported	_	_
by	_	_
the	_	_
POR	_	_
FESR	_	_
2014-2020	_	_
Work	_	_
Program	_	_
(	_	_
Action	_	_
1.1.4	_	_
,	_	_
project	_	_
No.10066183	_	_
)	_	_
.	_	_