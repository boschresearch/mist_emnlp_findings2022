#0
A	_	_
Weakly	_	_
Supervised	_	_
Adaptive	_	_
DenseNet	_	_
for	_	_
Classifying	_	_
Thoracic	_	_
Diseases	_	_
and	_	_
Identifying	_	_
Abnormalities	_	_
Bo	_	_
Zhou	_	_
School	_	_
of	_	_
Computer	_	_
Science	_	_
Carnegie	_	_
Mellon	_	_
University	_	_
Pittsburgh	_	_
,	_	_
PA	_	_
,	_	_
USA	_	_
Yuemeng	_	_
Li	_	_
Department	_	_
of	_	_
Bioengineering	_	_
University	_	_
of	_	_
Pennsylvania	_	_
Philadelphia	_	_
,	_	_
PA	_	_
,	_	_
USA	_	_
Jiangcong	_	_
Wang	_	_
Department	_	_
of	_	_
Bioengineering	_	_
University	_	_
of	_	_
Pennsylvania	_	_
Philadelphia	_	_
,	_	_
PA	_	_
,	_	_
USA	_	_

#1
Abstract	_	_

#2
We	_	_
present	_	_
a	_	_
weakly	_	_
supervised	_	_
deep	_	_
learning	_	_
model	_	_
for	_	_
classifying	_	_
thoracic	_	_
diseases	_	_
and	_	_
identifying	_	_
abnormalities	_	_
in	_	_
chest	_	_
radiography	_	_
.	_	_

#3
In	_	_
this	_	_
work	_	_
,	_	_
instead	_	_
of	_	_
learning	_	_
from	_	_
medical	_	_
imaging	_	_
data	_	_
with	_	_
region-level	_	_
annotations	_	_
,	_	_
our	_	_
model	_	_
was	_	_
merely	_	_
trained	_	_
on	_	_
imaging	_	_
data	_	_
with	_	_
image-level	_	_
labels	_	_
to	_	_
classify	_	_
diseases	_	_
,	_	_
and	_	_
is	_	_
able	_	_
to	_	_
identify	_	_
abnormal	_	_
image	_	_
regions	_	_
simultaneously	_	_
.	_	_

#4
Our	_	_
model	_	_
consists	_	_
of	_	_
a	_	_
customized	_	_
pooling	_	_
structure	_	_
and	_	_
an	_	_
adaptive	_	_
DenseNet	_	_
front-end	_	_
,	_	_
which	_	_
can	_	_
effectively	_	_
recognize	_	_
possible	_	_
disease	_	_
features	_	_
for	_	_
classification	_	_
and	_	_
localization	_	_
tasks	_	_
.	_	_

#5
Our	_	_
method	_	_
has	_	_
been	_	_
validated	_	_
on	_	_
the	_	_
publicly	_	_
available	_	_
ChestX-ray14	_	_
dataset	_	_
.	_	_

#6
Experimental	_	_
results	_	_
have	_	_
demonstrated	_	_
that	_	_
our	_	_
classification	_	_
and	_	_
localization	_	_
prediction	_	_
performance	_	_
achieved	_	_
significant	_	_
improvement	_	_
over	_	_
the	_	_
previous	_	_
models	_	_
on	_	_
the	_	_
ChestX-ray14	_	_
dataset	_	_
.	_	_

#7
In	_	_
summary	_	_
,	_	_
our	_	_
network	_	_
can	_	_
produce	_	_
accurate	_	_
disease	_	_
classification	_	_
and	_	_
localization	_	_
,	_	_
which	_	_
can	_	_
potentially	_	_
support	_	_
clinical	_	_
decisions	_	_
.	_	_

#8
1	_	_
.	_	_

#9
Introduction	_	_
Large	_	_
scale	_	_
annotated	_	_
visual	_	_
datasets	_	_
have	_	_
boosted	_	_
performance	_	_
of	_	_
deep	_	_
learning	_	_
methods	_	_
on	_	_
many	_	_
challenging	_	_
computer	_	_
vision	_	_
problems	_	_
[	_	_
1	_	_
,	_	_
2	_	_
,	_	_
3	_	_
]	_	_
.	_	_

#10
Tasks	_	_
like	_	_
object	_	_
detection	_	_
,	_	_
classification	_	_
,	_	_
tracking	_	_
,	_	_
and	_	_
segmentation	_	_
have	_	_
been	_	_
successfully	_	_
tackled	_	_
by	_	_
techniques	_	_
built	_	_
on	_	_
top	_	_
of	_	_
these	_	_
large-scale	_	_
dataset	_	_
with	_	_
annotations	_	_
[	_	_
4	_	_
,	_	_
5	_	_
,	_	_
6	_	_
]	_	_
.	_	_

#11
There	_	_
are	_	_
increasing	_	_
numbers	_	_
of	_	_
applications	_	_
utilizing	_	_
deep	_	_
learning	_	_
methods	_	_
in	_	_
medical	_	_
imaging	_	_
analysis	_	_
over	_	_
the	_	_
last	_	_
decade	_	_
[	_	_
7	_	_
]	_	_
.	_	_

#12
In	_	_
clinical	_	_
procedures	_	_
,	_	_
visual	_	_
evidence	_	_
such	_	_
as	_	_
segmentation	_	_
or	_	_
spatial	_	_
localization	_	_
of	_	_
abnormal	_	_
regions	_	_
that	_	_
supports	_	_
the	_	_
diagnosis	_	_
results	_	_
,	_	_
is	_	_
an	_	_
vital	_	_
part	_	_
of	_	_
clinical	_	_
diagnosis	_	_
.	_	_

#13
This	_	_
provides	_	_
a	_	_
comprehensive	_	_
interpretation	_	_
of	_	_
diagnosis	_	_
results	_	_
and	_	_
potentially	_	_
decreases	_	_
the	_	_
false	_	_
positive	_	_
rate	_	_
.	_	_

#14
In	_	_
this	_	_
work	_	_
,	_	_
we	_	_
focus	_	_
on	_	_
the	_	_
automatic	_	_
disease	_	_
diagnosis	_	_
and	_	_
localization	_	_
in	_	_
chest	_	_
radiography	_	_
released	_	_
by	_	_
[	_	_
8	_	_
]	_	_
named	_	_
ChestX-ray	_	_
14	_	_
,	_	_
which	_	_
is	_	_
one	_	_
of	_	_
the	_	_
largest	_	_
public	_	_
chest	_	_
radiography	_	_
dataset	_	_
with	_	_
image-level	_	_
disease	_	_
labels	_	_
and	_	_
contains	_	_
a	_	_
small	_	_
subset	_	_
of	_	_
region-level	_	_
disease	_	_
localizations	_	_
(	_	_
bounding	_	_
boxes	_	_
)	_	_
.	_	_

#15
Our	_	_
goal	_	_
is	_	_
to	_	_
develop	_	_
a	_	_
deep	_	_
learning	_	_
scheme	_	_
capable	_	_
of	_	_
both	_	_
classifying	_	_
the	_	_
disease	_	_
and	_	_
localizing	_	_
the	_	_
associated	_	_
lesion	_	_
sites	_	_
.	_	_

#16
Divergent	_	_
from	_	_
standard	_	_
strongly	_	_
supervised	_	_
object	_	_
detection	_	_
,	_	_
our	_	_
model	_	_
does	_	_
not	_	_
require	_	_
ground	_	_
truth	_	_
localization	_	_
annotations	_	_
during	_	_
training	_	_
.	_	_

#17
Firstly	_	_
,	_	_
we	_	_
adopted	_	_
and	_	_
modified	_	_
a	_	_
pre-trained	_	_
classification	_	_
CNN	_	_
as	_	_
our	_	_
front-end	_	_
feature	_	_
extractor	_	_
[	_	_
9	_	_
]	_	_
.	_	_

#18
The	_	_
pre-trained	_	_
front-end	_	_
encodes	_	_
the	_	_
information	_	_
from	_	_
a	_	_
large	_	_
perceptive	_	_
field	_	_
.	_	_

#19
Then	_	_
,	_	_
after	_	_
passing	_	_
through	_	_
a	_	_
simple	_	_
bridging	_	_
structure	_	_
,	_	_
the	_	_
extracted	_	_
feature	_	_
from	_	_
the	_	_
front-end	_	_
are	_	_
fed	_	_
into	_	_
a	_	_
customized	_	_
two-stage	_	_
pooling	_	_
network	_	_
structure	_	_
,	_	_
which	_	_
produces	_	_
both	_	_
classification	_	_
and	_	_
associated	_	_
localization	_	_
simultaneously	_	_
.	_	_

#20
Both	_	_
quantitative	_	_
and	_	_
qualitative	_	_
visual	_	_
evaluations	_	_
show	_	_
that	_	_
our	_	_
proposed	_	_
model	_	_
obtains	_	_
significant	_	_
improvement	_	_
over	_	_
the	_	_
previous	_	_
published	_	_
state-of-the-art	_	_
results	_	_
on	_	_
disease	_	_
classification	_	_
and	_	_
localization	_	_
.	_	_

#21
Visual	_	_
evaluations	_	_
indicate	_	_
a	_	_
strong	_	_
alignment	_	_
and	_	_
correspondence	_	_
between	_	_
the	_	_
clinical	_	_
annotations	_	_
and	_	_
the	_	_
predicted	_	_
disease	_	_
candidate	_	_
regions	_	_
shown	_	_
in	_	_
figure	_	_
1	_	_
.	_	_

#22
Contributions	_	_
:	_	_
The	_	_
contributions	_	_
of	_	_
this	_	_
work	_	_
are	_	_
twofolds	_	_
.	_	_

#23
First	_	_
,	_	_
we	_	_
developed	_	_
a	_	_
weakly	_	_
supervised	_	_
end-to-end	_	_
learning	_	_
structure	_	_
that	_	_
learns	_	_
from	_	_
chest	_	_
radiography	_	_
images	_	_
containing	_	_
multiple	_	_
common	_	_
thoracic	_	_
diseases	_	_
by	_	_
explicitly	_	_
searching	_	_
over	_	_
possible	_	_
disease	_	_
features	_	_
and	_	_
locations	_	_
in	_	_
the	_	_
image	_	_
.	_	_

#24
Second	_	_
,	_	_
we	_	_
performed	_	_
extensive	_	_
experimental	_	_
analysis	_	_
of	_	_
our	_	_
model	_	_
on	_	_
the	_	_
large-scale	_	_
ChestX-ray14	_	_
datasets	_	_
.	_	_

#25
With	_	_
the	_	_
optimal	_	_
parameter	_	_
settings	_	_
found	_	_
from	_	_
our	_	_
analysis	_	_
,	_	_
we	_	_
observed	_	_
that	_	_
our	_	_
model	_	_
(	_	_
i	_	_
)	_	_
can	_	_
predict	_	_
accurate	_	_
thoracic	_	_
disease	_	_
classifications	_	_
(	_	_
ii	_	_
)	_	_
output	_	_
better	_	_
approximate	_	_
disease	_	_
locations	_	_
than	_	_
previous	_	_
methods	_	_
with	_	_
only	_	_
image-level	_	_
labels	_	_
available	_	_
.	_	_

#26
ar	_	_
X	_	_
iv	_	_
:1	_	_
7	_	_
.	_	_

#27
7v	_	_
2	_	_
[	_	_
cs	_	_
.C	_	_
V	_	_
]	_	_
5	_	_
N	_	_
ov	_	_
2	_	_
Cardiomegaly	_	_
Effusion	_	_
Infiltrate	_	_
Mass	_	_
Nodule	_	_
Pneumonia	_	_
PneumothoraxAtelectasis	_	_
Figure	_	_
1	_	_
.	_	_

#28
Examples	_	_
of	_	_
the	_	_
disease	_	_
localizations	_	_
generated	_	_
from	_	_
our	_	_
network	_	_
.	_	_

#29
The	_	_
localization	_	_
output	_	_
from	_	_
our	_	_
network	_	_
(	_	_
red	_	_
bounding	_	_
box	_	_
)	_	_
,	_	_
that	_	_
trained	_	_
only	_	_
with	_	_
image-level	_	_
annotation	_	_
,	_	_
match	_	_
with	_	_
the	_	_
ground	_	_
truth	_	_
localization	_	_
(	_	_
green	_	_
bounding	_	_
box	_	_
)	_	_
.	_	_

#30
2	_	_
.	_	_

#31
Related	_	_
Work	_	_
CAD	_	_
for	_	_
chest	_	_
radiography	_	_
:	_	_
The	_	_
chest	_	_
radiography	_	_
is	_	_
the	_	_
most	_	_
ordered	_	_
and	_	_
common	_	_
radiological	_	_
examination	_	_
for	_	_
chest	_	_
diseases	_	_
.	_	_

#32
It	_	_
is	_	_
a	_	_
low-cost	_	_
,	_	_
low	_	_
radiation	_	_
and	_	_
fast	_	_
imaging	_	_
exam	_	_
.	_	_

#33
Recent	_	_
studies	_	_
also	_	_
demonstrated	_	_
the	_	_
chest	_	_
radiography’s	_	_
application	_	_
on	_	_
detection	_	_
and	_	_
evaluation	_	_
of	_	_
coronary	_	_
artery	_	_
diseases	_	_
,	_	_
which	_	_
are	_	_
usually	_	_
evaluated	_	_
using	_	_
Computed	_	_
Tomography	_	_
(	_	_
CT	_	_
)	_	_
with	_	_
expensive	_	_
cost	_	_
and	_	_
high	_	_
radiation	_	_
dose	_	_
[	_	_
10	_	_
,	_	_
11	_	_
,	_	_
12	_	_
]	_	_
.	_	_

#34
CAD	_	_
techniques	_	_
have	_	_
been	_	_
widely	_	_
applied	_	_
in	_	_
chest	_	_
radiography	_	_
for	_	_
task	_	_
such	_	_
as	_	_
automatic	_	_
diagnosis	_	_
and	_	_
patient	_	_
image	_	_
retrieval	_	_
.	_	_

#35
Previously	_	_
,	_	_
Bar	_	_
et	_	_
al.	_	_
adapted	_	_
the	_	_
Decaf-Net	_	_
for	_	_
8	_	_
thoracic	_	_
diseases	_	_
classification	_	_
on	_	_
a	_	_
relatively	_	_
small	_	_
chest	_	_
x-ray	_	_
dataset	_	_
[	_	_
13	_	_
]	_	_
.	_	_

#36
Lajhani	_	_
et	_	_
al.	_	_
proposed	_	_
the	_	_
DCNN	_	_
for	_	_
tuberculosis	_	_
classification	_	_
task	_	_
.	_	_

#37
Their	_	_
model	_	_
ensembled	_	_
both	_	_
Alex-Net	_	_
and	_	_
Google-Net	_	_
and	_	_
achieved	_	_
impressive	_	_
results	_	_
[	_	_
14	_	_
]	_	_
.	_	_

#38
Anavi	_	_
et	_	_
al.	_	_
has	_	_
worked	_	_
on	_	_
image	_	_
retrieval	_	_
in	_	_
medicine	_	_
,	_	_
specifically	_	_
for	_	_
chest	_	_
radiography	_	_
given	_	_
the	_	_
pathology	_	_
[	_	_
15	_	_
]	_	_
.	_	_

#39
All	_	_
the	_	_
aforementioned	_	_
research	_	_
showed	_	_
promising	_	_
results	_	_
.	_	_

#40
However	_	_
,	_	_
they	_	_
only	_	_
conducted	_	_
their	_	_
experiments	_	_
on	_	_
relatively	_	_
small	_	_
dataset	_	_
,	_	_
ranging	_	_
from	_	_
10	_	_
to	_	_
500	_	_
images	_	_
.	_	_

#41
ChestX-ray14	_	_
:	_	_
Recently	_	_
,	_	_
National	_	_
Institute	_	_
of	_	_
Health	_	_
(	_	_
NIH	_	_
)	_	_
released	_	_
one	_	_
of	_	_
the	_	_
largest	_	_
public	_	_
chest	_	_
radiography	_	_
dataset	_	_
,	_	_
consisting	_	_
of	_	_
108,948	_	_
posterior-anterior	_	_
view	_	_
images	_	_
from	_	_
32,797	_	_
patients	_	_
with	_	_
eight	_	_
major	_	_
chest	_	_
diseases	_	_
[	_	_
8	_	_
]	_	_
.	_	_

#42
A	_	_
small	_	_
subset	_	_
of	_	_
this	_	_
dataset	_	_
is	_	_
provided	_	_
with	_	_
hand	_	_
labeled	_	_
bounding	_	_
boxes	_	_
for	_	_
evaluation	_	_
.	_	_

#43
Lately	_	_
,	_	_
NIH	_	_
further	_	_
expanded	_	_
this	_	_
dataset	_	_
to	_	_
112,120	_	_
frontal-view	_	_
images	_	_
with	_	_
6	_	_
additional	_	_
thoracic	_	_
diseases	_	_
,	_	_
named	_	_
ChestX-ray14	_	_
.	_	_

#44
Several	_	_
deep	_	_
learning	_	_
methods	_	_
have	_	_
been	_	_
addressed	_	_
the	_	_
application	_	_
of	_	_
CNN	_	_
on	_	_
this	_	_
dataset	_	_
for	_	_
thoracic	_	_
disease	_	_
classification	_	_
and	_	_
localization	_	_
[	_	_
16	_	_
,	_	_
17	_	_
,	_	_
18	_	_
]	_	_
.	_	_

#45
Wang	_	_
et	_	_
al.	_	_
[	_	_
8	_	_
]	_	_
applied	_	_
a	_	_
pre-trained	_	_
Res-Net	_	_
as	_	_
the	_	_
backbone	_	_
to	_	_
generate	_	_
heatmap	_	_
as	_	_
localization	_	_
,	_	_
and	_	_
subsequently	_	_
used	_	_
a	_	_
global	_	_
maxpooling	_	_
to	_	_
obtain	_	_
classification	_	_
.	_	_

#46
However	_	_
,	_	_
most	_	_
of	_	_
the	_	_
localizations	_	_
generated	_	_
by	_	_
their	_	_
network	_	_
mismatched	_	_
with	_	_
the	_	_
ground-truth	_	_
bounding	_	_
boxes	_	_
due	_	_
to	_	_
only	_	_
limited	_	_
extracted	_	_
feature	_	_
is	_	_
used	_	_
.	_	_

#47
Yao	_	_
et	_	_
al.	_	_
[	_	_
16	_	_
]	_	_
used	_	_
DenseNet	_	_
[	_	_
9	_	_
]	_	_
to	_	_
extract	_	_
features	_	_
.	_	_

#48
To	_	_
harness	_	_
the	_	_
correlation	_	_
between	_	_
some	_	_
of	_	_
the	_	_
diseases	_	_
,	_	_
they	_	_
used	_	_
a	_	_
LSTM	_	_
module	_	_
to	_	_
repeatedly	_	_
decode	_	_
the	_	_
feature	_	_
vector	_	_
from	_	_
a	_	_
DenseNet	_	_
[	_	_
9	_	_
]	_	_
front	_	_
end	_	_
and	_	_
produced	_	_
one	_	_
disease	_	_
prediction	_	_
at	_	_
each	_	_
step	_	_
.	_	_

#49
They	_	_
achieved	_	_
improved	_	_
results	_	_
compared	_	_
to	_	_
the	_	_
baseline	_	_
in	_	_
[	_	_
8	_	_
]	_	_
.	_	_

#50
One	_	_
of	_	_
the	_	_
most	_	_
recent	_	_
work	_	_
from	_	_
Rajpurkar	_	_
et	_	_
al.	_	_
achieved	_	_
a	_	_
good	_	_
multi-label	_	_
classification	_	_
results	_	_
by	_	_
fine-tuning	_	_
a	_	_
pre-trained	_	_
DenseNet-121	_	_
[	_	_
9	_	_
,	_	_
18	_	_
]	_	_
.	_	_

#51
Their	_	_
classification	_	_
results	_	_
outperformed	_	_
the	_	_
previous	_	_
methods	_	_
[	_	_
8	_	_
,	_	_
16	_	_
,	_	_
17	_	_
]	_	_
.	_	_

#52
However	_	_
,	_	_
there	_	_
is	_	_
no	_	_
localization	_	_
component	_	_
and	_	_
weakly	_	_
supervision	_	_
in	_	_
their	_	_
work	_	_
.	_	_

#53
Another	_	_
most	_	_
recent	_	_
work	_	_
from	_	_
Li	_	_
et	_	_
al.	_	_
[	_	_
17	_	_
]	_	_
used	_	_
a	_	_
pre-trained	_	_
Res-Net	_	_
to	_	_
extract	_	_
features	_	_
and	_	_
divided	_	_
them	_	_
into	_	_
patches	_	_
.	_	_

#54
They	_	_
passed	_	_
the	_	_
extracted	_	_
patches	_	_
through	_	_
a	_	_
fully-convolutional	_	_
classification	_	_
CNN	_	_
to	_	_
obtain	_	_
a	_	_
disease	_	_
probability	_	_
map	_	_
which	_	_
is	_	_
supervised	_	_
by	_	_
both	_	_
image-level	_	_
annotations	_	_
and	_	_
limited	_	_
pixel-level	_	_
annotations	_	_
.	_	_

#55
In	_	_
the	_	_
mean	_	_
time	_	_
,	_	_
a	_	_
classification	_	_
score	_	_
was	_	_
acquired	_	_
by	_	_
multiplying	_	_
all	_	_
probability	_	_
values	_	_
together	_	_
.	_	_

#56
They	_	_
achieved	_	_
significantly	_	_
better	_	_
localization	_	_
results	_	_
as	_	_
compared	_	_
to	_	_
the	_	_
baseline	_	_
[	_	_
8	_	_
]	_	_
for	_	_
certain	_	_
diseases	_	_
.	_	_

#57
But	_	_
this	_	_
approach	_	_
requires	_	_
certain	_	_
amount	_	_
of	_	_
bounding	_	_
box	_	_
training	_	_
data	_	_
for	_	_
improving	_	_
their	_	_
model	_	_
performance	_	_
.	_	_

#58
Weakly	_	_
supervised	_	_
learning	_	_
:	_	_
The	_	_
ChestX-ray14	_	_
dataset	_	_
[	_	_
8	_	_
]	_	_
contains	_	_
mostly	_	_
classification	_	_
labels	_	_
but	_	_
few	_	_
bounding	_	_
boxes	_	_
annotations	_	_
.	_	_

#59
Therefore	_	_
,	_	_
we	_	_
seek	_	_
a	_	_
model	_	_
that	_	_
is	_	_
capable	_	_
of	_	_
localizing	_	_
the	_	_
diseased	_	_
regions	_	_
given	_	_
only	_	_
image	_	_
wise	_	_
labels	_	_
.	_	_

#60
This	_	_
falls	_	_
into	_	_
category	_	_
of	_	_
weakly	_	_
supervise	_	_
learning	_	_
(	_	_
WSL	_	_
)	_	_
,	_	_
which	_	_
often	_	_
refers	_	_
as	_	_
the	_	_
task	_	_
of	_	_
capturing	_	_
object	_	_
location	_	_
through	_	_
a	_	_
customized	_	_
deep	_	_
learning	_	_
model	_	_
that	_	_
trained	_	_
with	_	_
only	_	_
image-level	_	_
labels	_	_
.	_	_

#61
Oquab	_	_
et	_	_
al.	_	_
[	_	_
19	_	_
]	_	_
proposed	_	_
a	_	_
WSL	_	_
scheme	_	_
.	_	_

#62
They	_	_
used	_	_
a	_	_
pre-trained	_	_
CNN	_	_
to	_	_
generate	_	_
class	_	_
probability	_	_
map	_	_
across	_	_
spatial	_	_
locations	_	_
and	_	_
applied	_	_
max-pooling	_	_
across	_	_
spatial	_	_
locations	_	_
to	_	_
get	_	_
a	_	_
single	_	_
binary	_	_
score	_	_
vector	_	_
.	_	_

#63
With	_	_
their	_	_
strategy	_	_
,	_	_
they	_	_
were	_	_
able	_	_
to	_	_
get	_	_
both	_	_
decent	_	_
classification	_	_
accuracy	_	_
and	_	_
localization	_	_
mAP	_	_
on	_	_
the	_	_
benchmark	_	_
dataset	_	_
[	_	_
20	_	_
,	_	_
3	_	_
]	_	_
.	_	_

#64
Recently	_	_
,	_	_
Durand	_	_
et	_	_
al.	_	_
proposed	_	_
a	_	_
more	_	_
sophisticated	_	_
WSL	_	_
approach	_	_
Dense	_	_
blockImage	_	_
bn	_	_
relu	_	_
conv	_	_
average	_	_
pool	_	_
Transition	_	_
block	_	_
conv-max	_	_
pool	_	_
Dense	_	_
block	_	_
Modified	_	_
transition	_	_
block	_	_
Dilated	_	_
Dense	_	_
block	_	_
DenseNet	_	_
Features	_	_
224x224	_	_
56x56	_	_
28x28	_	_
14x14	_	_
14x14	_	_
Convolution	_	_
Max	_	_
pool	_	_
conv-bn-relu	_	_
Conv-bn-relu	_	_
with	_	_
dense	_	_
connection	_	_
…	_	_
...	_	_
(	_	_
a	_	_
)	_	_
(	_	_
b	_	_
)	_	_
3x3	_	_
kernel	_	_
Dilated	_	_
3x3	_	_
kernel	_	_
(	_	_
c	_	_
)	_	_
Transition	_	_
block	_	_
Dense	_	_
block	_	_
bn	_	_
relu	_	_
conv	_	_
Figure	_	_
2	_	_
.	_	_

#65
The	_	_
architecture	_	_
of	_	_
the	_	_
adaptive	_	_
densenet-169	_	_
is	_	_
shown	_	_
above	_	_
.	_	_

#66
The	_	_
network	_	_
receives	_	_
input	_	_
of	_	_
size	_	_
224	_	_
×	_	_
224	_	_
,	_	_
passes	_	_
it	_	_
through	_	_
a	_	_
convolution	_	_
and	_	_
max	_	_
pool	_	_
layer	_	_
,	_	_
and	_	_
then	_	_
4	_	_
dense	_	_
blocks	_	_
interleaved	_	_
with	_	_
3	_	_
transition	_	_
blocks	_	_
,	_	_
and	_	_
produces	_	_
14	_	_
×	_	_
14	_	_
feature	_	_
maps	_	_
.	_	_

#67
(	_	_
a	_	_
)	_	_
illustrates	_	_
the	_	_
dense	_	_
connection	_	_
in	_	_
dense	_	_
block	_	_
,	_	_
where	_	_
output	_	_
from	_	_
each	_	_
conv-bn-relu	_	_
layer	_	_
is	_	_
concatenated	_	_
to	_	_
the	_	_
input	_	_
before	_	_
fed	_	_
to	_	_
the	_	_
next	_	_
layer	_	_
.	_	_

#68
(	_	_
b	_	_
)	_	_
shows	_	_
the	_	_
average	_	_
pool	_	_
layer	_	_
is	_	_
taken	_	_
out	_	_
in	_	_
the	_	_
modified	_	_
transition	_	_
block	_	_
,	_	_
so	_	_
that	_	_
it	_	_
maintains	_	_
same	_	_
spatial	_	_
resolution	_	_
as	_	_
previous	_	_
dense	_	_
block’s	_	_
.	_	_

#69
(	_	_
c	_	_
)	_	_
illustrates	_	_
the	_	_
kernel	_	_
dilation	_	_
in	_	_
dilated	_	_
dense	_	_
block	_	_
.	_	_

#70
Pre-trained	_	_
convolution	_	_
kernels	_	_
in	_	_
the	_	_
last	_	_
dense	_	_
block	_	_
were	_	_
dilated	_	_
to	_	_
keep	_	_
the	_	_
receptive	_	_
field	_	_
unchanged	_	_
,	_	_
after	_	_
an	_	_
average	_	_
pool	_	_
layer	_	_
is	_	_
removed	_	_
in	_	_
(	_	_
b	_	_
)	_	_
.	_	_

#71
[	_	_
21	_	_
]	_	_
.	_	_

#72
They	_	_
presented	_	_
the	_	_
idea	_	_
of	_	_
class	_	_
pooling	_	_
based	_	_
on	_	_
the	_	_
assumption	_	_
that	_	_
an	_	_
object	_	_
inherently	_	_
can	_	_
be	_	_
decomposed	_	_
into	_	_
different	_	_
sub-maps	_	_
to	_	_
capture	_	_
better	_	_
semantic	_	_
segmentation	_	_
in	_	_
WSL	_	_
.	_	_

#73
Their	_	_
experimental	_	_
results	_	_
tested	_	_
on	_	_
PASCAL	_	_
2007	_	_
,	_	_
PASCAL	_	_
2012	_	_
,	_	_
MS	_	_
COCO	_	_
,	_	_
15	_	_
Scene	_	_
,	_	_
MIT67	_	_
[	_	_
22	_	_
,	_	_
20	_	_
,	_	_
3	_	_
,	_	_
23	_	_
,	_	_
24	_	_
]	_	_
indicated	_	_
the	_	_
advantage	_	_
of	_	_
such	_	_
design	_	_
and	_	_
achieve	_	_
significant	_	_
improvement	_	_
over	_	_
[	_	_
19	_	_
]	_	_
’s	_	_
model	_	_
.	_	_

#74
3	_	_
.	_	_

#75
Method	_	_
In	_	_
this	_	_
work	_	_
,	_	_
we	_	_
aim	_	_
to	_	_
use	_	_
chest	_	_
radiographs	_	_
as	_	_
input	_	_
with	_	_
only	_	_
image-wise	_	_
labels	_	_
to	_	_
train	_	_
a	_	_
model	_	_
that	_	_
generates	_	_
classification	_	_
for	_	_
thoracic	_	_
disease	_	_
along	_	_
with	_	_
the	_	_
localization	_	_
heatmaps	_	_
.	_	_

#76
The	_	_
architecture	_	_
of	_	_
our	_	_
proposed	_	_
network	_	_
can	_	_
be	_	_
summarized	_	_
into	_	_
three	_	_
parts	_	_
:	_	_
1	_	_
)	_	_
using	_	_
an	_	_
Adaptive	_	_
DenseNet	_	_
to	_	_
generate	_	_
feature	_	_
maps	_	_
and	_	_
2	_	_
)	_	_
using	_	_
a	_	_
bridging	_	_
layer	_	_
to	_	_
convert	_	_
the	_	_
feature	_	_
maps	_	_
into	_	_
class-specific	_	_
sub-maps	_	_
3	_	_
)	_	_
using	_	_
a	_	_
WSL	_	_
pooling	_	_
structure	_	_
to	_	_
pool	_	_
the	_	_
sub-maps	_	_
into	_	_
class-specific	_	_
heatmaps	_	_
and	_	_
single	_	_
probability	_	_
score	_	_
for	_	_
each	_	_
disease	_	_
.	_	_

#77
3.1	_	_
.	_	_

#78
Adaptive	_	_
DenseNet	_	_
The	_	_
Adaptive	_	_
DenseNet	_	_
inherits	_	_
the	_	_
basic	_	_
structure	_	_
from	_	_
DenseNet	_	_
[	_	_
9	_	_
]	_	_
.	_	_

#79
The	_	_
dense	_	_
block	_	_
of	_	_
DenseNet	_	_
consists	_	_
of	_	_
direct	_	_
connections	_	_
from	_	_
preceding	_	_
layers	_	_
to	_	_
all	_	_
subsequent	_	_
layers	_	_
which	_	_
pass	_	_
image	_	_
information	_	_
in	_	_
deep	_	_
model’s	_	_
training	_	_
.	_	_

#80
We	_	_
maintained	_	_
the	_	_
DenseNet	_	_
structures	_	_
before	_	_
the	_	_
fully	_	_
connected	_	_
classification	_	_
layers	_	_
as	_	_
our	_	_
basic	_	_
structure	_	_
.	_	_

#81
However	_	_
,	_	_
the	_	_
output	_	_
feature	_	_
map	_	_
size	_	_
after	_	_
the	_	_
final	_	_
dense	_	_
block	_	_
is	_	_
greatly	_	_
decreased	_	_
(	_	_
7	_	_
×	_	_
7	_	_
)	_	_
,	_	_
losing	_	_
too	_	_
much	_	_
spatial	_	_
resolution	_	_
as	_	_
compared	_	_
to	_	_
the	_	_
input	_	_
image	_	_
(	_	_
224	_	_
×	_	_
224	_	_
)	_	_
,	_	_
which	_	_
is	_	_
not	_	_
suitable	_	_
for	_	_
our	_	_
localization	_	_
task	_	_
.	_	_

#82
To	_	_
overcome	_	_
this	_	_
,	_	_
firstly	_	_
,	_	_
we	_	_
took	_	_
out	_	_
the	_	_
average	_	_
pooling	_	_
operation	_	_
at	_	_
the	_	_
third	_	_
transition	_	_
layer	_	_
to	_	_
achieve	_	_
a	_	_
fine	_	_
resolution	_	_
.	_	_

#83
Secondly	_	_
,	_	_
in	_	_
order	_	_
to	_	_
maintain	_	_
the	_	_
same	_	_
receptive	_	_
field	_	_
of	_	_
each	_	_
convolution	_	_
kernel	_	_
,	_	_
we	_	_
dilated	_	_
all	_	_
kernels	_	_
in	_	_
the	_	_
fourth	_	_
dense	_	_
block	_	_
.	_	_

#84
The	_	_
Adaptive	_	_
DenseNet	_	_
outputs	_	_
a	_	_
feature	_	_
map	_	_
with	_	_
spatial	_	_
size	_	_
of	_	_
14	_	_
×	_	_
14	_	_
.	_	_

#85
Details	_	_
of	_	_
our	_	_
Adaptive	_	_
Densenet	_	_
is	_	_
shown	_	_
in	_	_
Figure	_	_
2	_	_
.	_	_

#86
In	_	_
this	_	_
work	_	_
,	_	_
we	_	_
chose	_	_
the	_	_
DenseNet-169	_	_
as	_	_
our	_	_
basic	_	_
structure	_	_
.	_	_

#87
Our	_	_
adaptation	_	_
can	_	_
be	_	_
applied	_	_
to	_	_
other	_	_
DenseNet	_	_
structures	_	_
as	_	_
well	_	_
,	_	_
such	_	_
as	_	_
DenseNet-121	_	_
and	_	_
Densenet-201	_	_
.	_	_

#88
With	_	_
the	_	_
Adaptive	_	_
DenseNet	_	_
,	_	_
we	_	_
were	_	_
able	_	_
to	_	_
acquire	_	_
a	_	_
fine	_	_
resolution	_	_
feature	_	_
map	_	_
.	_	_

#89
H	_	_
W	_	_
1664	_	_
M	_	_
MxC	_	_
H	_	_
W	_	_
1x1	_	_
conv	_	_
Output	_	_
from	_	_
Adaptive	_	_
Densenet	_	_
Bridging	_	_
Layer	_	_
Output	_	_
for	_	_
WSL	_	_
Pooling	_	_
Figure	_	_
3	_	_
.	_	_

#90
Bridging	_	_
layer	_	_
connects	_	_
the	_	_
output	_	_
of	_	_
Adaptive	_	_
DenseNet	_	_
and	_	_
WSL	_	_
pooling	_	_
.	_	_

#91
Given	_	_
the	_	_
Adaptive	_	_
DenseNet	_	_
output	_	_
feature	_	_
,	_	_
the	_	_
bridging	_	_
layer	_	_
performs	_	_
a	_	_
1x1	_	_
convolution	_	_
to	_	_
transform	_	_
the	_	_
output	_	_
feature	_	_
into	_	_
sub-maps	_	_
.	_	_

#92
The	_	_
output	_	_
channels	_	_
of	_	_
sub-maps	_	_
are	_	_
M	_	_
×	_	_
C	_	_
,	_	_
where	_	_
M	_	_
being	_	_
number	_	_
of	_	_
sub-maps	_	_
per	_	_
class	_	_
and	_	_
C	_	_
being	_	_
number	_	_
of	_	_
class	_	_
.	_	_

#93
The	_	_
sub-maps	_	_
fed	_	_
into	_	_
the	_	_
WSL	_	_
pooling	_	_
layers	_	_
.	_	_

#94
...	_	_
...	_	_
...	_	_
sub-map	_	_
D	_	_
is	_	_
ea	_	_
se	_	_
#	_	_
Average	_	_
Pooling	_	_
Localization	_	_
Classification	_	_
D	_	_
is	_	_
ea	_	_
se	_	_
#	_	_
C	_	_
Average	_	_
Pooling	_	_
...	_	_
Class-pooling	_	_
Spatial-pooling	_	_
Network	_	_
output	_	_
*training	_	_
phase	_	_
*testing	_	_
phase	_	_
heatmap	_	_
class-wise	_	_
pooling	_	_
topk	_	_
random	_	_
pooling	_	_
spatial-wise	_	_
pooling	_	_
class	_	_
score	_	_
M	_	_
Spatial	_	_
pooling	_	_
in	_	_
testing	_	_
phase	_	_
top	_	_
k+	_	_
top	_	_
k-	_	_
Dc+	_	_
D	_	_
c	_	_
-	_	_
+α	_	_
Dc	_	_
Dc+	_	_
top	_	_
k+	_	_
random	_	_
Dc	_	_
Spatial	_	_
pooling	_	_
in	_	_
training	_	_
phase	_	_
HxWxM*C	_	_
sub-maps	_	_
HxWxC	_	_
1x1xC	_	_
Classification	_	_
1x1xC	_	_
1x1x1	_	_
1x1x1	_	_
HxWx1	_	_
HxWx1	_	_
HxWxM*1	_	_
HxWxM*1	_	_
Figure	_	_
4	_	_
.	_	_

#95
Illustration	_	_
of	_	_
our	_	_
2-stage	_	_
pooling	_	_
process	_	_
:	_	_
class-wise	_	_
pooling	_	_
and	_	_
spatial	_	_
pooling	_	_
.	_	_

#96
During	_	_
class-wise	_	_
pooling	_	_
(	_	_
green	_	_
region	_	_
)	_	_
,	_	_
multiple	_	_
class-specific	_	_
sub-maps	_	_
are	_	_
averaged	_	_
and	_	_
a	_	_
single	_	_
heatmap	_	_
is	_	_
generated	_	_
for	_	_
each	_	_
class	_	_
.	_	_

#97
Each	_	_
classes’	_	_
heatmap	_	_
are	_	_
used	_	_
for	_	_
their	_	_
localization	_	_
.	_	_

#98
The	_	_
heatmap	_	_
is	_	_
then	_	_
passed	_	_
to	_	_
spatial	_	_
pooling	_	_
.	_	_

#99
We	_	_
employed	_	_
two	_	_
different	_	_
spatial	_	_
pooling	_	_
schemes	_	_
during	_	_
training	_	_
and	_	_
testing	_	_
.	_	_

#100
During	_	_
training	_	_
,	_	_
single	_	_
random	_	_
score	_	_
from	_	_
top	_	_
k+	_	_
scores	_	_
in	_	_
the	_	_
heatmap	_	_
is	_	_
selected	_	_
to	_	_
increase	_	_
robustness	_	_
against	_	_
erroneous	_	_
top	_	_
scores	_	_
.	_	_

#101
During	_	_
testing	_	_
,	_	_
top	_	_
k+	_	_
scores	_	_
and	_	_
bottom	_	_
k−	_	_
scores	_	_
are	_	_
weighted	_	_
averaged	_	_
with	_	_
weight	_	_
on	_	_
bottom	_	_
samples	_	_
to	_	_
give	_	_
maximum	_	_
performance	_	_
.	_	_

#102
The	_	_
final	_	_
output	_	_
of	_	_
spatial	_	_
pooling	_	_
is	_	_
a	_	_
single	_	_
class	_	_
score	_	_
for	_	_
each	_	_
class	_	_
.	_	_

#103
3.2	_	_
.	_	_

#104
Bridging	_	_
layer	_	_
To	_	_
connect	_	_
the	_	_
output	_	_
of	_	_
the	_	_
Adaptive	_	_
DenseNet	_	_
and	_	_
the	_	_
pooling	_	_
structure	_	_
described	_	_
in	_	_
section	_	_
3.3	_	_
,	_	_
a	_	_
bridging	_	_
layer	_	_
is	_	_
proposed	_	_
and	_	_
used	_	_
here	_	_
.	_	_

#105
Specifically	_	_
,	_	_
the	_	_
output	_	_
of	_	_
the	_	_
Adaptive	_	_
DenseNet	_	_
is	_	_
transformed	_	_
by	_	_
a	_	_
1	_	_
×	_	_
1	_	_
convolutional	_	_
layer	_	_
,	_	_
which	_	_
learns	_	_
the	_	_
mapping	_	_
from	_	_
the	_	_
Adaptive	_	_
DenseNet’s	_	_
output	_	_
feature	_	_
maps	_	_
to	_	_
class	_	_
specific	_	_
submaps	_	_
.	_	_

#106
Through	_	_
the	_	_
bridging	_	_
layer	_	_
,	_	_
the	_	_
channel	_	_
size	_	_
of	_	_
the	_	_
feature	_	_
map	_	_
is	_	_
transferred	_	_
from	_	_
1664	_	_
(	_	_
channel	_	_
size	_	_
of	_	_
Adaptive	_	_
DenseNet’s	_	_
output	_	_
)	_	_
to	_	_
M	_	_
×	_	_
C	_	_
,	_	_
as	_	_
shown	_	_
in	_	_
Figure	_	_
3	_	_
.	_	_

#107
This	_	_
bridging	_	_
layer	_	_
connects	_	_
the	_	_
Adaptive	_	_
DenseNet	_	_
and	_	_
the	_	_
WSL	_	_
pooling	_	_
structure	_	_
together	_	_
to	_	_
form	_	_
the	_	_
overall	_	_
network	_	_
.	_	_

#108
3.3	_	_
.	_	_

#109
WSL	_	_
pooling	_	_
To	_	_
obtain	_	_
accurate	_	_
disease	_	_
classification	_	_
along	_	_
with	_	_
disease	_	_
localization	_	_
heatmap	_	_
,	_	_
we	_	_
integrated	_	_
a	_	_
customized	_	_
weakly	_	_
supervised	_	_
learning	_	_
strategy	_	_
into	_	_
our	_	_
network	_	_
.	_	_

#110
Similar	_	_
to	_	_
[	_	_
21	_	_
]	_	_
,	_	_
we	_	_
implemented	_	_
two	_	_
stages	_	_
of	_	_
global	_	_
pooling	_	_
layers	_	_
to	_	_
summarize	_	_
all	_	_
information	_	_
for	_	_
each	_	_
class	_	_
in	_	_
feature	_	_
map	_	_
outputted	_	_
from	_	_
the	_	_
Adaptive	_	_
DenseNet	_	_
,	_	_
which	_	_
include	_	_
:	_	_
1	_	_
)	_	_
a	_	_
class-wise	_	_
pooling	_	_
within	_	_
the	_	_
same	_	_
class	_	_
,	_	_
and	_	_
2	_	_
)	_	_
a	_	_
spatial	_	_
pooling	_	_
along	_	_
different	_	_
classes	_	_
.	_	_

#111
The	_	_
class-wise	_	_
pooling	_	_
summarizes	_	_
submaps	_	_
into	_	_
final	_	_
localization	_	_
heatmap	_	_
,	_	_
and	_	_
the	_	_
spatial-wise	_	_
pooling	_	_
summarizes	_	_
heatmap	_	_
into	_	_
classification	_	_
.	_	_

#112
Details	_	_
of	_	_
the	_	_
pooling	_	_
designs	_	_
are	_	_
demonstrated	_	_
in	_	_
Figure	_	_
4.	_	_
class-wise	_	_
pooling	_	_
:	_	_
The	_	_
class-wise	_	_
pooling	_	_
combines	_	_
the	_	_
M	_	_
submaps	_	_
from	_	_
each	_	_
of	_	_
the	_	_
C	_	_
classes	_	_
from	_	_
the	_	_
bridging	_	_
layer	_	_
.	_	_

#113
In	_	_
specific	_	_
,	_	_
our	_	_
class-wise	_	_
pooling	_	_
combines	_	_
the	_	_
M	_	_
maps	_	_
for	_	_
all	_	_
disease	_	_
classes	_	_
independently	_	_
through	_	_
Equation	_	_
1	_	_
.	_	_

#114
D̄c	_	_
i	_	_
,	_	_
j	_	_
=	_	_
M	_	_
M∑	_	_
m=1	_	_
Dc	_	_
,	_	_
m	_	_
i	_	_
,	_	_
j	_	_
(	_	_
1	_	_
)	_	_
where	_	_
M	_	_
is	_	_
the	_	_
number	_	_
of	_	_
sub-maps	_	_
with	_	_
the	_	_
assumption	_	_
that	_	_
each	_	_
sub-map	_	_
contains	_	_
different	_	_
features	_	_
of	_	_
the	_	_
corresponding	_	_
disease	_	_
.	_	_

#115
Unlike	_	_
traditional	_	_
WSL	_	_
with	_	_
only	_	_
one	_	_
map	_	_
considering	_	_
only	_	_
one	_	_
extracted	_	_
feature	_	_
,	_	_
our	_	_
multiple	_	_
maps	_	_
strategy	_	_
is	_	_
useful	_	_
for	_	_
the	_	_
disease	_	_
classification/localization	_	_
tasks	_	_
by	_	_
utilizing	_	_
multiple	_	_
extracted	_	_
features	_	_
.	_	_

#116
H	_	_
,	_	_
W	_	_
,	_	_
C	_	_
are	_	_
feature	_	_
map’s	_	_
height	_	_
,	_	_
width	_	_
,	_	_
and	_	_
the	_	_
number	_	_
of	_	_
class	_	_
,	_	_
respectively	_	_
.	_	_

#117
The	_	_
input	_	_
featureD	_	_
with	_	_
size	_	_
ofH×W×MC	_	_
is	_	_
divided	_	_
intoC	_	_
branches	_	_
with	_	_
each	_	_
size	_	_
of	_	_
H×W×M	_	_
.	_	_

#118
Then	_	_
,	_	_
the	_	_
sub-maps	_	_
information	_	_
are	_	_
composed	_	_
into	_	_
one	_	_
final	_	_
feature	_	_
map	_	_
for	_	_
each	_	_
class	_	_
through	_	_
an	_	_
average	_	_
pooling	_	_
.	_	_

#119
This	_	_
results	_	_
in	_	_
a	_	_
transformed	_	_
class	_	_
heatmap	_	_
of	_	_
size	_	_
H	_	_
×W	_	_
×	_	_
C.	_	_
spatial-wise	_	_
pooling	_	_
:	_	_
Given	_	_
a	_	_
class	_	_
heatmap	_	_
with	_	_
size	_	_
of	_	_
H	_	_
×W	_	_
×	_	_
C	_	_
,	_	_
we	_	_
used	_	_
a	_	_
spatial-wise	_	_
pooling	_	_
to	_	_
generate	_	_
our	_	_
final	_	_
classification	_	_
output	_	_
.	_	_

#120
Our	_	_
spatial-wise	_	_
pooling	_	_
extracts	_	_
a	_	_
classification	_	_
vector	_	_
(	_	_
1	_	_
×	_	_
1	_	_
×	_	_
C	_	_
)	_	_
from	_	_
the	_	_
class	_	_
heatmap	_	_
outputted	_	_
from	_	_
class-wise	_	_
pooling	_	_
shown	_	_
above	_	_
.	_	_

#121
The	_	_
most	_	_
common	_	_
strategy	_	_
for	_	_
spatial-wise	_	_
pooling	_	_
is	_	_
maxpooling	_	_
,	_	_
which	_	_
might	speculation	_
potentially	_	_
ignore	_	_
most	_	_
of	_	_
the	_	_
feature	_	_
information	_	_
,	_	_
generate	_	_
localization	_	_
heatmap	_	_
only	_	_
in	_	_
small	_	_
regions	_	_
,	_	_
and	_	_
cause	_	_
insufficient	_	_
pass	_	_
of	_	_
gradient	_	_
for	_	_
training	_	_
.	_	_

#122
Therefore	_	_
,	_	_
we	_	_
proposed	_	_
to	_	_
use	_	_
a	_	_
customized	_	_
spatial-wise	_	_
pooling	_	_
strategy	_	_
for	_	_
both	_	_
training	_	_
and	_	_
testing	_	_
of	_	_
our	_	_
network	_	_
,	_	_
as	_	_
shown	_	_
in	_	_
Figure	_	_
4	_	_
.	_	_

#123
During	_	_
the	_	_
training	_	_
phase	_	_
,	_	_
we	_	_
firstly	_	_
selected	_	_
top	_	_
k	_	_
scores	_	_
from	_	_
H	_	_
×W	_	_
heatmaps	_	_
and	_	_
randomly	_	_
chose	_	_
one	_	_
among	_	_
the	_	_
k	_	_
numbers	_	_
for	_	_
each	_	_
class	_	_
.	_	_

#124
Because	_	_
the	_	_
class	_	_
heatmap	_	_
may	_	_
not	_	_
be	_	_
perfect	_	_
,	_	_
the	_	_
highest	_	_
score	_	_
may	_	_
not	_	_
correctly	_	_
correspond	_	_
to	_	_
the	_	_
disease	_	_
location	_	_
.	_	_

#125
Thus	_	_
,	_	_
random	_	_
sampling	_	_
from	_	_
top	_	_
k	_	_
spatial	_	_
locations	_	_
instead	_	_
of	_	_
simply	_	_
choosing	_	_
the	_	_
max	_	_
gives	_	_
the	_	_
network	_	_
higher	_	_
probability	_	_
to	_	_
capture	_	_
the	_	_
correct	_	_
spatial	_	_
location	_	_
of	_	_
the	_	_
disease	_	_
and	_	_
generate	_	_
the	_	_
correct	_	_
gradient	_	_
.	_	_

#126
During	_	_
the	_	_
testing	_	_
phase	_	_
,	_	_
we	_	_
looked	_	_
at	_	_
regions	_	_
with	_	_
the	_	_
highest	_	_
(	_	_
D+	_	_
)	_	_
/lowest	_	_
(	_	_
D−	_	_
)	_	_
activation	_	_
from	_	_
the	_	_
heatmap	_	_
D.	_	_
The	_	_
highest	_	_
activation	_	_
D+	_	_
indicates	_	_
presence	_	_
of	_	_
classes	_	_
while	_	_
the	_	_
lowest	_	_
activation	_	_
D−	_	_
indicates	_	_
absence	_	_
of	_	_
classes	_	_
.	_	_

#127
Thus	_	_
both	_	_
are	_	_
incorporated	_	_
to	_	_
the	_	_
prediction	_	_
layer	_	_
to	_	_
achieve	_	_
a	_	_
robust	_	_
classification	_	_
performance	_	_
.	_	_

#128
We	_	_
introduced	_	_
a	_	_
weighting	_	_
factor	_	_
α	_	_
to	_	_
control	_	_
the	_	_
relative	_	_
importance	_	_
between	_	_
these	_	_
two	_	_
terms	_	_
.	_	_

#129
Formally	_	_
,	_	_
let	_	_
Dc	_	_
be	_	_
the	_	_
heatmap	_	_
for	_	_
class	_	_
c	_	_
,	_	_
let	_	_
Dc	_	_
+/	_	_
Dc	_	_
−	_	_
be	_	_
the	_	_
set	_	_
of	_	_
top	_	_
k+/bottom	_	_
k−	_	_
scores	_	_
in	_	_
Dc	_	_
,	_	_
and	_	_
let	_	_
dcfinal	_	_
be	_	_
the	_	_
final	_	_
class	_	_
score	_	_
.	_	_

#130
During	_	_
training	_	_
phase	_	_
,	_	_
we	_	_
have	_	_
:	_	_
dcfinal	_	_
=	_	_
dr+	_	_
,	_	_
(	_	_
2	_	_
)	_	_
where	_	_
dr+	_	_
∈	_	_
Dc	_	_
+	_	_
is	_	_
a	_	_
single	_	_
element	_	_
uniformly	_	_
random	_	_
sampled	_	_
from	_	_
Dc	_	_
+	_	_
.	_	_

#131
During	_	_
testing	_	_
phase	_	_
,	_	_
we	_	_
have	_	_
:	_	_
dcfinal	_	_
=	_	_
k+	_	_
∑	_	_
d+∈Dc	_	_
+	_	_
d+	_	_
+	_	_
α	_	_
(	_	_
k−	_	_
∑	_	_
d−∈Dc	_	_
−	_	_
d−	_	_
)	_	_
(	_	_
3	_	_
)	_	_
where	_	_
d+/d−	_	_
are	_	_
elements	_	_
in	_	_
Dc	_	_
+/Dc	_	_
−	_	_
.	_	_

#132
and	_	_
α	_	_
is	_	_
the	_	_
weighting	_	_
factor	_	_
added	_	_
on	_	_
bottom	_	_
scores	_	_
.	_	_

#133
3.4	_	_
.	_	_

#134
Network’s	_	_
training	_	_
For	_	_
network	_	_
initialization	_	_
,	_	_
we	_	_
transfered	_	_
the	_	_
weights	_	_
from	_	_
the	_	_
pre-trained	_	_
models	_	_
on	_	_
ImageNet	_	_
for	_	_
our	_	_
Adaptive	_	_
DenseNet	_	_
.	_	_

#135
Then	_	_
,	_	_
we	_	_
randomly	_	_
initialized	_	_
parameters	_	_
for	_	_
bridging	_	_
and	_	_
WSL	_	_
pooling	_	_
layers	_	_
.	_	_

#136
We	_	_
used	_	_
learning	_	_
rate	_	_
of	_	_
0.002	_	_
with	_	_
weight	_	_
decay	_	_
of	_	_
0.1	_	_
for	_	_
every	_	_
10	_	_
epochs	_	_
during	_	_
training	_	_
.	_	_

#137
Our	_	_
model	_	_
were	_	_
implemented	_	_
with	_	_
Pytorch	_	_
(	_	_
https	_	_
:	_	_
//pytorch.org/	_	_
)	_	_
on	_	_
a	_	_
Nvidia	_	_
GTX	_	_
1080Ti	_	_
.	_	_

#138
We	_	_
added	_	_
batch	_	_
normalization	_	_
[	_	_
25	_	_
]	_	_
after	_	_
each	_	_
convolution	_	_
and	_	_
additional	_	_
drop	_	_
out	_	_
of	_	_
rate	_	_
of	_	_
0.1	_	_
for	_	_
each	_	_
DenseBlock	_	_
inside	_	_
Adaptive	_	_
DenseNet	_	_
[	_	_
26	_	_
]	_	_
to	_	_
prevent	_	_
overfitting	_	_
.	_	_

#139
Since	_	_
there	_	_
is	_	_
a	_	_
large	_	_
data	_	_
imbalance	_	_
between	_	_
each	_	_
class	_	_
,	_	_
we	_	_
trained	_	_
our	_	_
model	_	_
with	_	_
weighted	_	_
binary	_	_
cross	_	_
entropy	_	_
loss	_	_
:	_	_
L	_	_
(	_	_
X	_	_
,	_	_
y	_	_
)	_	_
=	_	_
−w+	_	_
·	_	_
ylogp	_	_
(	_	_
Y	_	_
=	_	_
1|X	_	_
)	_	_
−	_	_
w−	_	_
·	_	_
(	_	_
1−	_	_
y	_	_
)	_	_
logp	_	_
(	_	_
Y	_	_
=	_	_
0|X	_	_
)	_	_
(	_	_
4	_	_
)	_	_
where	_	_
w+	_	_
represents	_	_
percent	_	_
of	_	_
positive	_	_
sample	_	_
and	_	_
w−	_	_
represents	_	_
percent	_	_
of	_	_
negative	_	_
sample	_	_
among	_	_
all	_	_
dataset	_	_
.	_	_

#140
3.5	_	_
.	_	_

#141
Disease	_	_
classification	_	_
and	_	_
localization	_	_
The	_	_
heatmap	_	_
obtained	_	_
from	_	_
our	_	_
class-wise	_	_
pooling	_	_
is	_	_
further	_	_
used	_	_
as	_	_
a	_	_
reference	_	_
map	_	_
to	_	_
generate	_	_
disease	_	_
bounding	_	_
boxes	_	_
.	_	_

#142
A	_	_
thresholding	_	_
followed	_	_
by	_	_
connected	_	_
component	_	_
analysis	_	_
are	_	_
applied	_	_
for	_	_
each	_	_
disease	_	_
class	_	_
to	_	_
generate	_	_
bounding	_	_
boxes	_	_
.	_	_

#143
Empirically	_	_
,	_	_
we	_	_
used	_	_
a	_	_
threshold	_	_
value	_	_
of	_	_
0.8	_	_
for	_	_
”Cardiomegaly”	_	_
and	_	_
threshold	_	_
values	_	_
of	_	_
0.9	_	_
for	_	_
the	_	_
rest	_	_
of	_	_
classes	_	_
to	_	_
obtain	_	_
the	_	_
best	_	_
results	_	_
.	_	_

#144
The	_	_
disease	_	_
classification	_	_
score	_	_
is	_	_
acquired	_	_
from	_	_
the	_	_
spatial-wise	_	_
pooling	_	_
on	_	_
the	_	_
heatmap	_	_
.	_	_

#145
In	_	_
short	_	_
,	_	_
our	_	_
network	_	_
structure	_	_
is	_	_
designed	_	_
for	_	_
both	_	_
disease	_	_
classification	_	_
and	_	_
localization	_	_
tasks	_	_
,	_	_
yet	_	_
only	_	_
use	_	_
chest	_	_
radiographs	_	_
along	_	_
with	_	_
image-level	_	_
annotations	_	_
for	_	_
our	_	_
training	_	_
.	_	_

#146
4	_	_
.	_	_

#147
Experiments	_	_
and	_	_
Results	_	_
4.1	_	_
.	_	_

#148
Data	_	_
for	_	_
experiments	_	_
We	_	_
performed	_	_
our	_	_
experiment	_	_
using	_	_
the	_	_
ChestX-ray14	_	_
dataset	_	_
.	_	_

#149
The	_	_
diseases	_	_
in	_	_
the	_	_
corresponding	_	_
chest	_	_
radiograph	_	_
are	_	_
diagnosed	_	_
by	_	_
radiologists	_	_
and	_	_
the	_	_
labeled	_	_
ground	_	_
truth	_	_
are	_	_
obtained	_	_
through	_	_
text	_	_
mining	_	_
on	_	_
the	_	_
patients’	_	_
diagnostic	_	_
reports	_	_
.	_	_

#150
We	_	_
used	_	_
exactly	_	_
same	_	_
published	_	_
data	_	_
split	_	_
as	_	_
in	_	_
[	_	_
18	_	_
,	_	_
8	_	_
,	_	_
16	_	_
]	_	_
.	_	_

#151
The	_	_
dataset	_	_
is	_	_
divided	_	_
into	_	_
training	_	_
(	_	_
70	_	_
%	_	_
)	_	_
,	_	_
validation	_	_
(	_	_
10	_	_
%	_	_
)	_	_
and	_	_
testing	_	_
(	_	_
20	_	_
%	_	_
)	_	_
.	_	_

#152
The	_	_
original	_	_
resolution	_	_
of	_	_
image	_	_
is	_	_
1024	_	_
×	_	_
1024	_	_
and	_	_
was	_	_
downscaled	_	_
to	_	_
256	_	_
×	_	_
256	_	_
.	_	_

#153
In	_	_
order	_	_
to	_	_
fit	_	_
dataset	_	_
into	_	_
ImageNet	_	_
[	_	_
1	_	_
]	_	_
pre-trained	_	_
models	_	_
,	_	_
we	_	_
normalized	_	_
the	_	_
image	_	_
by	_	_
mean	_	_
and	_	_
standard	_	_
deviation	_	_
of	_	_
the	_	_
images	_	_
from	_	_
ImageNet	_	_
.	_	_

#154
We	_	_
used	_	_
random	_	_
crop	_	_
of	_	_
size	_	_
224×	_	_
224	_	_
from	_	_
the	_	_
downscaled	_	_
image	_	_
as	_	_
the	_	_
network	_	_
input	_	_
for	_	_
training	_	_
and	_	_
we	_	_
used	_	_
center	_	_
crop	_	_
of	_	_
same	_	_
size	_	_
for	_	_
testing	_	_
.	_	_

#155
For	_	_
localization	_	_
validation	_	_
,	_	_
the	_	_
ChestX-ray14	_	_
dataset	_	_
contains	_	_
880	_	_
images	_	_
with	_	_
983	_	_
disease	_	_
bounding	_	_
boxes	_	_
annotated	_	_
by	_	_
board-certified	_	_
radiologists	_	_
.	_	_

#156
We	_	_
calculated	_	_
the	_	_
intersection	_	_
over	_	_
union	_	_
(	_	_
IoU	_	_
)	_	_
between	_	_
our	_	_
prediction	_	_
and	_	_
the	_	_
ground	_	_
truth	_	_
bounding	_	_
boxes	_	_
.	_	_

#157
4.2	_	_
.	_	_

#158
Disease	_	_
classification	_	_
We	_	_
calculated	_	_
the	_	_
Area	_	_
under	_	_
Receiver	_	_
Operating	_	_
Characteristic	_	_
curve	_	_
(	_	_
AUROC	_	_
)	_	_
for	_	_
each	_	_
class	_	_
to	_	_
evaluate	_	_
the	_	_
classification	_	_
performance	_	_
of	_	_
our	_	_
model	_	_
.	_	_

#159
Our	_	_
results	_	_
are	_	_
selected	_	_
based	_	_
on	_	_
the	_	_
best	_	_
performance	_	_
of	_	_
classifier	_	_
for	_	_
each	_	_
class	_	_
throughout	_	_
our	_	_
training	_	_
iterations	_	_
.	_	_

#160
Our	_	_
classification	_	_
performance	_	_
is	_	_
compared	_	_
with	_	_
other	_	_
state-of-the-art	_	_
results	_	_
[	_	_
8	_	_
,	_	_
16	_	_
,	_	_
17	_	_
,	_	_
18	_	_
]	_	_
.	_	_

#161
The	_	_
experiment	_	_
is	_	_
tested	_	_
with	_	_
the	_	_
same	_	_
dataset	_	_
splitting	_	_
as	_	_
demonstrated	_	_
in	_	_
[	_	_
8	_	_
,	_	_
16	_	_
,	_	_
18	_	_
]	_	_
.	_	_

#162
In	_	_
all	_	_
14	_	_
diseases	_	_
,	_	_
our	_	_
model	_	_
achieved	_	_
better	_	_
classification	_	_
AUROC	_	_
than	_	_
[	_	_
8	_	_
,	_	_
16	_	_
]	_	_
as	_	_
shown	_	_
in	_	_
Table	_	_
1	_	_
.	_	_

#163
In	_	_
comparison	_	_
to	_	_
[	_	_
17	_	_
]	_	_
with	_	_
supervision	_	_
from	_	_
both	_	_
image-level	_	_
labels	_	_
and	_	_
bounding	_	_
box	_	_
annotations	_	_
,	_	_
our	_	_
model	_	_
achieved	_	_
significant	_	_
better	_	_
classification	_	_
AUROC	_	_
in	_	_
13	_	_
out	_	_
of	_	_
14	_	_
diseases	_	_
.	_	_

#164
Pathology	_	_
Wang	_	_
[	_	_
8	_	_
]	_	_
Yao	_	_
[	_	_
16	_	_
]	_	_
Li	_	_
[	_	_
17	_	_
]	_	_
Rajpurkar	_	_
[	_	_
18	_	_
]	_	_
Ours	_	_
Atelectasis	_	_
0.7003	_	_
0.772	_	_
0.80	_	_
0.8094	_	_
0.8121	_	_
Cardiomegaly	_	_
0.8100	_	_
0.904	_	_
0.87	_	_
0.9248	_	_
0.9066	_	_
Effusion	_	_
0.7585	_	_
0.859	_	_
0.87	_	_
0.8638	_	_
0.8786	_	_
Infiltration	_	_
0.6614	_	_
0.695	_	_
0.70	_	_
0.7345	_	_
0.7065	_	_
Mass	_	_
0.6933	_	_
0.792	_	_
0.83	_	_
0.8676	_	_
0.8354	_	_
Nodule	_	_
0.6687	_	_
0.717	_	_
0.75	_	_
0.7802	_	_
0.7852	_	_
Pneumonia	_	_
0.6580	_	_
0.713	_	_
0.67	_	_
0.7680	_	_
0.7810	_	_
Pneumothorax	_	_
0.7993	_	_
0.841	_	_
0.87	_	_
0.8887	_	_
0.8911	_	_
Consolidation	_	_
0.7032	_	_
0.788	_	_
0.80	_	_
0.7901	_	_
0.8115	_	_
Edema	_	_
0.8052	_	_
0.882	_	_
0.88	_	_
0.8878	_	_
0.8953	_	_
Emphysema	_	_
0.8330	_	_
0.829	_	_
0.91	_	_
0.9371	_	_
0.9373	_	_
Fibrosis	_	_
0.7859	_	_
0.767	_	_
0.78	_	_
0.8047	_	_
0.8187	_	_
Pleural	_	_
Thickening	_	_
0.6835	_	_
0.765	_	_
0.79	_	_
0.8062	_	_
0.7792	_	_
Hernia	_	_
0.8717	_	_
0.914	_	_
0.77	_	_
0.9164	_	_
0.9487	_	_
Table	_	_
1	_	_
.	_	_

#165
AUROC	_	_
is	_	_
used	_	_
to	_	_
evaluate	_	_
model	_	_
classification	_	_
performance	_	_
for	_	_
14	_	_
diseases	_	_
.	_	_

#166
The	_	_
best	_	_
results	_	_
are	_	_
shown	_	_
in	_	_
bold	_	_
text	_	_
.	_	_

#167
In	_	_
order	_	_
to	_	_
obtain	_	_
a	_	_
comprehensive	_	_
comparison	_	_
,	_	_
performance	_	_
of	_	_
all	_	_
previous	_	_
networks	_	_
to	_	_
our	_	_
knowledge	_	_
are	_	_
included	_	_
.	_	_

#168
All	_	_
results	_	_
are	_	_
obtained	_	_
from	_	_
their	_	_
latest	_	_
update	_	_
.	_	_

#169
CardiomegalyAtelectasis	_	_
Effusion	_	_
Infiltrate	_	_
Mass	_	_
Nodule	_	_
Pneumonia	_	_
Pneumothorax	_	_
0.85	_	_
0.98	_	_
0.85	_	_
0.95	_	_
0.81	_	_
0.55	_	_
0.92	_	_
0.94	_	_
Figure	_	_
5	_	_
.	_	_

#170
Examples	_	_
of	_	_
localization	_	_
results	_	_
on	_	_
8	_	_
diseases	_	_
along	_	_
with	_	_
ground	_	_
truth	_	_
bounding	_	_
box	_	_
annotations	_	_
.	_	_

#171
In	_	_
each	_	_
pair	_	_
,	_	_
a	_	_
chest	_	_
radiograph	_	_
(	_	_
left	_	_
)	_	_
inputs	_	_
into	_	_
our	_	_
model	_	_
and	_	_
the	_	_
corresponding	_	_
heatmap	_	_
(	_	_
right	_	_
)	_	_
is	_	_
generated	_	_
.	_	_

#172
The	_	_
heatmaps	_	_
produced	_	_
from	_	_
our	_	_
model	_	_
match	_	_
with	_	_
the	_	_
ground-truth	_	_
bounding	_	_
boxes	_	_
(	_	_
green	_	_
)	_	_
annotated	_	_
by	_	_
radiologists	_	_
and	_	_
indicated	_	_
good	_	_
IoU	_	_
results	_	_
(	_	_
yellow	_	_
)	_	_
.	_	_

#173
In	_	_
particular	_	_
,	_	_
our	_	_
model	_	_
obtained	_	_
more	_	_
than	_	_
3	_	_
%	_	_
higher	_	_
AUROC	_	_
in	_	_
”Cardiomegaly”	_	_
,	_	_
”Nodule”	_	_
,	_	_
”Pneumonia”	_	_
,	_	_
”Fibrosis”	_	_
and	_	_
”Hernia”	_	_
.	_	_

#174
Comparing	_	_
our	_	_
results	_	_
with	_	_
[	_	_
18	_	_
]	_	_
’s	_	_
work	_	_
which	_	_
only	_	_
focus	_	_
on	_	_
classification	_	_
,	_	_
our	_	_
model	_	_
outperformed	_	_
theirs	_	_
in	_	_
10	_	_
out	_	_
of	_	_
14	_	_
diseases	_	_
.	_	_

#175
In	_	_
Table	_	_
1	_	_
,	_	_
our	_	_
network	_	_
performed	_	_
better	_	_
on	_	_
diseases	_	_
classification	_	_
with	_	_
large	_	_
lesions	_	_
than	_	_
one	_	_
with	_	_
smaller	_	_
lesions	_	_
.	_	_

#176
”Cardiomegaly”	_	_
and	_	_
”Emphysema”	_	_
are	_	_
the	_	_
representative	_	_
classes	_	_
for	_	_
disease	_	_
with	_	_
large	_	_
lesion	_	_
and	_	_
our	_	_
model	_	_
achieved	_	_
classification	_	_
score	_	_
over	_	_
90	_	_
%	_	_
on	_	_
both	_	_
.	_	_

#177
Although	_	_
our	_	_
network	_	_
performed	_	_
less	_	_
accurate	_	_
on	_	_
identifying	_	_
smaller	_	_
lesions	_	_
such	_	_
as	_	_
mass	_	_
and	_	_
nodule	_	_
,	_	_
our	_	_
model	_	_
is	_	_
improved	_	_
from	_	_
[	_	_
8	_	_
,	_	_
16	_	_
,	_	_
17	_	_
,	_	_
18	_	_
]	_	_
on	_	_
these	_	_
classes	_	_
as	_	_
well	_	_
.	_	_

#178
Unlike	_	_
the	_	_
traditional	_	_
maxpooling	_	_
which	_	_
only	_	_
output	_	_
the	_	_
maximal	_	_
response	_	_
from	_	_
a	_	_
network	_	_
output	_	_
,	_	_
our	_	_
class-wise	_	_
pooling	_	_
can	_	_
pool	_	_
multiple	_	_
response	_	_
from	_	_
the	_	_
submaps	_	_
which	_	_
contain	_	_
different	_	_
feature	_	_
responses	_	_
of	_	_
the	_	_
target	_	_
lesion	_	_
.	_	_

#179
In	_	_
this	_	_
case	_	_
,	_	_
the	_	_
classification	_	_
of	_	_
the	_	_
large	_	_
lesions	_	_
that	_	_
potentially	_	_
contains	_	_
more	_	_
appearance	_	_
feature	_	_
than	_	_
small	_	_
lesions	_	_
can	_	_
be	_	_
better	_	_
improved	_	_
with	_	_
our	_	_
customized	_	_
pooling	_	_
methods	_	_
.	_	_

#180
In	_	_
addition	_	_
,	_	_
we	_	_
performed	_	_
hyper-parameter	_	_
searching	_	_
for	_	_
best	_	_
classification	_	_
performance	_	_
(	_	_
details	_	_
shown	_	_
in	_	_
Supplemental	_	_
Materials	_	_
)	_	_
.	_	_

#181
In	_	_
class-wise	_	_
pooling	_	_
,	_	_
we	_	_
tested	_	_
number	_	_
of	_	_
sub-maps	_	_
(	_	_
M	_	_
)	_	_
from	_	_
number	_	_
2	_	_
to	_	_
18	_	_
and	_	_
found	_	_
14	_	_
sub-maps	_	_
yielded	_	_
best	_	_
result	_	_
.	_	_

#182
We	_	_
then	_	_
kept	_	_
this	_	_
setting	_	_
for	_	_
the	_	_
rest	_	_
of	_	_
experiment	_	_
.	_	_

#183
In	_	_
spatial	_	_
pooling	_	_
,	_	_
we	_	_
tested	_	_
hyper-parameters	_	_
on	_	_
two	_	_
different	_	_
strategies	_	_
separately	_	_
.	_	_

#184
During	_	_
training	_	_
,	_	_
we	_	_
tested	_	_
our	_	_
model	_	_
using	_	_
top	_	_
k+	_	_
scores	_	_
,	_	_
k+	_	_
ranging	_	_
from	_	_
1	_	_
to	_	_
20	_	_
.	_	_

#185
We	_	_
found	_	_
that	_	_
k+	_	_
at	_	_
10	_	_
yielded	_	_
best	_	_
network	_	_
.	_	_

#186
During	_	_
testing	_	_
,	_	_
we	_	_
tested	_	_
k+	_	_
from	_	_
1	_	_
to	_	_
20	_	_
and	_	_
k−	_	_
from	_	_
1	_	_
to	_	_
25	_	_
.	_	_

#187
We	_	_
found	_	_
that	_	_
both	_	_
k+	_	_
and	_	_
k−	_	_
at	_	_
15	_	_
yielded	_	_
best	_	_
classification	_	_
result	_	_
.	_	_

#188
We	_	_
tested	_	_
α	_	_
ranging	_	_
from	_	_
0.25	_	_
to	_	_
1	_	_
and	_	_
α	_	_
equals	_	_
at	_	_
1	_	_
gave	_	_
the	_	_
best	_	_
importance	_	_
balance	_	_
between	_	_
k+	_	_
and	_	_
k−	_	_
.	_	_

#189
4.3	_	_
.	_	_

#190
Disease	_	_
localization	_	_
We	_	_
generated	_	_
our	_	_
predicted	_	_
bounding	_	_
boxes	_	_
by	_	_
applying	_	_
a	_	_
naive	_	_
thresholding	_	_
(	_	_
T	_	_
=	_	_
0.1	_	_
∼	_	_
0.7	_	_
)	_	_
on	_	_
the	_	_
normalized	_	_
T	_	_
(	_	_
IoU	_	_
)	_	_
Model	_	_
Atelectasis	_	_
Cardiomegaly	_	_
Effusion	_	_
Infiltration	_	_
Mass	_	_
Nodule	_	_
Pneumonia	_	_
Pneumothorax	_	_
0.1	_	_
Wang	_	_
0.6888	_	_
0.9383	_	_
0.6601	_	_
0.7073	_	_
0.4000	_	_
0.1392	_	_
0.6333	_	_
0.3775	_	_
Ours	_	_
0.4113	_	_
0.9659	_	_
0.5950	_	_
0.8134	_	_
0.5292	_	_
0.0758	_	_
0.7421	_	_
0.3267	_	_
Ours*	_	_
0.4283	_	_
0.9657	_	_
0.6926	_	_
0.8211	_	_
0.5539	_	_
0.2156	_	_
0.7752	_	_
0.3263	_	_
0.2	_	_
Wang	_	_
0.4722	_	_
0.6849	_	_
0.4509	_	_
0.4796	_	_
0.2588	_	_
0.0506	_	_
0.35	_	_
0.2346	_	_
Ours	_	_
0.2388	_	_
0.9453	_	_
0.3341	_	_
0.6745	_	_
0.3058	_	_
0.0125	_	_
0.5752	_	_
0.2043	_	_
Ours*	_	_
0.2557	_	_
0.9453	_	_
0.5036	_	_
0.6833	_	_
0.3292	_	_
0.1522	_	_
0.6331	_	_
0.2052	_	_
0.3	_	_
Wang	_	_
0.2444	_	_
0.4589	_	_
0.3006	_	_
0.2764	_	_
0.1529	_	_
0.0379	_	_
0.1666	_	_
0.1326	_	_
Ours	_	_
0.1458	_	_
0.9316	_	_
0.1448	_	_
0.5223	_	_
0.1531	_	_
0.0031	_	_
0.4420	_	_
0.1432	_	_
Ours*	_	_
0.1613	_	_
0.9246	_	_
0.3334	_	_
0.5368	_	_
0.1768	_	_
0.1393	_	_
0.5010	_	_
0.1432	_	_
0.4	_	_
Wang	_	_
0.0944	_	_
0.2808	_	_
0.2026	_	_
0.1219	_	_
0.0705	_	_
0.0126	_	_
0.075	_	_
0.0714	_	_
Ours	_	_
0.0887	_	_
0.8772	_	_
0.0590	_	_
0.3575	_	_
0.1174	_	_
0.0025	_	_
0.2582	_	_
0.1124	_	_
Ours*	_	_
0.1062	_	_
0.8769	_	_
0.2678	_	_
0.3911	_	_
0.1430	_	_
0.1388	_	_
0.3252	_	_
0.1123	_	_
0.5	_	_
Wang	_	_
0.0500	_	_
0.1780	_	_
0.1111	_	_
0.0650	_	_
0.0117	_	_
0.0126	_	_
0.0333	_	_
0.0306	_	_
Ours	_	_
0.0448	_	_
0.7806	_	_
0.0133	_	_
0.2523	_	_
0.0592	_	_
0.00022	_	_
0.1419	_	_
0.0514	_	_
Ours*	_	_
0.0612	_	_
0.7812	_	_
0.2286	_	_
0.2843	_	_
0.0827	_	_
0.1394	_	_
0.2086	_	_
0.0522	_	_
0.6	_	_
Wang	_	_
0.0222	_	_
0.0753	_	_
0.0457	_	_
0.0243	_	_
0.0000	_	_
0.0126	_	_
0.0166	_	_
0.0306	_	_
Ours	_	_
0.0116	_	_
0.5211	_	_
0.0000	_	_
0.1552	_	_
0.0238	_	_
0.0000	_	_
0.0422	_	_
0.0413	_	_
Ours*	_	_
0.0280	_	_
0.5208	_	_
0.2159	_	_
0.1873	_	_
0.0475	_	_
0.1393	_	_
0.1081	_	_
0.0409	_	_
0.7	_	_
Wang	_	_
0.0055	_	_
0.0273	_	_
0.0196	_	_
0.0000	_	_
0.0000	_	_
0.0000	_	_
0.0083	_	_
0.0204	_	_
Ours	_	_
0.0063	_	_
0.2342	_	_
0.0000	_	_
0.0742	_	_
0.0123	_	_
0.0000	_	_
0.0165	_	_
0.0108	_	_
Ours*	_	_
0.0223	_	_
0.2332	_	_
0.2161	_	_
0.1062	_	_
0.0358	_	_
0.1395	_	_
0.0836	_	_
0.0104	_	_
IoU	_	_
Wang	_	_
0.2254	_	_
0.3776	_	_
0.2558	_	_
0.2392	_	_
0.1277	_	_
0.0379	_	_
0.1833	_	_
0.1282	_	_
Ours	_	_
0.1353	_	_
0.7508	_	_
0.1637	_	_
0.4071	_	_
0.1715	_	_
0.0134	_	_
0.3169	_	_
0.1272	_	_
Ours*	_	_
0.1519	_	_
0.7497	_	_
0.3511	_	_
0.4300	_	_
0.1956	_	_
0.1520	_	_
0.3764	_	_
0.1272	_	_
Table	_	_
2	_	_
.	_	_

#191
Comparison	_	_
of	_	_
disease	_	_
localization	_	_
using	_	_
IoU	_	_
,	_	_
where	_	_
threshold	_	_
of	_	_
IoU	_	_
are	_	_
set	_	_
to	_	_
0.1	_	_
,	_	_
0.2	_	_
,	_	_
0.3	_	_
,	_	_
0.4	_	_
,	_	_
0.5	_	_
,	_	_
0.6	_	_
,	_	_
0.7	_	_
for	_	_
evaluation	_	_
,	_	_
respectively	_	_
.	_	_

#192
Best	_	_
results	_	_
between	_	_
Wang	_	_
et	_	_
al.’s	_	_
and	_	_
ours	_	_
are	_	_
shown	_	_
in	_	_
bold	_	_
.	_	_

#193
Last	_	_
row	_	_
shows	_	_
average	_	_
IoU	_	_
for	_	_
all	_	_
diseases	_	_
.	_	_

#194
*	_	_
means	_	_
results	_	_
obtained	_	_
from	_	_
same	_	_
dataset	_	_
with	_	_
expanded	_	_
annotation	_	_
from	_	_
certified	_	_
radiologist	_	_
.	_	_

#195
heatmap	_	_
with	_	_
value	_	_
ranged	_	_
from	_	_
0	_	_
to	_	_
1	_	_
that	_	_
obtained	_	_
from	_	_
our	_	_
class-wise	_	_
pooling	_	_
layer	_	_
.	_	_

#196
Examples	_	_
are	_	_
shown	_	_
in	_	_
Figure	_	_
5	_	_
.	_	_

#197
No	_	_
localization	_	_
annotation	_	_
was	_	_
used	_	_
during	_	_
training	_	_
process	_	_
.	_	_

#198
The	_	_
heatmaps	_	_
were	_	_
generated	_	_
by	_	_
our	_	_
network	_	_
with	_	_
training	_	_
only	_	_
from	_	_
image-level	_	_
labels	_	_
.	_	_

#199
All	_	_
880	_	_
images	_	_
with	_	_
bounding	_	_
boxes	_	_
ground	_	_
truth	_	_
were	_	_
used	_	_
for	_	_
evaluation	_	_
.	_	_

#200
In	_	_
Table	_	_
2	_	_
,	_	_
we	_	_
compared	_	_
our	_	_
results	_	_
with	_	_
[	_	_
8	_	_
]	_	_
.	_	_

#201
Our	_	_
model	_	_
achieved	_	_
significantly	_	_
higher	_	_
IoU	_	_
score	_	_
over	_	_
[	_	_
8	_	_
]	_	_
on	_	_
diseases	_	_
with	_	_
large	_	_
lesion	_	_
,	_	_
such	_	_
as	_	_
”Cardiomegaly”	_	_
(	_	_
abnormally	_	_
large	_	_
heart	_	_
)	_	_
.	_	_

#202
The	_	_
heatmap	_	_
is	_	_
well-fitted	_	_
with	_	_
the	_	_
ground	_	_
truth	_	_
bounding	_	_
box	_	_
.	_	_

#203
Disease	_	_
such	_	_
as	_	_
”Infiltration”	_	_
(	_	_
substance	_	_
such	_	_
as	_	_
blood	_	_
infiltrates	_	_
through	_	_
vessel	_	_
into	_	_
lung	_	_
)	_	_
and	_	_
”Pneumonia”	_	_
(	_	_
inflammation	_	_
in	_	_
lung	_	_
)	_	_
that	_	_
affect	_	_
large	_	_
area	_	_
of	_	_
lungs	_	_
manifest	_	_
as	_	_
visually	_	_
more	_	_
prominent	_	_
patterns	_	_
,	_	_
which	_	_
are	_	_
learned	_	_
by	_	_
our	_	_
network	_	_
.	_	_

#204
Moreover	_	_
,	_	_
the	_	_
localization	_	_
for	_	_
small	_	_
disease	_	_
region	_	_
such	_	_
as	_	_
”Atelectasis”	_	_
(	_	_
partially	_	_
collapsed	_	_
lung	_	_
)	_	_
and	_	_
Mass	_	_
(	_	_
an	_	_
abnormal	_	_
lump	_	_
>	_	_
3cm	_	_
)	_	_
can	_	_
also	_	_
be	_	_
well	_	_
captured	_	_
by	_	_
our	_	_
network	_	_
.	_	_

#205
Noted	_	_
that	_	_
for	_	_
”Effusion”	_	_
(	_	_
liquid	_	_
occupying	_	_
lung	_	_
space	_	_
)	_	_
,	_	_
our	_	_
network	_	_
detects	_	_
the	_	_
disease	_	_
that	_	_
covers	_	_
whole	_	_
lesion	_	_
while	_	_
the	_	_
ground	_	_
truth	_	_
includes	_	_
some	_	_
extra	_	_
parts	_	_
such	_	_
as	_	_
the	_	_
shoulder	_	_
.	_	_

#206
We	_	_
presents	_	_
5	_	_
ambiguous	_	_
cases	_	_
on	_	_
5	_	_
diseases	_	_
in	_	_
Figure	_	_
6	_	_
,	_	_
which	_	_
represents	_	_
bias	_	_
in	_	_
localization	_	_
annotations	_	_
that	_	_
leads	_	_
to	_	_
lower	_	_
IoU	_	_
score	_	_
.	_	_

#207
In	_	_
the	_	_
case	_	_
of	_	_
”Effusion”	_	_
,	_	_
the	_	_
annotation	_	_
outlined	_	_
the	_	_
liquid-lung	_	_
boundary	_	_
.	_	_

#208
Instead	_	_
,	_	_
our	_	_
network	_	_
includes	_	_
the	_	_
full	_	_
liquid	_	_
rinsed	_	_
area	_	_
.	_	_

#209
In	_	_
the	_	_
cases	_	_
of	_	_
”Infiltration”	_	_
and	_	_
”Pneumonia”	_	_
that	_	_
spread	_	_
both	_	_
lungs	_	_
,	_	_
the	_	_
ground	_	_
truth	_	_
annotations	_	_
only	_	_
includes	_	_
single	_	_
lung	_	_
,	_	_
whereas	_	_
our	_	_
network	_	_
captures	_	_
both	_	_
lungs	_	_
.	_	_

#210
For	_	_
cases	_	_
like	_	_
”Mass”	_	_
and	_	_
”Nodule”	_	_
,	_	_
the	_	_
ground	_	_
truth	_	_
bounding	_	_
box	_	_
only	_	_
highlights	_	_
one	_	_
of	_	_
many	_	_
instances	_	_
of	_	_
”Mass”	_	_
and	_	_
”Nodule”	_	_
,	_	_
but	_	_
our	_	_
localization	_	_
highlights	_	_
all	_	_
instances	_	_
.	_	_

#211
Observing	_	_
annotation	_	_
ambiguity	_	_
,	_	_
we	_	_
attempted	_	_
to	_	_
quantify	_	_
the	_	_
effect	_	_
.	_	_

#212
We	_	_
expanded	_	_
the	_	_
annotations	_	_
by	_	_
having	_	_
a	_	_
certified	_	_
radiologist	_	_
manually	_	_
re-labeled	_	_
bounding	_	_
boxes	_	_
on	_	_
lesion	_	_
on	_	_
80	_	_
ambiguous	_	_
cases	_	_
.	_	_

#213
We	_	_
evaluated	_	_
our	_	_
model	_	_
with	_	_
the	_	_
expanded	_	_
annotations	_	_
and	_	_
the	_	_
updated	_	_
localization	_	_
IoU	_	_
is	_	_
shown	_	_
in	_	_
Table	_	_
2	_	_
.	_	_

#214
The	_	_
updated	_	_
IoU	_	_
score	_	_
on	_	_
expanded	_	_
annotations	_	_
is	_	_
significantly	_	_
improved	_	_
for	_	_
certain	_	_
classes	_	_
,	_	_
such	_	_
as	_	_
”Effusion”	_	_
,	_	_
”Nodule”	_	_
,	_	_
”Atelectasis”	_	_
,	_	_
”Infiltration”	_	_
,	_	_
”Mass”	_	_
,	_	_
and	_	_
”Pneumonia”	_	_
.	_	_

#215
5	_	_
.	_	_

#216
Discussion	_	_
In	_	_
clinical	_	_
procedures	_	_
,	_	_
visual	_	_
evidence	_	_
such	_	_
as	_	_
segmentation	_	_
or	_	_
spatial	_	_
localization	_	_
of	_	_
disease	_	_
lesions	_	_
,	_	_
in	_	_
support	_	_
of	_	_
disease	_	_
classification	_	_
results	_	_
,	_	_
is	_	_
a	_	_
vital	_	_
part	_	_
of	_	_
clinical	_	_
diagnosis	_	_
.	_	_

#217
It	_	_
provides	_	_
a	_	_
comprehensive	_	_
insight	_	_
into	_	_
the	_	_
disEffusion	_	_
Infiltrate	_	_
Mass	_	_
Nodule	_	_
Pneumonia	_	_
Figure	_	_
6	_	_
.	_	_

#218
This	_	_
shows	_	_
5	_	_
ambiguous	_	_
cases	_	_
on	_	_
5	_	_
diseases	_	_
where	_	_
bounding	_	_
annotations	_	_
are	_	_
bias	_	_
.	_	_

#219
The	_	_
input	_	_
image	_	_
is	_	_
shown	_	_
on	_	_
the	_	_
right	_	_
,	_	_
with	_	_
two	_	_
bounding	_	_
boxes	_	_
labels	_	_
:	_	_
green	_	_
is	_	_
the	_	_
provided	_	_
ground	_	_
truth	_	_
and	_	_
red	_	_
is	_	_
our	_	_
localized	_	_
bounding	_	_
boxes	_	_
.	_	_

#220
The	_	_
class-pooling	_	_
output	_	_
heatmap	_	_
is	_	_
shown	_	_
on	_	_
the	_	_
right	_	_
.	_	_

#221
The	_	_
red	_	_
bounding	_	_
boxes	_	_
are	_	_
generated	_	_
by	_	_
applying	_	_
a	_	_
naive	_	_
thresholding	_	_
.	_	_

#222
ease	_	_
and	_	_
potentially	_	_
decreases	_	_
the	_	_
false	_	_
positive	_	_
of	_	_
diagnosis	_	_
.	_	_

#223
In	_	_
this	_	_
work	_	_
,	_	_
we	_	_
proposed	_	_
a	_	_
weakly	_	_
supervised	_	_
adaptive	_	_
DenseNet	_	_
architecture	_	_
.	_	_

#224
It	_	_
only	_	_
trains	_	_
on	_	_
image-level	_	_
annotation	_	_
,	_	_
yet	_	_
is	_	_
able	_	_
to	_	_
provide	_	_
both	_	_
disease	_	_
classification	_	_
and	_	_
corresponding	_	_
visual	_	_
evidence	_	_
,	_	_
making	_	_
it	_	_
potentially	_	_
valuable	_	_
in	_	_
clinical	_	_
setting	_	_
.	_	_

#225
In	_	_
our	_	_
experiment	_	_
,	_	_
we	_	_
specifically	_	_
looked	_	_
at	_	_
14	_	_
different	_	_
thoracic	_	_
diseases	_	_
.	_	_

#226
Our	_	_
network	_	_
demonstrated	_	_
its	_	_
ability	_	_
to	_	_
precisely	_	_
identify	_	_
disease	_	_
patterns	_	_
which	_	_
generated	_	_
accurate	_	_
disease	_	_
classification	_	_
and	_	_
corresponding	_	_
heatmaps	_	_
for	_	_
disease	_	_
localization	_	_
.	_	_

#227
In	_	_
our	_	_
classification	_	_
experiments	_	_
,	_	_
our	_	_
network	_	_
outperformed	_	_
the	_	_
current	_	_
state-of-the-art	_	_
method	_	_
on	_	_
10	_	_
out	_	_
of	_	_
14	_	_
diseases	_	_
.	_	_

#228
Specifically	_	_
,	_	_
our	_	_
network	_	_
has	_	_
shown	_	_
significant	_	_
classification	_	_
improvements	_	_
on	_	_
diseases	_	_
with	_	_
large	_	_
lesion	_	_
such	_	_
as	_	_
”Pneumonia”	_	_
and	_	_
”Emphysema”	_	_
.	_	_

#229
Our	_	_
model	_	_
also	_	_
gave	_	_
robust	_	_
classification	_	_
results	_	_
on	_	_
diseases	_	_
with	_	_
small	_	_
lesions	_	_
such	_	_
as	_	_
”Nodule”	_	_
.	_	_

#230
In	_	_
our	_	_
localization	_	_
experiments	_	_
,	_	_
our	_	_
network	_	_
achieved	_	_
significant	_	_
better	_	_
localization	_	_
performance	_	_
on	_	_
5	_	_
out	_	_
of	_	_
8	_	_
diseases	_	_
with	_	_
mean	_	_
T	_	_
(	_	_
IoU	_	_
)	_	_
=0.7	_	_
,	_	_
as	_	_
compared	_	_
to	_	_
the	_	_
NIH	_	_
baseline	_	_
[	_	_
8	_	_
]	_	_
.	_	_

#231
Compared	_	_
to	_	_
previous	_	_
methods	_	_
,	_	_
the	_	_
possible	_	_
reasons	_	_
for	_	_
our	_	_
network	_	_
to	_	_
achieve	_	_
higher	_	_
classification	_	_
and	_	_
localization	_	_
accuracy	_	_
is	_	_
two-fold	_	_
.	_	_

#232
First	_	_
of	_	_
all	_	_
,	_	_
the	_	_
use	_	_
of	_	_
a	_	_
two-stage	_	_
pooling	_	_
(	_	_
class-wise	_	_
&	_	_
spatial-wise	_	_
)	_	_
allows	_	_
the	_	_
network	_	_
to	_	_
capture	_	_
complex	_	_
intra-class	_	_
variations	_	_
and	_	_
highlight	_	_
different	_	_
useful	_	_
lesion	_	_
features	_	_
on	_	_
multiple	_	_
sub-maps	_	_
for	_	_
one	_	_
disease	_	_
class	_	_
.	_	_

#233
Secondly	_	_
,	_	_
the	_	_
removal	_	_
of	_	_
average	_	_
pooling	_	_
helps	_	_
to	_	_
improve	_	_
spatial	_	_
resolution	_	_
and	_	_
maintain	_	_
more	_	_
image	_	_
details	_	_
for	_	_
the	_	_
lesion	_	_
features	_	_
capturing	_	_
in	_	_
the	_	_
WSL	_	_
pooling	_	_
.	_	_

#234
We	_	_
also	_	_
evaluated	_	_
the	_	_
effect	_	_
of	_	_
localization	_	_
label	_	_
ambiguity	_	_
.	_	_

#235
We	_	_
collaborated	_	_
with	_	_
a	_	_
certified	_	_
radiologist	_	_
to	_	_
expand	_	_
the	_	_
ground	_	_
truth	_	_
bounding	_	_
box	_	_
annotations	_	_
on	_	_
80	_	_
cases	_	_
.	_	_

#236
We	_	_
found	_	_
that	_	_
our	_	_
localization	_	_
has	_	_
significantly	_	_
better	_	_
overlap	_	_
with	_	_
the	_	_
bounding	_	_
box	_	_
in	_	_
the	_	_
expanded	_	_
annotation	_	_
than	_	_
the	_	_
one	_	_
provided	_	_
in	_	_
ChestX-ray14	_	_
dataset	_	_
on	_	_
certain	_	_
cases	_	_
.	_	_

#237
Examples	_	_
of	_	_
the	_	_
ambiguity	_	_
cases	_	_
are	_	_
illustrated	_	_
in	_	_
our	_	_
Supplemental	_	_
Materials	_	_
with	_	_
detailed	_	_
explanations	_	_
.	_	_

#238
For	_	_
future	_	_
work	_	_
,	_	_
it	_	_
is	_	_
worth	_	_
noting	_	_
that	_	_
the	_	_
annotations	_	_
in	_	_
the	_	_
ChestX-ray14	_	_
dataset	_	_
is	_	_
generated	_	_
by	_	_
text	_	_
mining	_	_
instead	_	_
of	_	_
manual	_	_
annotation	_	_
,	_	_
which	_	_
guarantees	_	_
90	_	_
%	_	_
correctness	_	_
of	_	_
labeling	_	_
.	_	_

#239
In	_	_
this	_	_
case	_	_
,	_	_
the	_	_
labels	_	_
can	_	_
potentially	_	_
be	_	_
further	_	_
improved	_	_
.	_	_

#240
The	_	_
model	_	_
should	_	_
be	_	_
able	_	_
to	_	_
achieve	_	_
enhanced	_	_
performance	_	_
if	_	_
such	_	_
training	_	_
data	_	_
is	_	_
available	_	_
.	_	_

#241
Furthermore	_	_
,	_	_
a	_	_
dataset	_	_
with	_	_
more	_	_
disease	_	_
categories	_	_
included	_	_
will	_	_
be	_	_
favorable	_	_
as	_	_
it	_	_
is	_	_
closer	_	_
to	_	_
real	_	_
life	_	_
clinic	_	_
settings	_	_
.	_	_

#242
Future	_	_
works	_	_
include	_	_
expanding	_	_
the	_	_
current	_	_
ChestX-ray14	_	_
dataset	_	_
with	_	_
more	_	_
manual	_	_
label	_	_
and	_	_
more	_	_
disease	_	_
categories	_	_
such	_	_
as	_	_
coronary	_	_
artery	_	_
disease	_	_
[	_	_
10	_	_
,	_	_
11	_	_
]	_	_
for	_	_
evaluation	_	_
.	_	_

#243
Applications	_	_
of	_	_
our	_	_
model	_	_
on	_	_
different	_	_
medical	_	_
imaging	_	_
dataset	_	_
that	_	_
targeting	_	_
multiple	_	_
diseases	_	_
should	_	_
also	_	_
be	_	_
evaluated	_	_
in	_	_
the	_	_
future	_	_
.	_	_

#244
6	_	_
.	_	_

#245
Conclusion	_	_
In	_	_
summary	_	_
,	_	_
we	_	_
presented	_	_
a	_	_
weakly	_	_
supervised	_	_
adaptive	_	_
DenseNet	_	_
to	_	_
classify	_	_
and	_	_
localize	_	_
14	_	_
thoracic	_	_
diseases	_	_
by	_	_
using	_	_
only	_	_
image-level	_	_
annotation	_	_
during	_	_
training	_	_
.	_	_

#246
Extensive	_	_
experiments	_	_
demonstrated	_	_
the	_	_
effectiveness	_	_
of	_	_
our	_	_
network	_	_
which	_	_
achieved	_	_
both	_	_
the	_	_
best	_	_
classification	_	_
and	_	_
localization	_	_
results	_	_
among	_	_
the	_	_
previous	_	_
published	_	_
state-of-the-art	_	_
approaches	_	_
on	_	_
the	_	_
ChestX-ray14	_	_
dataset	_	_
.	_	_