#22
However	_	_
,	_	_
as	_	_
these	_	_
techniques	_	_
require	_	_
accurate	_	_
image	_	_
registration	_	_
,	_	_
they	_	_
are	_	_
only	_	_
applicable	_	_
when	_	_
the	_	_
imaged	_	_
objects	_	_
are	_	_
relatively	_	_
flat	_	_
and	_	_
not	_	_
in	_	_
motion	_	_
.	_	_

#23
Ideally	_	_
,	_	_
a	_	_
reflection	_	_
removal	_	_
algorithm	_	_
should	deontic	_
work	_	_
with	_	_
a	_	_
single	_	_
mixture	_	_
image	_	_
,	_	_
albeit	_	_
a	_	_
daunting	_	_
task	_	_
.	_	_

#24
Some	_	_
attempts	_	_
have	_	_
been	_	_
reported	_	_
in	_	_
the	_	_
literature	_	_
on	_	_
single-image	_	_
reflection	_	_
removal	_	_
[	_	_
22	_	_
,	_	_
7	_	_
]	_	_
.	_	_

#60
With	_	_
motion	_	_
smoothness	_	_
constraints	_	_
,	_	_
optical	_	_
flow	_	_
techniques	_	_
can	_	_
be	_	_
more	_	_
accurate	_	_
and	_	_
robust	_	_
for	_	_
the	_	_
layer	_	_
separation	_	_
task	_	_
[	_	_
45	_	_
,	_	_
46	_	_
]	_	_
.	_	_

#61
For	_	_
the	_	_
cases	_	_
where	_	_
the	_	_
camera	_	_
is	_	_
stationary	_	_
while	_	_
the	_	_
objects	_	_
are	_	_
moving	_	_
,	_	_
the	_	_
reflection	_	_
layer	_	_
is	_	_
relatively	_	_
static	_	_
and	_	_
must	deontic	_
be	_	_
handled	_	_
differently	_	_
[	_	_
31	_	_
,	_	_
36	_	_
]	_	_
.	_	_

#62
If	_	_
only	_	_
one	_	_
image	_	_
of	_	_
the	_	_
scene	_	_
is	_	_
given	_	_
,	_	_
which	_	_
is	_	_
the	_	_
case	_	_
tackled	_	_
by	_	_
this	_	_
paper	_	_
,	_	_
the	_	_
task	_	_
of	_	_
reflection	_	_
removal	_	_
becomes	_	_
much	_	_
more	_	_
challenging	_	_
.	_	_

#78
In	_	_
this	_	_
section	_	_
,	_	_
we	_	_
discuss	_	_
the	_	_
methods	_	_
for	_	_
collecting	_	_
and	_	_
preparing	_	_
the	_	_
training	_	_
images	_	_
for	_	_
our	_	_
technique	_	_
.	_	_

#79
To	_	_
help	_	_
the	_	_
proposed	_	_
technique	_	_
identify	_	_
the	_	_
patterns	_	_
of	_	_
reflections	_	_
in	_	_
real-world	_	_
scenarios	_	_
,	_	_
ideally	_	_
,	_	_
the	_	_
training	_	_
algorithm	_	_
should	deontic	_
only	_	_
use	_	_
real	_	_
photographs	_	_
as	_	_
the	_	_
training	_	_
data	_	_
.	_	_

#80
Obtaining	_	_
an	_	_
image	_	_
with	_	_
real	_	_
reflections	_	_
is	_	_
not	_	_
difficult	_	_
;	_	_
we	_	_
can	_	_
capture	_	_
such	_	_
a	_	_
mixture	_	_
image	_	_
I	_	_
,	_	_
as	_	_
in	_	_
Eq.	_	_
(	_	_
1	_	_
)	_	_
,	_	_
by	_	_
placing	_	_
a	_	_
piece	_	_
of	_	_
reflective	_	_
glass	_	_
of	_	_
transmittance	_	_
α	_	_
in	_	_
front	_	_
of	_	_
the	_	_
camera	_	_
.	_	_

#87
Since	_	_
the	_	_
noise	_	_
introduced	_	_
by	_	_
misalignment	_	_
has	_	_
similar	_	_
characteristics	_	_
as	_	_
a	_	_
natural	_	_
image	_	_
,	_	_
it	_	_
is	_	_
difficult	_	_
to	_	_
accurately	_	_
distinguish	_	_
the	_	_
noise	_	_
n	_	_
from	_	_
the	_	_
reflection	_	_
image	_	_
βR	_	_
.	_	_

#88
As	_	_
a	_	_
result	_	_
,	_	_
a	_	_
training	_	_
algorithm	_	_
could	capability-speculation	_
erroneously	_	_
attribute	_	_
part	_	_
of	_	_
the	_	_
noise	_	_
n	_	_
as	_	_
the	_	_
effects	_	_
of	_	_
the	_	_
reflection	_	_
βR	_	_
,	_	_
interfering	_	_
the	_	_
learning	_	_
of	_	_
the	_	_
true	_	_
reflections	_	_
.	_	_

#89
Similarly	_	_
,	_	_
regional	_	_
illumination	_	_
changes	_	_
between	_	_
a	_	_
pair	_	_
of	_	_
images	_	_
can	_	_
lead	_	_
to	_	_
the	_	_
increase	_	_
of	_	_
structural	_	_
noise	_	_
in	_	_
training	_	_
data	_	_
as	_	_
well	_	_
.	_	_

#116
The	_	_
transmission	_	_
layer	_	_
T	_	_
′	_	_
=	_	_
αT	_	_
is	_	_
a	_	_
glass-free	_	_
image	_	_
T	_	_
of	_	_
the	_	_
targeted	_	_
scene	_	_
attenuated	_	_
by	_	_
α	_	_
,	_	_
the	_	_
transmittance	_	_
of	_	_
the	_	_
reflective	_	_
glass	_	_
in	_	_
image	_	_
I	_	_
,	_	_
as	_	_
in	_	_
the	_	_
training	_	_
data	_	_
synthesis	_	_
formula	_	_
Eq.	_	_
5	_	_
.	_	_

#117
Since	_	_
the	_	_
reflection	_	_
layer	_	_
R′	_	_
is	_	_
likely	_	_
weak	_	_
and	_	_
smooth	_	_
in	_	_
comparison	_	_
with	_	_
T	_	_
′	_	_
[	_	_
24	_	_
,	_	_
5	_	_
]	_	_
,	_	_
T	_	_
′	_	_
should	deontic	_
be	_	_
similar	_	_
to	_	_
I	_	_
in	_	_
pixel	_	_
values	_	_
.	_	_

#118
Therefore	_	_
,	_	_
it	_	_
is	_	_
easier	_	_
to	_	_
optimize	_	_
mapping	_	_
T	_	_
′	_	_
=	_	_
F	_	_
(	_	_
I	_	_
)	_	_
than	_	_
to	_	_
optimize	_	_
the	_	_
mapping	_	_
from	_	_
I	_	_
to	_	_
T	_	_
directly	_	_
,	_	_
even	_	_
if	_	_
transmittance	_	_
α	_	_
is	_	_
known	_	_
to	_	_
the	_	_
network	_	_
.	_	_

#120
Another	_	_
option	_	_
is	_	_
to	_	_
train	_	_
a	_	_
residual	_	_
mapping	_	_
from	_	_
image	_	_
I	_	_
to	_	_
its	_	_
reflection	_	_
layer	_	_
R′	_	_
=	_	_
I	_	_
−	_	_
F	_	_
(	_	_
I	_	_
)	_	_
.	_	_

#121
Since	_	_
R′	_	_
is	_	_
relatively	_	_
flat	_	_
,	_	_
the	_	_
optimization	_	_
of	_	_
the	_	_
residual	_	_
mapping	_	_
should	inference	_
be	_	_
very	_	_
effective	_	_
.	_	_

#122
Residual	_	_
learning	_	_
has	_	_
set	_	_
the	_	_
state	_	_
of	_	_
the	_	_
art	_	_
for	_	_
many	_	_
different	_	_
image	_	_
restoration	_	_
problems	_	_
[	_	_
20	_	_
,	_	_
17	_	_
,	_	_
14	_	_
]	_	_
.	_	_

#123
However	_	_
,	_	_
none	_	_
of	_	_
the	_	_
existing	_	_
residual	_	_
learning	_	_
networks	_	_
suits	_	_
the	_	_
characteristics	_	_
of	_	_
the	_	_
reflection	_	_
removal	_	_
problem	_	_
.	_	_

#124
In	_	_
most	_	_
residual	_	_
learning	_	_
techniques	_	_
,	_	_
the	_	_
residual	_	_
is	_	_
the	_	_
missing	_	_
detail	_	_
to	_	_
be	_	_
recovered	_	_
and	_	_
added	_	_
back	_	_
to	_	_
the	_	_
input	_	_
image	_	_
,	_	_
while	_	_
in	_	_
our	_	_
case	_	_
,	_	_
the	_	_
residual	_	_
is	_	_
unwanted	_	_
reflection	_	_
that	_	_
should	deontic	_
be	_	_
subtracted	_	_
from	_	_
the	_	_
input	_	_
.	_	_

#125
Furthermore	_	_
,	_	_
residual	_	_
learning	_	_
tends	_	_
to	_	_
emphasize	_	_
on	_	_
the	_	_
fidelity	_	_
of	_	_
the	_	_
recovered	_	_
residual	_	_
as	_	_
the	_	_
loss	_	_
function	_	_
is	_	_
normally	_	_
applied	_	_
on	_	_
the	_	_
residual	_	_
.	_	_

#146
3.	_	_
Transmission	_	_
layer	_	_
restoration	_	_
.	_	_

#147
The	_	_
reflections	_	_
might	options	_
not	_	_
be	_	_
removed	_	_
completely	_	_
after	_	_
previous	_	_
stage	_	_
by	_	_
simply	_	_
subtracting	_	_
the	_	_
estimated	_	_
reflection	_	_
,	_	_
as	_	_
shown	_	_
in	_	_
the	_	_
last	_	_
row	_	_
of	_	_
Figure	_	_
5	_	_
.	_	_

#148
Thus	_	_
,	_	_
this	_	_
stage	_	_
tries	_	_
to	_	_
restore	_	_
a	_	_
visually	_	_
pleasing	_	_
transmission	_	_
image	_	_
from	_	_
the	_	_
reflection	_	_
subtracted	_	_
image	_	_
.	_	_

#158
In	_	_
the	_	_
case	_	_
of	_	_
reflection	_	_
removal	_	_
,	_	_
both	_	_
the	_	_
reflection	_	_
and	_	_
transmission	_	_
layers	_	_
are	_	_
natural	_	_
images	_	_
with	_	_
different	_	_
characteristics	_	_
.	_	_

#159
To	_	_
get	_	_
the	_	_
best	_	_
restoration	_	_
result	_	_
,	_	_
the	_	_
network	_	_
should	deontic	_
learn	_	_
the	_	_
perceptual	_	_
properties	_	_
of	_	_
the	_	_
transmission	_	_
layer	_	_
.	_	_

#160
Inspired	_	_
by	_	_
[	_	_
11	_	_
,	_	_
15	_	_
]	_	_
,	_	_
we	_	_
employ	_	_
a	_	_
loss	_	_
function	_	_
that	_	_
is	_	_
closer	_	_
to	_	_
high-level	_	_
feature	_	_
abstractions	_	_
.	_	_

#172
We	_	_
choose	_	_
the	_	_
images	_	_
of	_	_
natural	_	_
landscapes	_	_
and	_	_
images	_	_
taken	_	_
inside	_	_
a	_	_
mall	_	_
as	_	_
the	_	_
reflections	_	_
.	_	_

#173
Leaves	_	_
could	capability-speculation	_
create	_	_
sparse	_	_
shadow	_	_
on	_	_
the	_	_
window	_	_
interfering	_	_
the	_	_
transmission	_	_
image	_	_
,	_	_
and	_	_
the	_	_
lights	_	_
from	_	_
a	_	_
shop	_	_
sign	_	_
create	_	_
strong	_	_
and	_	_
sharp	_	_
reflection	_	_
,	_	_
which	_	_
are	_	_
also	_	_
extremely	_	_
common	_	_
in	_	_
real	_	_
life	_	_
reflection-interfered	_	_
images	_	_
.	_	_

#174
To	_	_
ensure	_	_
the	_	_
size	_	_
of	_	_
training	_	_
dataset	_	_
and	_	_
avoid	_	_
over-fitting	_	_
,	_	_
each	_	_
transmission	_	_
image	_	_
is	_	_
synthesized	_	_
with	_	_
18	_	_
randomly	_	_
chosen	_	_
reflection	_	_
images	_	_
using	_	_
Eq.	_	_
(	_	_
5	_	_
)	_	_
.	_	_

#192
The	_	_
technique	_	_
in	_	_
[	_	_
7	_	_
]	_	_
is	_	_
based	_	_
on	_	_
the	_	_
assumption	_	_
that	_	_
the	_	_
reflection	_	_
is	_	_
smooth	_	_
.	_	_

#193
However	_	_
,	_	_
if	_	_
this	_	_
assumption	_	_
is	_	_
not	_	_
true	_	_
,	_	_
as	_	_
exemplified	_	_
in	_	_
the	_	_
sample	_	_
images	_	_
,	_	_
[	_	_
7	_	_
]	_	_
could	capability-speculation	_
even	_	_
enhance	_	_
the	_	_
reflections	_	_
,	_	_
making	_	_
the	_	_
results	_	_
worse	_	_
than	_	_
the	_	_
inputs	_	_
.	_	_

#194
Our	_	_
method	_	_
does	_	_
not	_	_
rely	_	_
on	_	_
such	_	_
an	_	_
assumption	_	_
;	_	_
it	_	_
works	_	_
well	_	_
regardless	_	_
the	_	_
smoothness	_	_
of	_	_
the	_	_
reflections	_	_
.	_	_